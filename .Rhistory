str_detect(institution, "(?i)Vincent P. Dole Dual Diagnosis Unit") ~ "Lucca",
str_detect(institution, "(?i)Institute for Advanced Studies-IUSS") ~ "Pavia",
# barcelona & other spanish city issues:
str_detect(institution, "(?i)Universidad San Jorge") ~ "Zaragoza",
str_detect(institution, "(?i)Barcelona, Spain") ~ "Barcelona",
str_detect(institution, "(?i)Serra Hunter fellow") ~ "Barcelona",
str_detect(institution, "(?i)Pompeu Fabra University") ~ "Barcelona",
str_detect(institution, "(?i)Universitat Rovira i Virgili") ~ "Tarragona",
str_detect(institution, "(?i)Alicante, Spain") ~ "Alicante",
str_detect(institution, "(?i)Bormujos, Spain") ~ "Bormujos",
str_detect(institution, "(?i)Ciencies d'Alimentacio") ~ "Barcelona",
str_detect(institution, "(?i)Servicio de Psiquiatria, Fundacion") ~ "Madrid",
str_detect(institution, "(?i)Jimenez Diaz University Hospital") ~ "Madrid",
str_detect(institution, "(?i)Puerta de Hierro-Segovia de Arana Health Research Institute") ~ "Madrid",
str_detect(institution, "(?i)Centro Universitario Cardenal Cisneros") ~ "Madrid",
str_detect(institution, "(?i)Universidad Catolica San Antonio de Murcia") ~ "Murcia",
str_detect(institution, "(?i)Santiago de Compostela") ~ "Santiago de Compostela",
str_detect(institution, "(?i)Consumer and User Psychology Unit, Faculty of Psychology, University of Santiago") ~ "Santiago de Compostela",
str_detect(institution, "(?i)Department of Physiology, School of Medicine, University of Santiago de") ~ "Santiago de Compostela", # Confirmed by searching original paper
str_detect(institution, "(?i)Serra Hunter Programme") ~ "Barcelona",
str_detect(institution, "(?i)Hospital Universitario de Canarias") ~ "Santa Cruz de Tenerife",
str_detect(institution, "(?i)Universitat Pompeu Fabra") ~ "Barcelona",
str_detect(institution, "(?i)Universidad Loyola Andalucia") ~ "Cordoba",
# India
str_detect(institution, "(?i)MGM Medical College & Hospital , Navi") ~ "Navi Mumbai",
# Nottingham:
str_detect(institution, "(?i)Newark Beacon Innovation Centre") ~ "Nottingham",
# china:
str_detect(institution, "(?i)Key Laboratory Of Alzheimer's Disease Of Zhejiang Province") ~ "Hangzhou",
str_detect(institution, "(?i)Shenzhen Research Institute") ~ "Shenzhen",
str_detect(institution, "(?i)Hunan First Normal University") ~ "Changsha",
str_detect(institution, "(?i)Gannan Medical University") ~ "Ganzhou",
str_detect(institution, "(?i)Jiaotong University") ~ "Shanghai",
str_detect(institution, "(?i)National Clinical Research Center for Oral") ~ "Chengdu",
str_detect(institution, "(?i)Macau Pui Ching Middle School") ~ "Macau",
str_detect(institution, "(?i)University of Macau") ~ "Macau",
str_detect(institution, "(?i)Macao Polytechnic Institute") ~ "Macau",
str_detect(institution, "(?i)Chaohu Hospital of Anhui") ~ "Hefei",
str_detect(institution, "(?i)Huangmei County") ~ "Huanggang",
# Portugal:
str_detect(institution, "(?i)Lisbon") ~ "Lisbon",
str_detect(institution, "(?i)Instituto Superior Miguel Torga") ~ "Coimbra",
str_detect(institution, "(?i)Unity in Multidisciplinary Research on Biomedicine (UMIB)") ~ "Porto",
str_detect(institution, "(?i)Abel Salazar") ~ "Porto",
str_detect(institution, "(?i)IAJ (Gambling Support Institute)") ~ "Lisbon",
str_detect(institution, "(?i)Rua Sacadura Cabral") ~ "Lisbon",
# Turkey:
str_detect(institution, "(?i)Inonu") ~ "Malatya",
str_detect(institution, "(?i)Sultan Abdulhamid Han") ~ "Istanbul",
str_detect(institution, "(?i)Provincial Health Directorate, Agri") ~ "Agri",
str_detect(institution, "(?i)Marmara University") ~ "Istanbul",
str_detect(institution, "(?i)Baltalimani Metin Sabanci") ~ "Istanbul",
str_detect(institution, "(?i)Selcuk University") ~ "Konya",
# Porto Alegre issue:
str_detect(institution, "(?i)Porto Alegre") ~ "Porto Alegre",
# Namur:
str_detect(institution, "(?i)Namur") ~ "Namur", # Checked there's only one in the data
# Sandy bay tas:
str_detect(institution, "(?i)Sandy Bay") ~ "Sandy Bay",
# Oviedo:
str_detect(institution, "(?i)Oviedo, Spain") ~ "Oviedo",
# Dublin & ireland:
str_detect(institution, "(?i)Lucena Clinic Rathgar") ~ "Dublin",
str_detect(institution, "(?i)Dublin, Ireland") ~ "Dublin",
# West Chester University:
str_detect(institution, "(?i)West Chester University") ~ "Philadelphia",
# Yunlin and others, Taiwan:
str_detect(institution, "(?i)New Taipei") ~ "New Taipei",
str_detect(institution, "(?i)Chia Nan University") ~ "Tainan",
str_detect(institution, "(?i)E-Da Hospital") ~ "Kaohsiung",
str_detect(institution, "(?i)Shu Zen Junior College of Medicine") ~ "Kaohsiung",
str_detect(institution, "(?i)Ditmanson Medical Foundation") ~ "Chiayi",
str_detect(institution, "(?i)Yunlin, Taiwan") ~ "Douliu",
str_detect(institution, "(?i)Chang Gung Memorial Hospital") ~ "Taoyuan City",
str_detect(institution, "(?i)National Chi Nan University") ~ "Puli",
str_detect(institution, "(?i)National Formosa University") ~ "Douliu",
# University of Montana:
str_detect(institution, "(?i)University of Montana") ~ "Missoula",
# San Juan:
str_detect(institution, "(?i)University of Puerto Rico, San Juan") ~ "San Juan",
# Moroccan city:
str_detect(institution, "(?i)Fez, Morocco") ~ "Fez",
# Seton Hall University & other newark issues:
str_detect(institution, "(?i)Seton Hall University") ~ "Newark",
str_detect(institution, "(?i)Parsippany, NJ") ~ "Newark",
# Auburn University:
str_detect(institution, "(?i)Auburn University") ~ "Montgomery",
# William Paterson University:
str_detect(institution, "(?i)William Paterson University") ~ "Newark",
#  University of Manitoba:
str_detect(institution, "(?i)University of Manitoba") ~ "Winnipeg",
# University of South Dakota:
str_detect(institution, "(?i)University of South Dakota") ~ "Vermillion",
# University of Antwerpen:
str_detect(institution, "(?i)Institute Born-Bunge") ~ "Antwerp",
# University of Kansas:
str_detect(institution,  "University of Kansas") ~ "Lawrence",
# Vanderbilt University:
str_detect(institution,  "Vanderbilt") ~ "Nashville",
# Wayne state university:
str_detect(institution,  "Wayne State University") ~ "Detroit",
# University  Michigan:
str_detect(institution,  "University of Michigan") ~ "Ann Arbor",
# Carson College of Business:
str_detect(institution,  "Carson College of Business") ~ "Pullman",
# Universidad de San Martin de Porres
str_detect(institution,  "Universidad de San Martin de Porres") ~ "Lima",
str_detect(institution,  "Universidad Cientifica del Sur") ~ "Lima",
# The Center for Internet and Technology Addiction
str_detect(institution,  "The Center for Internet and Technology Addiction") ~ "Hartford",
# Georgetown uni issue:
str_detect(institution, "(?i)Georgetown") ~ "Washington, D.C",
# Lincoln Memorial University issue:
str_detect(institution, "(?i)Lincoln Memorial University") ~ "Harrogate",
# Meridian Behavioral Health Services (I can't find a full address for this, despite searching the people manually, But it doesn't appear to be in the US):
str_detect(institution,  "Meridian Behavioral Health Services") ~ "",
# Nashville:
str_detect(institution, "(?i)Nashville, TN") ~ "Nashville",
# Fort Lauderdale:
str_detect(institution, "(?i)Fort Lauderdale") ~ "Fort Lauderdale",
# Byblos Lebanon:
str_detect(institution, "(?i)Byblos, Lebanon") ~ "Byblos",
# Belgium city:
str_detect(institution, "(?i)Hasselt, Belgium") ~ "Hasselt",
# Poland:
str_detect(institution, "(?i)Uniwersytet Jagiellonski Collegium Medicum") ~ "Krakow",
str_detect(institution, "(?i)Adam Mickiewicz University") ~ "Poznan",
# Brazil:
str_detect(institution, "(?i)University Federal do Vale do") ~ "Petrolina",
str_detect(institution, "(?i)Universidade Federal do Parana") ~ "Curitiba",
str_detect(institution, "(?i)Federal University of Minas") ~ "Belo Horizonte",
str_detect(institution, "(?i)Belo Horizonte") ~ "Belo Horizonte",
str_detect(institution, "(?i)Universidade Federal de Minas Gerais") ~ "Belo Horizonte",
str_detect(institution, "(?i)Universidade Federal de Minas") ~ "Petrolina",
str_detect(institution, "(?i)University of Santa Catarina") ~ "Florianopolis",
str_detect(institution, "(?i)Federal University of Rio Grande do") ~ "Porto Alegre",
str_detect(institution, "(?i)Escola Paulista") ~ "Sao Paulo",
str_detect(institution, "(?i)Clementino Fraga Filho Hospital") ~ "Rio de Janeiro",
str_detect(institution, "(?i)Universidade Estadual da Paraiba") ~ "Campina Grande",
str_detect(institution, "(?i)Federal University of Mato Grosso do Sul") ~ "Campo Grande",
# Peru:
str_detect(institution, "(?i)Lima, Peru") ~ "Lima",
str_detect(institution, "(?i)Universidad Cesar Vallejo") ~ "Trujillo",
#Japan:
str_detect(institution, "(?i)Health Sciences University of Hokkaido") ~ "Tobetsu",
str_detect(institution, "(?i)Konan Women's University") ~ "Kobe",
str_detect(institution, "(?i)Tokai Gakuen University") ~ "Nagoya",
str_detect(institution, "(?i)University of Hokkaido") ~ "Hokkaido",
str_detect(institution, "(?i)Tama-ku, Kawasaki") ~ "Kawasaki",
str_detect(institution, "(?i)Teikyo University") ~ "Tokyo",
str_detect(institution, "(?i)Showa University") ~ "Tokyo",
# Virginia:
str_detect(institution, "(?i)Virginia Institute for Psychiatry and Behavioral Genetics") ~ "Richmond",
# Kuala Lumpur/ Malaysia:
str_detect(institution, "(?i)Monash University Malaysia") ~ "Kuala Lumpur",
str_detect(institution, "(?i)University of Nottingham Malaysia Campus") ~ "Kuala Lumpur",
str_detect(institution, "(?i)Hospital Tuanku Ampuan Najihah") ~ "Kuala Pilah",
# Vietnam:
str_detect(institution, "(?i)Nguyen Tat Thanh University") ~ "Ho Chi Minh City",
str_detect(institution, "(?i)Nguyen Tat Thanh") ~ "Ho Chi Minh City",
# Santo AndrÃ©:
str_detect(institution, "(?i)Santo Andre, SP, Brazil") ~ "Santo Andre",
# Egypt"
# Hungary:
str_detect(institution, "(?i)Budapest") ~ "Budapest",
str_detect(institution, "(?i)University of South Valley") ~ "Cairo",
# Netherlands:
str_detect(institution, "(?i)Coronel Institute") ~ "Amsterdam",
# author not institution:
str_detect(institution, "(?i)Maya Sahu, RN, RM,") ~ "",
str_detect(institution, "(?i)Sahar Obeid") ~ "Beirut", # This isan author I looked up
# Random:
str_detect(institution, "(?i)Saint Joseph University of Beirut") ~ "Beirut",
str_detect(institution, "(?i)Psychiatry Outpatient Clinics, University Hospital of The Brothers of Saint John") ~ "Bratislava",
str_detect(institution, "(?i)Nucleo de Pesquisa em Vulnerabilidade a Saude") ~ "Belo Horizonte",
str_detect(institution, "(?i)Nottingham University") ~ "Nottingham",
str_detect(institution, "(?i)Department of Clinical Medicine, Faculty of Health and Human Ecology, Belo") ~ "Belo Horizonte",
str_detect(institution, "(?i)Cambridge Health Alliance") ~ "Malden",
str_detect(institution, "(?i)Harvard University, 52 Oxford St") ~ "Cambridge",
str_detect(institution, "(?i)South Limburg Mental Health") ~ "Maastricht",
str_detect(institution, "(?i)University of La Laguna") ~ "La Laguna",
str_detect(institution, "(?i)Manchester VA Medical Center") ~ "Manchester",
str_detect(institution, "(?i)Den Haag") ~ "The Hague",
str_detect(institution, "(?i)Monash") ~ "Melbourne",
str_detect(institution, "(?i)MONASH Pathway at Universal College Bangladesh") ~ "Dhaka",
str_detect(institution, "(?i)Centre Neuchatelois de Psychiatrie, Republique et Canton de Neuchatel") ~ "Bern",
str_detect(institution, "(?i)Institute for Safe Medication Practices, Alexandria, Virginia") ~ "Washington, D.C",
TRUE ~ as.character(cities_of_authors)  # Default if none of the above matches
# COUNTRY CHANGES:
)) %>%
mutate(countries_of_authors = case_when(
# Random:
str_detect(institution, "(?i)Psychiatry Outpatient Clinics, University Hospital of The Brothers of Saint John") ~ "Slovakia",
str_detect(institution, "(?i)UON Singapore Campus") ~ "Singapore",
str_detect(institution, "(?i)Beirut") ~ "Lebanon",
# Netherlands:
str_detect(institution, "(?i)Coronel Institute") ~ "Netherlands",
str_detect(institution, "(?i)Instituut voor Onderzoek") ~ "Netherlands",
str_detect(institution, "(?i)South Limburg Mental Health") ~ "Netherlands",
# USA
str_detect(institution, "(?i)Johns Hopkins University") ~ "USA",
str_detect(institution, "(?i)Virginia Commonwealth University") ~ "USA",
str_detect(institution, "(?i)Wake Forest") ~ "USA",
str_detect(institution, "(?i)Los Angeles") ~ "USA",
str_detect(institution, "(?i)Rutgers") ~ "USA",
str_detect(institution, "(?i)Bedford, MA") ~ "USA",
str_detect(institution, "(?i)Liberty, Mo") ~ "USA",
str_detect(institution, "(?i)Nova Southeastern University") ~ "USA",
str_detect(institution, "(?i)Thompson Center for Autism") ~ "USA",
str_detect(institution, "(?i)Duke University") ~ "USA",
str_detect(institution, "(?i)Connecticut") ~ "USA",
str_detect(institution, "(?i)Russell H. Morgan Department of Radiology") ~ "USA",
str_detect(institution, "(?i)University of Massachusetts") ~ "USA",
str_detect(institution, "(?i)University of Rhode Island") ~ "USA",
str_detect(institution, "(?i)Institute for Safe Medication Practices, Alexandria, Virginia") ~ "USA",
str_detect(institution, "(?i)Center for Compulsive Behavior and Addiction, Rush") ~ "USA",
str_detect(institution, "(?i)Russell J. Jandoli School") ~ "USA",
str_detect(institution, "(?i)Rochester") ~ "USA",
str_detect(institution, "(?i)Jacksonville") ~ "USA",
str_detect(institution, "(?i)City of Hope Medical Center, Duarte") ~ "USA",
str_detect(institution, "(?i)Duarte") ~ "USA",
str_detect(institution, "(?i)Kim Ross is the School") ~ "USA",
str_detect(institution, "(?i)West Virginia University") ~ "USA",
str_detect(institution, "(?i)Department of Kinesiology, School of Applied Health Sciences, Brooks") ~ "USA",
# Lebanon:
str_detect(institution, "(?i)Sahar Obeid") ~ "Lebanon", # This is an author I looked up
# Brazil:
str_detect(institution, "(?i)Federal University of Mato Grosso do Sul") ~ "Brazil",
str_detect(institution, "(?i)Federal University of Mato Grosso do Sul") ~ "Brazil",
str_detect(institution, "(?i)Belo Horizonte") ~ "Brazil",
str_detect(institution, "(?i)Clementino Fraga Filho Hospital") ~ "Brazil",
str_detect(institution, "(?i)Federal University of Minas") ~ "Brazil",
str_detect(institution, "(?i)Nucleo de Pesquisa em Vulnerabilidade a Saude") ~ "Brazil",
str_detect(institution, "(?i)Universidade Federal de Minas") ~ "Brazil",
str_detect(institution, "(?i)Department of Clinical Medicine, Faculty of Health and Human Ecology, Belo") ~ "Brazil",
str_detect(institution, "(?i)Universidade Estadual da Paraiba") ~ "Brazil",
# France:
# Tours, France:
str_detect(institution, "(?i)Universite Cote D'Azur") ~ "France",
str_detect(institution, "(?i)University of Tours") ~ "France",
str_detect(institution, "(?i)Sainte-Anne Hospital") ~ "France",
str_detect(institution, "(?i)Hopital Sainte-Anne") ~ "France",
str_detect(institution, "(?i)CSAPA, pole ressource jeux") ~ "France",
str_detect(institution, "(?i)Ramsay Generale de Sante") ~ "France",
# Poland:
str_detect(institution, "(?i)Adam Mickiewicz University") ~ "Poland",
# Sort Georgia country issues:
str_detect(institution, "(?i)Georgia State University") ~ "USA",
str_detect(institution, "(?i)University of Georgia") ~ "USA",
str_detect(institution, "(?i)Georgia College") ~ "USA",
str_detect(cities_of_authors, "Marietta") ~ "USA",
# Georgetown uni issue:
str_detect(institution, "(?i)Georgetown") ~ "USA",
# Lincoln Memorial University issue:
str_detect(institution, "(?i)Lincoln Memorial University") ~ "USA",
# Mongolia country issues:
str_detect(institution, "(?i)Inner Mongolia") ~ "China",
# Mexico Country issues:
str_detect(institution, "(?i)University of New Mexico") ~ "USA",
# Germany issues:
str_detect(institution, "(?i)Sana Klinikum Offenbach") ~ "Germany",
str_detect(institution, "(?i)Meiningen") ~ "Germany",
str_detect(institution, "(?i)Ulm University") ~ "Germany",
str_detect(institution, "(?i)Martin-Luther-University") ~ "Germany",
str_detect(institution, "(?i)Eichstatt-Ingolstadt") ~ "Germany",
str_detect(institution, "(?i)State Police College of Baden-Wuerttemberg") ~ "Germany",
# Jersey country issues:
str_detect(institution, "(?i)New Jersey") ~ "USA",
# Cambridge city issues:
str_detect(institution, "(?i)Harvard") ~ "USA",
str_detect(institution, "(?i)University of Cambridge") ~ "UK",
str_detect(institution, "(?i)Cambridge Health Alliance") ~ "USA",
str_detect(institution, "(?i)Anglia Ruskin University") ~ "UK",
# Boston issue:
str_detect(institution, "(?i)Boston, MA") ~ "USA",
# London city issues
str_detect(institution, "(?i)London")  &
!str_detect(institution, "(?i)Ontario") &
!str_detect(institution, "(?i)Canada") ~ "UK",
str_detect(institution, "(?i)Ontario") ~ "Canada",
# Sort Columbia issues:
str_detect(institution, "(?i)University of British Columbia") ~ "Canada",
str_detect(institution, "(?i)Columbia University") ~ "USA",
str_detect(institution, "(?i)United States of America") ~ "USA",
str_detect(institution, "(?i)Missouri") ~ "USA",
str_detect(institution, "(?i)New York") ~ "USA",
str_detect(institution, "(?i)British Columbia") ~ "Canada",
# Saudi:
str_detect(institution, "(?i)Sami H. Alzahrani") ~ "Saudi Arabia",
str_detect(institution, "(?i)Shaqra") ~ "Saudi Arabia",
# Australia:
str_detect(institution, "(?i)Monash") ~ "Australia",
str_detect(institution, "(?i)Adelaide") ~ "Australia",
str_detect(institution, "(?i)CQUniversity, 400 Kent St, Sydney") ~ "Australia",
str_detect(institution, "(?i)CQUniversity") ~ "Australia",
str_detect(institution, "(?i)CQ University") ~ "Australia",
str_detect(institution, "(?i)University of Wollongong") ~ "Australia",
str_detect(institution, "(?i)The Boden Collaboration") ~ "Australia",
str_detect(institution, "(?i)Campbelltown Hospital") ~ "Australia",
str_detect(institution, "(?i)North Parramatta") ~ "Australia",
str_detect(institution, "(?i)Gna Ka Lun Adolescent") ~ "Australia",
# Japan:
str_detect(institution, "(?i)Toyo University") ~ "Japan",
# Austria:
str_detect(institution, "(?i)Therapiestation Lukasfeld der Stiftung Maria, Ebene") ~ "Austria",
# Sort Colombia issues:
str_detect(institution, "(?i)Barranquilla") ~ "Colombia",
str_detect(institution, "(?i) Universidad del Rosa") ~ "Colombia",
# Canada:
str_detect(institution, "(?i)Department of Education, Centre for Addiction and Mental Health") ~ "Canada",
str_detect(institution, "(?i)Quebec") ~ "Canada",
str_detect(institution, "(?i)Chilliwack") ~ "Canada",
str_detect(institution, "(?i)Sainte-Justine University Hospital") ~ "Canada",
str_detect(institution, "(?i)University of Waterloo") ~ "Canada",
str_detect(institution, "(?i)Morton and Gloria Shulman Movement Disorders Clinic") ~ "Canada",
str_detect(institution, "(?i)Brandon University") ~ "Canada",
str_detect(institution, "(?i)University of New Brunswick") ~ "Canada",
str_detect(institution, "(?i)Addiction & Mental Health Services-Kingston") ~ "Canada",
str_detect(institution, "(?i)Toronto, ON") ~ "Canada",
str_detect(institution, "(?i)Centre for Addiction and Mental Health, 33 Russell") ~ "Canada",
str_detect(institution, "(?i)Social and Economic Impacts of Gambling in Massachusetts project,") ~ "USA", # Was originally Canada
# Case Western Reserve University:
str_detect(institution, "(?i)Case Western Reserve University") ~ "USA", # Goes to Bolton UK
# Greece:
str_detect(institution, "(?i)University of Athens, Greece") ~ "Greece", # Author had two affiliations listed so taking the first
# Hungary:
str_detect(institution, "(?i)Budapest") ~ "Hungary",
# Norway:
str_detect(institution, "(?i)University College, Bergen") ~ "Norway",
# South Korea:
str_detect(institution, "(?i)Hanyang University") ~ "Korea South",
str_detect(institution, "(?i)Yonsei University") ~ "Korea South",
str_detect(institution, "(?i)Department of Nursing, Chung-Ang") ~ "Korea South",
str_detect(institution, "(?i)Anyang University") ~ "Korea South",
str_detect(institution, "(?i)Chungbuk National University") ~ "Korea South",
str_detect(institution, "(?i)Chungmugong Leadership Center") ~ "Korea South",
str_detect(institution, "(?i)Pusan National University") ~ "Korea South",
str_detect(institution, "(?i)Honam University") ~ "Korea South",
str_detect(institution, "(?i)Korea Institute on Behavioral Addictions") ~ "Korea South",
str_detect(institution, "(?i)hallym University") ~ "Korea South",
str_detect(institution, "(?i)Hallym University") ~ "Korea South",
str_detect(institution, "(?i)Seoyoung University") ~ "Korea South",
str_detect(institution, "(?i)Yonsei Forest Mental Health Clinic") ~ "Korea South",
# Portugal:
str_detect(institution, "(?i)Unity in Multidisciplinary Research on Biomedicine (UMIB)") ~ "Portugal",
str_detect(institution, "(?i)Instituto Superior Miguel Torga") ~ "Portugal",
str_detect(institution, "(?i)Abel Salazar") ~ "Portugal",
str_detect(institution, "(?i)IAJ (Gambling Support Institute)") ~ "Portugal",
# China:
str_detect(institution, "(?i)The Chinese University of Hong Kong") ~ "Hong Kong",
str_detect(institution, "(?i)Shenzhen Research Institute") ~ "China",
str_detect(institution, "(?i)Tung Wah Group") ~ "Hong Kong",
str_detect(institution, "(?i)Huangmei County") ~ "China",
str_detect(institution, "(?i)Hunan First Normal University") ~ "China",
str_detect(institution, "(?i)Key Laboratory Of Alzheimer's Disease Of Zhejiang Province") ~ "China",
str_detect(institution, "(?i)National Clinical Research Center for Oral") ~ "China",
str_detect(institution, "(?i)Macao Polytechnic Institute") ~ "China",
str_detect(institution, "(?i)University of Macau") ~ "China",
# South Africa:
str_detect(institution, "(?i)Christiana Care Hospital") ~ "USA",
# Newark Beacon Innovation Centre:
str_detect(institution, "(?i)Newark Beacon Innovation Centre") ~ "UK",
# Sort Liverpool issues:
str_detect(institution, "(?i)University of New South Wales") ~ "Australia",
str_detect(institution, "(?i)Liverpool Hospital, Sydney") ~ "Australia",
str_detect(institution, "(?i)Campbelltown Hospital") ~ "Australia",
str_detect(institution, "(?i)John Moores") ~ "UK",
str_detect(institution, "(?i)University of Liverpool") ~ "UK",
str_detect(institution, "(?i)LiMRIC") ~ "UK",
str_detect(institution, "(?i)Liverpool, England") ~ "UK",
str_detect(institution, "(?i)Liverpool John") ~ "UK",
# Reading issues:
str_detect(institution, "(?i)University of Reading") ~ "UK",
str_detect(institution, "(?i)USA") ~ "USA",
str_detect(institution, "(?i)United States") ~ "USA",
# Northampton issues:
str_detect(institution, "(?i)University of Northampton") ~ "UK",
str_detect(institution, "(?i)Gemini Research") ~ "USA",
# Virginia:
str_detect(institution, "(?i)Virginia Institute for Psychiatry and Behavioral Genetics") ~ "USA",
# University of Alabama:
str_detect(institution, "(?i)University of Alabama") ~ "USA",
# University  Michigan:
str_detect(institution,  "University of Michigan") ~ "USA",
# The Center for Internet and Technology Addiction
str_detect(institution,  "The Center for Internet and Technology Addiction") ~ "USA",
#  University of Southern  California:
str_detect(institution,  "University of Southern California") ~ "USA",
# Sterling issues:
str_detect(institution, "(?i)Australia") ~ "Australia",
# Palo Alto
str_detect(institution, "(?i)Palo Alto") ~ "USA",
# Hong kong:
str_detect(institution, "(?i)Hong kong") ~ "Hong Kong",
# Newport issues:
str_detect(institution, "(?i)Christopher Newport University") ~ "USA",
# Oxford & UK other:
str_detect(institution, "(?i)University of Oxford") ~ "UK",
str_detect(institution, "(?i)Oxford, UK") ~ "UK",
str_detect(institution, "(?i)Oxford Centre for") ~ "UK",
str_detect(institution, "(?i)Nottingham University") ~ "UK",
str_detect(institution, "(?i)University of Essex") ~ "UK",
str_detect(institution, "(?i)Barnet, Enfield & Haringey") ~ "UK",
str_detect(institution, "(?i)Frederick Road Campus") ~ "UK",
str_detect(institution, "(?i)Reta Lila Weston") ~ "UK",
str_detect(institution, "(?i)Division of Psychology and Language Sciences, UCL") ~ "UK",
# Weird barcelona uni & spain:
str_detect(institution, "(?i)Alava University Hospital-Santiago") ~ "Spain",
str_detect(institution, "(?i)Universitat Rovira i Virgili") ~ "Spain",
str_detect(institution, "(?i)University of Barcelona, Barcelona") ~ "Spain",
str_detect(institution, "(?i)Universidad Francisco de Vitoria") ~ "Spain",
str_detect(institution, "(?i)Centro Universitario Cardenal Cisneros") ~ "Spain",
str_detect(institution, "(?i)Universidad Francisco de Vitoria") ~ "Spain",
str_detect(institution, "(?i)University of Salamanca") ~ "Spain",
str_detect(institution, "(?i)Universidad San Jorge") ~ "Spain",
str_detect(institution, "(?i)Pompeu Fabra University") ~ "Spain",
str_detect(institution, "(?i)Jimenez Diaz University Hospital") ~ "Spain",
str_detect(institution, "(?i)Santiago de Compostela") ~ "Spain",
str_detect(institution, "(?i)Consumer and User Psychology Unit, Faculty of Psychology, University of Santiago") ~ "Spain",
str_detect(institution, "(?i)Universidad Catolica San Antonio de Murcia") ~ "Spain",
str_detect(institution, "(?i)Serra Hunter Programme") ~ "Spain",
str_detect(institution, "(?i)Serra Hunter fellow") ~ "Spain",
str_detect(institution, "(?i)Hospital Universitario de Canarias") ~ "Spain",
str_detect(institution, "(?i)Universitat Pompeu Fabra") ~ "Spain",
str_detect(institution, "(?i)Universidad Loyola Andalucia") ~ "Spain",
str_detect(institution, "(?i)Servicio de Psiquiatria, Fundacion") ~ "Spain",
# Italy:
str_detect(institution, "(?i)Department of Medical and Oral Sciences and Biotechnologies, University G") ~ "Italy",
str_detect(institution, "(?i)Ragusa") ~ "Italy",
str_detect(institution, "(?i)Largo Bologna") ~ "Italy",
str_detect(institution, "(?i)Largo Brambilla") ~ "Italy",
str_detect(institution, "(?i)Ospedale Evangelico Betania") ~ "Italy",
str_detect(institution, "(?i)Ospedale Evangelico Betania") ~ "Italy",
str_detect(institution, "(?i)University of Salento") ~ "Italy",
str_detect(institution, "(?i)Urbino") ~ "Italy",
str_detect(institution, "(?i)Awake to Wisdom Centre for Meditation and Mindfulness Research") ~ "Italy",
str_detect(institution, "(?i)Vincent P. Dole Dual Diagnosis Unit") ~ "Italy",
str_detect(institution, "(?i)Betania Evangelical Hospital") ~ "Italy",
str_detect(institution, "(?i)University of Turin") ~ "Italy",
str_detect(institution, "(?i)Alma Mater Studiorum") ~ "Italy",
# Egypt"
str_detect(institution, "(?i)University of South Valley") ~ "Egypt",
# Brazil:
str_detect(institution, "(?i)University Federal do Vale do") ~ "Brazil",
str_detect(institution, "(?i)Porto Alegre") ~ "Brazil",
str_detect(institution, "(?i)Federal University of Mato Grosso do Sul") ~ "Brazil",
# Netherlands uni confused for Austria:
str_detect(institution, "(?i)Instituut voor Onderzoek") ~ "Netherlands",
# Switzerland:
str_detect(institution, "(?i)Lausanne") ~ "Switzerland",
str_detect(institution, "(?i)Lausanne University") ~ "Switzerland",
str_detect(institution, "(?i)Centre Neuchatelois de Psychiatrie, Republique et Canton de Neuchatel") ~ "Switzerland",
# West Chester University:
str_detect(institution, "(?i)West Chester University") ~ "USA",
#Rede SARAH de Hospitais de Reabilitacao:
str_detect(institution, "(?i)Rede SARAH de Hospitais de Reabilitacao") ~ "Brazil",
# India:
str_detect(institution, "(?i)MGM Medical College & Hospital , Navi") ~ "India",
str_detect(institution, "(?i)Veer Chandra Singh Garhwali Government") ~ "India",
str_detect(institution, "(?i)Anna Nagar") ~ "India",
str_detect(institution, "(?i)Maya Sahu") ~ "India",
str_detect(institution, "(?i)Saveetha") ~ "India",
# Bangladesh:
str_detect(institution, "(?i)MONASH Pathway at Universal College Bangladesh") ~ "Bangladesh",
# Malaysia:
str_detect(institution, "(?i)Hospital Tuanku Ampuan Najihah") ~ "Malaysia",
# Taiwan:
str_detect(institution, "(?i)Ditmanson Medical Foundation") ~ "Taiwan",
str_detect(institution, "(?i)Chia Nan University") ~ "Taiwan",
str_detect(institution, "(?i)Taichung") ~ "Taiwan",
str_detect(institution, "(?i)E-Da Hospital") ~ "Taiwan",
str_detect(institution, "(?i)National Formosa University") ~ "Taiwan",
str_detect(institution, "(?i)Chang Gung Memorial Hospital") ~ "Taiwan",
str_detect(institution, "(?i)New Taipei") ~ "Taiwan",
str_detect(institution, "(?i)Shu Zen Junior College of Medicine") ~ "Taiwan",
str_detect(institution, "(?i)National Chi Nan University") ~ "Taiwan",
# Turkey:
str_detect(institution, "(?i)Inonu University") ~ "Turkey",
str_detect(institution, "(?i)Provincial Health Directorate, Agri") ~ "Turkey",
str_detect(institution, "(?i)Baltalimani Metin Sabanci") ~ "Turkey",
str_detect(institution, "(?i)Selcuk University") ~ "Turkey",
# Vietnam:
str_detect(institution, "(?i)Nguyen Tat Thanh") ~ "Vietnam",
# Spain:
str_detect(institution, "(?i)Ciencies d'Alimentacio") ~ "Spain",
# Iran:
str_detect(institution, "(?i)Aja University") ~ "Iran",
# Rush University Medical Center:
str_detect(institution, "(?i)Rush University Medical Center") ~ "USA",
# Belgium:
str_detect(institution, "(?i)Institute Born-Bunge") ~ "Belgium",
# Peru:
str_detect(institution,  "Universidad Cientifica del Sur") ~ "Peru",
str_detect(institution,  "Universidad de San Martin de Porres") ~ "Peru",
str_detect(institution, "(?i)Universidad Cesar Vallejo") ~ "Peru",
# Israel:
str_detect(institution, "(?i)Beit-Berl College") ~ "Israel",
str_detect(institution, "(?i)Leslie and Susan Gonda") ~ "Israel",
str_detect(institution, "(?i)(Goldschmied) Multidisciplinary Brain Research Center") ~ "Israel",
str_detect(institution, "(?i)Bar-Ilan University") ~ "Israel",
str_detect(institution, "(?i)(Goldschmied)") ~ "Israel",
str_detect(institution, "(?i)Jerusalem") ~ "Israel",
# author not institution:
str_detect(institution, "(?i)Maya Sahu, RN, RM,") ~ "",
TRUE ~ as.character(countries_of_authors)  # Default if none of the above matches
)) %>%
mutate(countries_of_authors = case_when(cities_of_authors == "Lausanne" ~ "Switzerland",
cities_of_authors == "Tel Aviv" ~ "Israel",
cities_of_authors == "Jerusalem" ~ "Israel",                                          cities_of_authors == "Auckland" ~ "New Zealand",
cities_of_authors == "Netherlands" ~ "Netherlands",
cities_of_authors == "Rome" ~ "Italy",
TRUE ~ countries_of_authors))
