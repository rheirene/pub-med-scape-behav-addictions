<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Rob Heirene">
<meta name="dcterms.date" content="2023-09-15">

<title>PubMed Article Extraction Using rentrez</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="PubMed Article Extraction Using rentrez_files/libs/clipboard/clipboard.min.js"></script>
<script src="PubMed Article Extraction Using rentrez_files/libs/quarto-html/quarto.js"></script>
<script src="PubMed Article Extraction Using rentrez_files/libs/quarto-html/popper.min.js"></script>
<script src="PubMed Article Extraction Using rentrez_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="PubMed Article Extraction Using rentrez_files/libs/quarto-html/anchor.min.js"></script>
<link href="PubMed Article Extraction Using rentrez_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="PubMed Article Extraction Using rentrez_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="PubMed Article Extraction Using rentrez_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="PubMed Article Extraction Using rentrez_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="PubMed Article Extraction Using rentrez_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">Preamble</a></li>
  <li><a href="#load-packages" id="toc-load-packages" class="nav-link" data-scroll-target="#load-packages">Load packages</a></li>
  <li><a href="#behavioural-addictions" id="toc-behavioural-addictions" class="nav-link" data-scroll-target="#behavioural-addictions">Behavioural addictions</a></li>
  <li><a href="#define-the-search-termsstring" id="toc-define-the-search-termsstring" class="nav-link" data-scroll-target="#define-the-search-termsstring">Define the search terms/string:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles" id="toc-use-entrez_search-to-get-the-ids-of-the-articles" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles" id="toc-fetch-details-for-each-chunk-of-articles" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results" id="toc-check-the-results" class="nav-link" data-scroll-target="#check-the-results">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#gambling-addiction" id="toc-gambling-addiction" class="nav-link" data-scroll-target="#gambling-addiction">Gambling addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-termsstring-1" id="toc-define-the-search-termsstring-1" class="nav-link" data-scroll-target="#define-the-search-termsstring-1">Define the search terms/string:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-1" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-1" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-1">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-1" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-1" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-1">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-1" id="toc-fetch-details-for-each-chunk-of-articles-1" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-1">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-1" id="toc-check-the-results-1" class="nav-link" data-scroll-target="#check-the-results-1">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-1" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-1" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-1">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-1" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-1" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-1">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#gaming-addiction" id="toc-gaming-addiction" class="nav-link" data-scroll-target="#gaming-addiction">Gaming addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-termsstring-2" id="toc-define-the-search-termsstring-2" class="nav-link" data-scroll-target="#define-the-search-termsstring-2">Define the search terms/string:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-2" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-2" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-2">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-2" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-2" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-2">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-2" id="toc-fetch-details-for-each-chunk-of-articles-2" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-2">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-2" id="toc-check-the-results-2" class="nav-link" data-scroll-target="#check-the-results-2">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-2" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-2" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-2">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-2" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-2" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-2">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#work-addiction" id="toc-work-addiction" class="nav-link" data-scroll-target="#work-addiction">Work addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term" id="toc-define-the-search-term" class="nav-link" data-scroll-target="#define-the-search-term">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-3" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-3" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-3">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-3" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-3" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-3">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-3" id="toc-fetch-details-for-each-chunk-of-articles-3" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-3">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-3" id="toc-check-the-results-3" class="nav-link" data-scroll-target="#check-the-results-3">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-3" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-3" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-3">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-3" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-3" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-3">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#study-addiction" id="toc-study-addiction" class="nav-link" data-scroll-target="#study-addiction">Study addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-1" id="toc-define-the-search-term-1" class="nav-link" data-scroll-target="#define-the-search-term-1">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-4" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-4" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-4">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-4" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-4" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-4">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-4" id="toc-fetch-details-for-each-chunk-of-articles-4" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-4">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-4" id="toc-check-the-results-4" class="nav-link" data-scroll-target="#check-the-results-4">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-4" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-4" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-4">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-4" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-4" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-4">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#exercise-addiction" id="toc-exercise-addiction" class="nav-link" data-scroll-target="#exercise-addiction">Exercise addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-2" id="toc-define-the-search-term-2" class="nav-link" data-scroll-target="#define-the-search-term-2">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-5" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-5" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-5">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-5" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-5" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-5">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-5" id="toc-fetch-details-for-each-chunk-of-articles-5" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-5">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-5" id="toc-check-the-results-5" class="nav-link" data-scroll-target="#check-the-results-5">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-5" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-5" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-5">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-5" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-5" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-5">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#shopping-addiction" id="toc-shopping-addiction" class="nav-link" data-scroll-target="#shopping-addiction">Shopping addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-3" id="toc-define-the-search-term-3" class="nav-link" data-scroll-target="#define-the-search-term-3">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-6" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-6" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-6">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-6" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-6" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-6">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-6" id="toc-fetch-details-for-each-chunk-of-articles-6" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-6">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-6" id="toc-check-the-results-6" class="nav-link" data-scroll-target="#check-the-results-6">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-6" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-6" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-6">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-6" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-6" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-6">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#social-media-addiction" id="toc-social-media-addiction" class="nav-link" data-scroll-target="#social-media-addiction">Social media addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-4" id="toc-define-the-search-term-4" class="nav-link" data-scroll-target="#define-the-search-term-4">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-7" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-7" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-7">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-7" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-7" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-7">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-7" id="toc-fetch-details-for-each-chunk-of-articles-7" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-7">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-7" id="toc-check-the-results-7" class="nav-link" data-scroll-target="#check-the-results-7">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-7" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-7" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-7">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-7" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-7" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-7">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#internet-addiction" id="toc-internet-addiction" class="nav-link" data-scroll-target="#internet-addiction">Internet addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-5" id="toc-define-the-search-term-5" class="nav-link" data-scroll-target="#define-the-search-term-5">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-8" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-8" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-8">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-8" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-8" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-8">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-8" id="toc-fetch-details-for-each-chunk-of-articles-8" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-8">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-8" id="toc-check-the-results-8" class="nav-link" data-scroll-target="#check-the-results-8">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-8" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-8" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-8">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-8" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-8" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-8">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#smart-phone-addiction" id="toc-smart-phone-addiction" class="nav-link" data-scroll-target="#smart-phone-addiction">Smart phone addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-6" id="toc-define-the-search-term-6" class="nav-link" data-scroll-target="#define-the-search-term-6">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-9" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-9" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-9">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-9" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-9" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-9">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-9" id="toc-fetch-details-for-each-chunk-of-articles-9" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-9">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-9" id="toc-check-the-results-9" class="nav-link" data-scroll-target="#check-the-results-9">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-9" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-9" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-9">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-9" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-9" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-9">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#cybersex-addiction" id="toc-cybersex-addiction" class="nav-link" data-scroll-target="#cybersex-addiction">Cybersex addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-7" id="toc-define-the-search-term-7" class="nav-link" data-scroll-target="#define-the-search-term-7">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-10" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-10" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-10">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-10" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-10" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-10">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-10" id="toc-fetch-details-for-each-chunk-of-articles-10" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-10">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-10" id="toc-check-the-results-10" class="nav-link" data-scroll-target="#check-the-results-10">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-10" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-10" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-10">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-10" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-10" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-10">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#sex-addiction" id="toc-sex-addiction" class="nav-link" data-scroll-target="#sex-addiction">Sex addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-8" id="toc-define-the-search-term-8" class="nav-link" data-scroll-target="#define-the-search-term-8">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-11" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-11" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-11">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-11" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-11" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-11">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-11" id="toc-fetch-details-for-each-chunk-of-articles-11" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-11">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-11" id="toc-check-the-results-11" class="nav-link" data-scroll-target="#check-the-results-11">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-11" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-11" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-11">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-11" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-11" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-11">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#pornography-addiction" id="toc-pornography-addiction" class="nav-link" data-scroll-target="#pornography-addiction">Pornography addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-9" id="toc-define-the-search-term-9" class="nav-link" data-scroll-target="#define-the-search-term-9">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-12" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-12" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-12">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-12" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-12" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-12">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-12" id="toc-fetch-details-for-each-chunk-of-articles-12" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-12">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-12" id="toc-check-the-results-12" class="nav-link" data-scroll-target="#check-the-results-12">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-12" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-12" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-12">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-12" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-12" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-12">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#tanning-addiction" id="toc-tanning-addiction" class="nav-link" data-scroll-target="#tanning-addiction">Tanning addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-10" id="toc-define-the-search-term-10" class="nav-link" data-scroll-target="#define-the-search-term-10">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-13" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-13" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-13">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-13" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-13" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-13">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-13" id="toc-fetch-details-for-each-chunk-of-articles-13" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-13">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-13" id="toc-check-the-results-13" class="nav-link" data-scroll-target="#check-the-results-13">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-13" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-13" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-13">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-13" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-13" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-13">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#hair-pulling-addiction" id="toc-hair-pulling-addiction" class="nav-link" data-scroll-target="#hair-pulling-addiction">Hair pulling addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-11" id="toc-define-the-search-term-11" class="nav-link" data-scroll-target="#define-the-search-term-11">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-14" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-14" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-14">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-14" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-14" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-14">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-14" id="toc-fetch-details-for-each-chunk-of-articles-14" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-14">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-14" id="toc-check-the-results-14" class="nav-link" data-scroll-target="#check-the-results-14">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-14" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-14" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-14">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-14" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-14" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-14">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#love-addiction" id="toc-love-addiction" class="nav-link" data-scroll-target="#love-addiction">Love addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-12" id="toc-define-the-search-term-12" class="nav-link" data-scroll-target="#define-the-search-term-12">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-15" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-15" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-15">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-15" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-15" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-15">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-15" id="toc-fetch-details-for-each-chunk-of-articles-15" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-15">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-15" id="toc-check-the-results-15" class="nav-link" data-scroll-target="#check-the-results-15">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-15" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-15" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-15">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-15" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-15" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-15">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#selfie-addiction" id="toc-selfie-addiction" class="nav-link" data-scroll-target="#selfie-addiction">Selfie addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-13" id="toc-define-the-search-term-13" class="nav-link" data-scroll-target="#define-the-search-term-13">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-16" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-16" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-16">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-16" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-16" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-16">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-16" id="toc-fetch-details-for-each-chunk-of-articles-16" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-16">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-16" id="toc-check-the-results-16" class="nav-link" data-scroll-target="#check-the-results-16">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-16" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-16" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-16">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-16" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-16" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-16">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#extreme-sport-addiction" id="toc-extreme-sport-addiction" class="nav-link" data-scroll-target="#extreme-sport-addiction">Extreme sport addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-14" id="toc-define-the-search-term-14" class="nav-link" data-scroll-target="#define-the-search-term-14">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-17" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-17" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-17">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-17" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-17" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-17">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-17" id="toc-fetch-details-for-each-chunk-of-articles-17" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-17">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-17" id="toc-check-the-results-17" class="nav-link" data-scroll-target="#check-the-results-17">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-17" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-17" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-17">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-17" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-17" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-17">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#running-addiction" id="toc-running-addiction" class="nav-link" data-scroll-target="#running-addiction">Running addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-15" id="toc-define-the-search-term-15" class="nav-link" data-scroll-target="#define-the-search-term-15">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-18" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-18" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-18">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-18" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-18" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-18">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-18" id="toc-fetch-details-for-each-chunk-of-articles-18" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-18">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-18" id="toc-check-the-results-18" class="nav-link" data-scroll-target="#check-the-results-18">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-18" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-18" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-18">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-18" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-18" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-18">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#dance-addiction" id="toc-dance-addiction" class="nav-link" data-scroll-target="#dance-addiction">Dance addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-16" id="toc-define-the-search-term-16" class="nav-link" data-scroll-target="#define-the-search-term-16">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-19" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-19" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-19">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-19" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-19" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-19">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-19" id="toc-fetch-details-for-each-chunk-of-articles-19" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-19">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-19" id="toc-check-the-results-19" class="nav-link" data-scroll-target="#check-the-results-19">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-19" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-19" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-19">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-19" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-19" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-19">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#joy-riding-addiction" id="toc-joy-riding-addiction" class="nav-link" data-scroll-target="#joy-riding-addiction">Joy riding addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-17" id="toc-define-the-search-term-17" class="nav-link" data-scroll-target="#define-the-search-term-17">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-20" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-20" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-20">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-20" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-20" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-20">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-20" id="toc-fetch-details-for-each-chunk-of-articles-20" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-20">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-20" id="toc-check-the-results-20" class="nav-link" data-scroll-target="#check-the-results-20">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-20" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-20" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-20">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-20" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-20" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-20">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#crime-addiction" id="toc-crime-addiction" class="nav-link" data-scroll-target="#crime-addiction">Crime addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-18" id="toc-define-the-search-term-18" class="nav-link" data-scroll-target="#define-the-search-term-18">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-21" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-21" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-21">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-21" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-21" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-21">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-21" id="toc-fetch-details-for-each-chunk-of-articles-21" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-21">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-21" id="toc-check-the-results-21" class="nav-link" data-scroll-target="#check-the-results-21">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-21" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-21" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-21">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-21" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-21" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-21">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#polysurgical-addiction" id="toc-polysurgical-addiction" class="nav-link" data-scroll-target="#polysurgical-addiction">Polysurgical addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-19" id="toc-define-the-search-term-19" class="nav-link" data-scroll-target="#define-the-search-term-19">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-22" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-22" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-22">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-22" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-22" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-22">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-22" id="toc-fetch-details-for-each-chunk-of-articles-22" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-22">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-22" id="toc-check-the-results-22" class="nav-link" data-scroll-target="#check-the-results-22">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-22" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-22" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-22">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-22" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-22" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-22">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#fortune-telling-addiction" id="toc-fortune-telling-addiction" class="nav-link" data-scroll-target="#fortune-telling-addiction">Fortune telling addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-20" id="toc-define-the-search-term-20" class="nav-link" data-scroll-target="#define-the-search-term-20">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-23" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-23" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-23">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-23" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-23" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-23">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-23" id="toc-fetch-details-for-each-chunk-of-articles-23" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-23">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-23" id="toc-check-the-results-23" class="nav-link" data-scroll-target="#check-the-results-23">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-23" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-23" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-23">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-23" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-23" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-23">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#youtube-addiction" id="toc-youtube-addiction" class="nav-link" data-scroll-target="#youtube-addiction">YouTube addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-21" id="toc-define-the-search-term-21" class="nav-link" data-scroll-target="#define-the-search-term-21">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-24" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-24" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-24">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-24" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-24" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-24">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-24" id="toc-fetch-details-for-each-chunk-of-articles-24" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-24">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-24" id="toc-check-the-results-24" class="nav-link" data-scroll-target="#check-the-results-24">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-24" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-24" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-24">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-24" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-24" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-24">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#death-addiction" id="toc-death-addiction" class="nav-link" data-scroll-target="#death-addiction">Death addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-22" id="toc-define-the-search-term-22" class="nav-link" data-scroll-target="#define-the-search-term-22">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-25" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-25" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-25">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-25" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-25" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-25">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-25" id="toc-fetch-details-for-each-chunk-of-articles-25" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-25">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-25" id="toc-check-the-results-25" class="nav-link" data-scroll-target="#check-the-results-25">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-25" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-25" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-25">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-25" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-25" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-25">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#near-death-addiction" id="toc-near-death-addiction" class="nav-link" data-scroll-target="#near-death-addiction">Near death addiction</a></li>
  </ul></li>
  <li><a href="#define-the-search-term-23" id="toc-define-the-search-term-23" class="nav-link" data-scroll-target="#define-the-search-term-23">Define the search term:</a></li>
  <li><a href="#use-entrez_search-to-get-the-ids-of-the-articles-26" id="toc-use-entrez_search-to-get-the-ids-of-the-articles-26" class="nav-link" data-scroll-target="#use-entrez_search-to-get-the-ids-of-the-articles-26">Use entrez_search to get the IDs of the articles:</a></li>
  <li><a href="#split-id-list-into-chunks-of-100-for-chunkbatches-26" id="toc-split-id-list-into-chunks-of-100-for-chunkbatches-26" class="nav-link" data-scroll-target="#split-id-list-into-chunks-of-100-for-chunkbatches-26">Split id list into chunks of 100 for chunk/batches:</a></li>
  <li><a href="#fetch-details-for-each-chunk-of-articles-26" id="toc-fetch-details-for-each-chunk-of-articles-26" class="nav-link" data-scroll-target="#fetch-details-for-each-chunk-of-articles-26">Fetch details for each chunk of articles:</a></li>
  <li><a href="#check-the-results-26" id="toc-check-the-results-26" class="nav-link" data-scroll-target="#check-the-results-26">Check the results:</a></li>
  <li><a href="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-26" id="toc-lets-remove-the-identifiers-at-the-beginning-of-each-data-point-26" class="nav-link" data-scroll-target="#lets-remove-the-identifiers-at-the-beginning-of-each-data-point-26">Let’s remove the identifiers at the beginning of each data point:</a></li>
  <li><a href="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-26" id="toc-now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-26" class="nav-link" data-scroll-target="#now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-26">Now save the initial results before proceeding so we can’t lose them!</a>
  <ul class="collapse">
  <li><a href="#join-all-final-datasets" id="toc-join-all-final-datasets" class="nav-link" data-scroll-target="#join-all-final-datasets">Join all final datasets</a>
  <ul class="collapse">
  <li><a href="#end" id="toc-end" class="nav-link" data-scroll-target="#end">END</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PubMed Article Extraction Using rentrez</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Rob Heirene </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 15, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<p>The criteria for inclusion are:</p>
<ul>
<li>The article must be registered/stored on the PubMed database (a list of journals indexed on PubMed can be found <a href="https://ftp.ncbi.nih.gov/pubmed/J_Medline.txt">here</a>).</li>
</ul>
<!-- -->
<ul>
<li><p>The article must focus on a behaviour which has been studied within the context of addiction (e.g., gambling, exercise, video gaming); the behaviour can be the primary focus or a sub-component of a larger paper (e.g., a study on alcohol use which also measures symptoms of gambling disorder)</p></li>
<li><p>The article must use language in the title and/or abstract that indicate that the behaviour is discussed in the context of or as an addiction. This could include, but is not restricted to:</p>
<ul>
<li><p>the direct use of the terms “addiction” or “dependence”</p></li>
<li><p>the use of accepted (DSM/ICD) or previosuly accepted (e.g., “pathological gambling”) diagnostic terms (e.g., “gambling disorder”)</p></li>
<li><p>the use of a term or phrase which is not a clinically/medically accepted diagnostic term (i.e., it is not included in any nosological system), but is used in the research area as such (e.g., “compulsory exercise”, “workaholism”)</p></li>
<li><p>the use of measures of “addiction” to the behaviour (e.g., “Exercise Addiction Inventory”) or measures of the symptoms of addiction (e.g., craving, withdrawal) that are then discussed in the context of a disorder or addiction</p></li>
</ul></li>
<li><p>There are no restrictions on date of publication, study designs, article types (e.g., commentaries, empirical studies etc.)</p></li>
<li><p>There are no restrictions on language publication, provided the title and abstract are presented in English as well as the primary language.</p></li>
</ul>
<p>The above criteria were used to design of the search terms/strings employed to extract data from the PubMed database (the search string for each behavioural addiction is included before the code used to extract the associated studies). A manual scan of all return studies for relevance according to the above criteria has been made.</p>
<p>https://www.youtube.com/watch?v=yzTuBuRdAyA</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Code blocks
</div>
</div>
<div class="callout-body-container callout-body">
<p>Please note that any code chunks presented in this document that, when executed, scrape or pull data from PubMed, are specifically set so that they do not execute when this document renders. Thus, these code chunks, as seen here, simply represent documentation rather than working code. This is because extracting this data (particularly for “addictions” where there are thousands of studies [e.g., gambling]) can take a substantial amount of time and therefore it would take 30-40 minutes every time this document renders if these code chunks executed.</p>
<p>I only note this for anyone wanting to reproduce this analysis who tries to run the entire script by rendering the document. It’s also important as the date at the top of this document may not be the latest date of data extraction (it is only the last date this was rendered).</p>
<p>The latest dates of data extraction for each “behavioural addiction” are below:</p>
<ul>
<li>Behavioural addiction: 23/08/2023</li>
<li>Gambling: 10/07/2023</li>
<li>Gaming: 10/07/2023</li>
<li>Work: 10/07/2023</li>
<li>Study: 19/08/2023</li>
<li>Exercise: 10/07/2023</li>
<li>Social media: 19/08/2023</li>
<li>Smartphones: 19/08/2023</li>
<li>Cybersex: 19/08/2023</li>
<li>Sex: 19/08/2023</li>
<li>Ponography: 19/08/2023</li>
<li>Tanning: 19/08/2023</li>
<li>Hair pulling/ trichotillomania: 20/08/2023</li>
<li>Love: 20/08/2023</li>
<li>Selfies: 20/08/2023</li>
<li>Extreme sport: 20/08/2023</li>
<li>Running: 20/08/2023</li>
<li>Dance: 20/08/2023</li>
<li>Joy riding: 20/08/2023</li>
<li>Crime: 20/08/2023</li>
<li>Polysurgical addiction: 20/08/2023</li>
<li>Fortune-telling: 20/08/2023</li>
<li>YouTube: 20/08/2023</li>
<li>Death: 20/08/2023</li>
<li>Near death: 20/08/2023</li>
</ul>
</div>
</div>
<p>https://cran.r-project.org/web/packages/rentrez/vignettes/rentrez_tutorial.html</p>
</section>
<section id="load-packages" class="level2">
<h2 class="anchored" data-anchor-id="load-packages">Load packages</h2>
<div class="cell">
<details>
<summary>Set-up code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install and load the groundhog package to ensure consistency of the package versions used here:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("groundhog") # Install</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(groundhog) <span class="co"># Load</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># List desired packages:</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>packages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'rentrez'</span>,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>              <span class="st">'dplyr'</span>,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>              <span class="st">'tidyr'</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>              <span class="st">'purrr'</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>              <span class="st">'rvest'</span>,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>              <span class="st">'stringr'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Load desired package with versions specific to project start date:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">groundhog.library</span>(packages, <span class="st">"2023-06-07"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="behavioural-addictions" class="level2">
<h2 class="anchored" data-anchor-id="behavioural-addictions">Behavioural addictions</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> MeSH terms were pretty useless here (unlike the more specific behavioural addiction searches used below) so I relied on my knowledge of the field for terms to use.</p>
<p><strong>Actual search used:</strong> ((((“behavioural addiction<em>”[Title/Abstract]) OR (”behavioral addiction</em>”[Title/Abstract])) OR (“non-drug addiction<em>”[Title/Abstract])) OR (”non-substance addiction</em>”[Title/Abstract])) OR (“non-chemical addiction*“[Title/Abstract])</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=((((%22behavioural%20addiction*%22%5C%5BTitle%2FAbstract%5C%5D)%20OR%20(%22behavioral%20addiction%22%5C%5BTitle%2FAbstract%5C%5D))%20OR%20(%22non-drug%20addiction%22%5C%5BTitle%2FAbstract%5C%5D))%20OR%20(%22non-substance%20addiction%22%5C%5BTitle%2FAbstract%5C%5D))%20OR%20(%22non-chemical%20addiction%22%5C%5BTitle%2FAbstract%5C%5D)&amp;sort=pubdate&amp;size=200">link</a>. PubMed format display can be found <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%22behavioural+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22behavioral+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22non-drug+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22non-substance+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22non-chemical+addiction%22%5BTitle%2FAbstract%5D%29&amp;format=pubmed&amp;size=200">here</a></p>
<p><strong>Notes post-search:</strong> I manually scanned the results returned on the PubMed site for relevance and all appeared to meet the inclusion criteria. There will certainly be one of overlap between the studies returned from this search and the search is specific to individual behavioural addictions.</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: # rm(list = ls())</p>
</section>
</section>
<section id="define-the-search-termsstring" class="level1">
<h1>Define the search terms/string:</h1>
<p>search_term_behav_addictions &lt;- ’((((“behavioural addiction<em>”[Title/Abstract]) OR (”behavioral addiction</em>”[Title/Abstract])) OR (“non-drug addiction<em>”[Title/Abstract])) OR (”non-substance addiction</em>”[Title/Abstract])) OR (“non-chemical addiction*“[Title/Abstract])’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_behav_addictions &lt;- entrez_search(db=“pubmed”, term=search_term_behav_addictions, retmax=20000) id_list_behav_addictions &lt;- search_results_behav_addictions$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_behav_addictions, ceiling(seq_along(id_list_behav_addictions)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_behav_addictions &lt;- map_dfr(chunks, function(ids) { articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_behav_addictions &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_behav_addictions &lt;- bind_rows(details_behav_addictions)

return(details_df_behav_addictions)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results" class="level1">
<h1>Check the results:</h1>
<p>article_details_behav_addictions %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_behav_addictions &lt;- article_details_behav_addictions %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename( # Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_behav_addictions, “Data extraction/behav_addictions_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using `rvest`</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>Okay, so I'm struggling to get the <span class="in">`rentrez`</span> package to extract the full, non-truncated titles of articles. I want to make sure we have these so we can accurately identify duplicates, so we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from a manual search in PubMed (it uses the URL from this search), then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>::: {.callout-note appearance="minimal"}</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## Using the `revest` package</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>It's important to note that, unlike using the <span class="in">`rentrez`</span> package X uses data via PubMed's API, using the <span class="in">`rvest`</span> package involves scraping the PubMed website for information, and there are many important ethical and legal considerations surrounding web scraping (some of which vary from country to country) that you may need to consider before proceeding. See, for example, this useful <span class="co">[</span><span class="ot">paper</span><span class="co">](https://www.researchgate.net/profile/Vlad-Krotov/publication/324907302_Legality_and_Ethics_of_Web_Scraping/links/5aea622345851588dd8287dc/Legality-and-Ethics-of-Web-Scraping.pdf)</span>.</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>url_behav_addictions_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%22behavioural+addiction*%22%5BTitle%2FAbstract%5D%29+OR+%28%22behavioral+addiction*%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22non-drug+addiction*%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22non-substance+addiction*%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22non-chemical+addiction*%22%5BTitle%2FAbstract%5D%29&amp;sort=pubdate&amp;size=200"</span> <span class="co"># 1455 results on 07/09/2023. </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage:</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>webpage_behav_addictions_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_behav_addictions_rvest)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results:</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>results_count_behav_addictions <span class="ot">&lt;-</span> webpage_behav_addictions_rvest <span class="sc">%&gt;%</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages:</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>results_per_page_behav_addictions <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>total_pages_behav_addictions <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_behav_addictions[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_behav_addictions)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_behav_addictions and total_pages_behav_addictions:</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_behav_addictions)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_behav_addictions)</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame:</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>results_behav_addictions_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data:</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_behav_addictions <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_behav_addictions_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage:</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title:</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID:</span></span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data:</span></span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a>  current_results_behav_addictions <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results:</span></span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>  results_behav_addictions_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_behav_addictions_rvest, current_results_behav_addictions)</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server:</span></span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data:</span></span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_behav_addictions_rvest))</span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles results before proceeding so we can't lose them!</span></span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_behav_addictions_rvest, <span class="st">"Data extraction/behav_addictions_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>results_behav_addictions<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/behav_addictions_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>results_behav_addictions_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/behav_addictions_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets:</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>results_behav_addictions2 <span class="ot">&lt;-</span> results_behav_addictions <span class="sc">%&gt;%</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_behav_addictions_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,455 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Systematic… 3.77e7  2023 Sep   10.1… "Playin… Hurel, Elodie; … "CHU Nantes, …
 2 Standalone… 3.76e7  2023 Dec   S030… "Proble… Hamamura, Toshi… "KDDI Researc…
 3 The Role o… 3.76e7  2023 Aug   10.1… "Intern… Demirci, Esra; … "Department o…
 4 Addiction … 3.76e7  2023 Aug   10.1… "OBJECT… Kim, Hyoun S; M… "1Department …
 5 I feel add… 3.76e7  2023 &lt;NA&gt;  10.7… "BACKGR… Favieri, France… "Department o…
 6 Working me… 3.76e7  2023 Jul   S001… "BACKGR… Ngetich, Ronald… "Centre of Ex…
 7 Abnormal f… 3.76e7  2023 Aug   10.1… "BACKGR… Bellmunt-Gil, A… "1Turku Brain…
 8 A Systemat… 3.76e7  2023 Aug   10.3… "OBJECT… Sa, Rafael Rich… "Department o…
 9 Self-exclu… 3.76e7  2023 Aug   10.1… "BACKGR… Hakansson, A; K… "Department o…
10 Mapping th… 3.75e7  2023 Sep   S016… "Contem… Hunt, Brian; Za… "Institute fo…
# ℹ 1,445 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_behav_addictions2)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check dupliactes based on PMIDs:</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>results_behav_addictions2 <span class="sc">%&gt;%</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   PMID [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There is no evidence of clear PMID duplicates</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate titles:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>results_behav_addictions2 <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 13
# Groups:   Title [5]
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Psychology… 3.06e7  2018 Dec   10.1… "Having… Chung, Tammy     "University o…
 2 Psychology… 3.05e7  2018 Nov   10.1… "Having… Chung, Tammy     "University o…
 3 Impulse co… 2.95e7  2018 Aug   10.1… "Impuls… Marques, Ana; D… "EA 7280, Uni…
 4 Call for r… 2.95e7  2018 Mar   10.1…  &lt;NA&gt;    Potenza, Marc N…  &lt;NA&gt;         
 5 Call for r… 3.21e7  2018 Mar   10.1…  &lt;NA&gt;    Potenza, Marc N…  &lt;NA&gt;         
 6 [Behaviora… 3.05e7  2016 Feb   &lt;NA&gt;   &lt;NA&gt;    Karila, Laurent  "Service de p…
 7 Commentary… 2.66e7  2015 Sep   10.1… "This c… Blaszczynski, A… "School of Ps…
 8 Commentary… 2.66e7  2015 Sep   10.1… "This c… Spada, Marcanto… "Division of …
 9 [Behaviora… 2.60e7  2015 May   10.1…  &lt;NA&gt;    Boning, Jobst    "Zentrum fur …
10 [Behaviora… 2.31e7  2012 Dec   S075… "Each a… Guillou-Landrea… "Institut fed…
11 Impulse co… 2.22e7  2012 Jan   10.1… "Impuls… Vilas, Dolores;… "Institut Cli…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View() # Manually inspect duplicates</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># **There are quite a few duplicates but most of these are not true duplicates and instead two seperate commentaries on the same article or just articles with the same title published on different years by different people. There is, however, one duplicate that does appear to be genuine with the PMID: 32094908. Let's remove that next:**</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>results_behav_addictions3 <span class="ot">&lt;-</span> results_behav_addictions2 <span class="sc">%&gt;%</span> </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PMID <span class="sc">!=</span> <span class="st">"32094908"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we are confident that we have a clean dataset, let's explore!</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_behav_addictions3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1990    2015    2018    2018    2021    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(results_behav_addictions3<span class="sc">$</span>Year,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on 'Behavioural Addictions' (PubMed)"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>) <span class="co"># Even though the earliest year an article was published is 1994, I've set the range to started 1960 as this is where the starting point is across all other behavioural addiction searches.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>results_behav_addictions3 <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 378 × 2
   Journal_name_short                            n
   &lt;chr&gt;                                     &lt;int&gt;
 1 J Behav Addict                              184
 2 Front Psychiatry                             85
 3 Int J Environ Res Public Health              61
 4 Addict Behav                                 58
 5 Front Psychol                                40
 6 Addiction                                    36
 7 PLoS One                                     29
 8 J Gambl Stud                                 28
 9 Psychiatry Res                               24
10 CNS Spectr                                   18
11 Addict Biol                                  17
12 Cyberpsychol Behav Soc Netw                  16
13 J Clin Med                                   15
14 Adv Exp Med Biol                             14
15 Compr Psychiatry                             13
16 Neurosci Biobehav Rev                        11
17 Addict Behav Rep                             10
18 J Addict Dis                                 10
19 Aust N Z J Psychiatry                         9
20 Drug Alcohol Depend                           9
21 Encephale                                     9
22 Eur Addict Res                                9
23 Eur Neuropsychopharmacol                      9
24 Neuropsychopharmacology                       9
25 Prog Neuropsychopharmacol Biol Psychiatry     9
26 Adicciones                                    8
27 Am J Drug Alcohol Abuse                       8
28 BMC Psychiatry                                8
29 Clin Psychol Rev                              8
30 Front Behav Neurosci                          8
31 Nervenarzt                                    8
32 Psychiatr Danub                               8
33 Psychiatr Hung                                8
34 Psychol Addict Behav                          8
35 Psychopharmacology (Berl)                     8
36 Subst Use Misuse                              8
37 Int J Ment Health Addict                      7
38 Transl Psychiatry                             7
39 Appetite                                      6
40 Asian J Psychiatr                             6
41 Cureus                                        6
42 Curr Pharm Des                                6
43 J Neurosci                                    6
44 J Psychiatr Res                               6
45 Psychol Med                                   6
46 Sci Rep                                       6
47 Zh Nevrol Psikhiatr Im S S Korsakova          6
48 Am J Addict                                   5
49 Behav Sci (Basel)                             5
50 Brain Behav                                   5
# ℹ 328 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_behav_addictions_sans_duplicates) # Visually inspect results</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the behav_addictions search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>Label_Behavioural_addictions <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"behavioural_addictions"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_behav_addictions3))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>results_behav_addictions_final <span class="ot">&lt;-</span> results_behav_addictions3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Behavioural_addictions) <span class="sc">%&gt;%</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_behav_addictions_final)</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results:</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_behav_addictions_final, <span class="st">"Data extraction/behav_addictions_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gambling-addiction" class="level2">
<h2 class="anchored" data-anchor-id="gambling-addiction">Gambling addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-1" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-1">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> Mesh terms can be found <a href="https://www.ncbi.nlm.nih.gov/mesh/?term=gaming+disorder">here</a>. I tried adding “problem gambling” and it adds around 1,200 more studies, but the overall distribution over time remains very similar.</p>
<ul>
<li>One unavoidable issue with the gambling search is 2 of the 3 gambling-specific journals (International Gambling Studies &amp; Journal of Gambling Issues) are not indexed by PubMed. That said, most behavioural addiction and addiction-focused journals are, fortunately.</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Add gambling journals?
</div>
</div>
<div class="callout-body-container callout-body">
<p>A simple reminder to look into this.</p>
</div>
</div>
<p><strong>Actual search used:</strong> (“gambling disorder”[Title/Abstract]) OR (“disordered gambling”[Title/Abstract] OR “gambling addiction”[Title/Abstract]) OR (“addicted gambler*”[Title/Abstract]) OR (“pathological gambl*”[Title/Abstract]) OR (“compulsive gambl*”[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%22gambling+disorder%22%5BTitle%2FAbstract%5D%29+OR+%28%22disordered+gambling%22%5BTitle%2FAbstract%5D+OR+%22gambling+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22addicted+gambler*%22%5BTitle%2FAbstract%5D%29+OR+%28%22pathological+gambl*%22%5BTitle%2FAbstract%5D%29+OR+%28%22compulsive+gambl*%22%5BTitle%2FAbstract%5D%29&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected the results directly in the PubMed site. Many duplicates that require removal (performed below), but all studies appeared relevant (July 2023).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-termsstring-1" class="level1">
<h1>Define the search terms/string:</h1>
<p>search_term_gambling &lt;- ’(“gambling disorder”[Title/Abstract]) OR (“disordered gambling”[Title/Abstract] OR “gambling addiction”[Title/Abstract]) OR (“addicted gambler<em>”[Title/Abstract]) OR (”pathological gambl</em>”[Title/Abstract]) OR (“compulsive gambl*“[Title/Abstract])’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-1" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_gambling &lt;- entrez_search(db=“pubmed”, term=search_term_gambling, retmax=20000) id_list_gambling &lt;- search_results_gambling$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-1" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_gambling, ceiling(seq_along(id_list_gambling)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-1" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_gambling &lt;- map_dfr(chunks, function(ids) { articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_gambling &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_gambling &lt;- bind_rows(details_gambling)

return(details_df_gambling)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-1" class="level1">
<h1>Check the results:</h1>
<p>article_details_gambling %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-1" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_gambling &lt;- article_details_gambling %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename( # Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-1" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_gambling, “Data extraction/gambling_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>As above, we're going to use the <span class="in">`rvest`</span> package to scrape the titles of gambling papers, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>url_gambling_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%22gambling+disorder%22%5BTitle%2FAbstract%5D%29+OR+%28%22disordered+gambling%22%5BTitle%2FAbstract%5D+OR+%22gambling+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22addicted+gambler*%22%5BTitle%2FAbstract%5D%29+OR+%28%22pathological+gambl*%22%5BTitle%2FAbstract%5D%29+OR+%28%22compulsive+gambl*%22%5BTitle%2FAbstract%5D%29&amp;size=200"</span> <span class="co"># 3501 results on 10/07/2023</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage:</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>webpage_gambling_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_gambling_rvest)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results:</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>results_count_gambling <span class="ot">&lt;-</span> webpage_gambling_rvest <span class="sc">%&gt;%</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages:</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>results_per_page_gambling <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>total_pages_gambling <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_gambling[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_gambling)</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_gambling and total_pages_gambling:</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_gambling)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_gambling)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame:</span></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>results_gambling_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data:</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_gambling <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_gambling_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage:</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title:</span></span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID:</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data:</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>  current_results_gambling <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results:</span></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a>  results_gambling_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_gambling_rvest, current_results_gambling)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server:</span></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data:</span></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_gambling_rvest))</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles results before proceeding so we can't lose them!</span></span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_gambling_rvest, <span class="st">"Data extraction/gambling_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-1" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-1">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>results_gambling<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/gambling_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>results_gambling_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/gambling_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets:</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>results_gambling2 <span class="ot">&lt;-</span> results_gambling <span class="sc">%&gt;%</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_gambling_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,051 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Developmen… 3.74e7  2023 &lt;NA&gt;  10.3… "The re… Abdul Rahim, Ya… "Helsingborg …
 2 Pharmacoth… 3.74e7  2023 Jul   10.1… "BACKGR… Farkouh, Rezkal… "Faculty of P…
 3 The Parado… 3.74e7  2023 Jul   10.1… "The co… Tanaka, Masuo; … "Internationa…
 4 Using geos… 3.74e7  2023 Jun   fdad… "BACKGR… Saunders, Mike;… "Department o…
 5 Effect of … 3.74e7  2023 Jun   10.1… "AIMS: … Pfund, Rory A; … "Department o…
 6 Gambling a… 3.74e7  2023 May   10.3… "Gambli… Fontaine, Mayli… "Cognition La…
 7 Neural fin… 3.74e7  2023 Aug   S092… "Gambli… Schmidt, Casper… "Department o…
 8 Personal e… 3.74e7  2023 Jun   10.1… "BACKGR… Karlsson, Anna;… "1Department …
 9 Temporal o… 3.73e7  2023 Jun   10.1… "INTROD… Girard, Lisa-Ch… "Department o…
10 Chronicall… 3.73e7  2023 Jun   S002… "BACKGR… Stefanovics, El… "Department o…
# ℹ 4,041 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_gambling2)</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check duplicates based on PMIDs:</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_gambling2 <span class="sc">%&gt;%</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># there's a lot here</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  3502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a> results_gambling2 <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,012 × 13
# Groups:   PMID [463]
    Title        PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
    &lt;chr&gt;       &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
  1 Prevalenc… 3.66e7  2022 Dec   10.1… "Gambli… Gabellini, Elia… "Specific Pre…
  2 Prevalenc… 3.66e7  2022 Dec   10.1… "Gambli… Gabellini, Elia… "Specific Pre…
  3 Exploring… 3.64e7  2023 Mar   10.1… "INTROD… Fusaroli, Miche… "Pharmacology…
  4 Exploring… 3.64e7  2023 Mar   10.1… "INTROD… Fusaroli, Miche… "Pharmacology…
  5 Decision … 3.61e7  2022 Aug   10.3… "Tradit… Cabedo-Peris, J… "Departamento…
  6 Decision … 3.61e7  2022 Aug   10.3… "Tradit… Cabedo-Peris, J… "Departamento…
  7 Prevalenc… 3.60e7  2022 &lt;NA&gt;  10.1… "People… Matheson, Flora… "MAP Centre f…
  8 Prevalenc… 3.60e7  2022 &lt;NA&gt;  10.1… "People… Matheson, Flora… "MAP Centre f…
  9 The relat… 3.51e7  2022 Oct   10.1… "PURPOS… Celik, Sevim; O… "Nursing Depa…
 10 The relat… 3.51e7  2022 Oct   10.1… "PURPOS… Celik, Sevim; O… "Nursing Depa…
 11 The Effec… 3.43e7  2022 Sep   10.1… "Previo… de Ridder, Byro… "Monash Healt…
 12 The Effec… 3.43e7  2022 Sep   10.1… "Previo… de Ridder, Byro… "Monash Healt…
 13 Sign trac… 3.42e7  2021 Sep   10.1… "RATION… Swintosky, Mega… "Department o…
 14 Sign trac… 3.42e7  2021 Sep   10.1… "RATION… Swintosky, Mega… "Department o…
 15 Addictive… 3.42e7  2021 &lt;NA&gt;  10.1… "The us… Schulz van Ende… "School of Bu…
 16 Addictive… 3.42e7  2021 &lt;NA&gt;  10.1… "The us… Schulz van Ende… "School of Bu…
 17 Treatment… 3.40e7  2021 Feb   20br… "Pramip… Murphy, Lisa; L… "Sexual Behav…
 18 Treatment… 3.40e7  2021 Feb   20br… "Pramip… Murphy, Lisa; L… "Sexual Behav…
 19 Impulsivi… 3.40e7  2022 Mar   10.1… "Pathol… Ciobotaru, Came… "Faculty of P…
 20 Impulsivi… 3.40e7  2022 Mar   10.1… "Pathol… Ciobotaru, Came… "Faculty of P…
 21 Social Ec… 3.38e7  2021 Mar   10.3… "Proble… Oksanen, Atte; … "Faculty of S…
 22 Social Ec… 3.38e7  2021 Mar   10.3… "Proble… Oksanen, Atte; … "Faculty of S…
 23 Gambling … 3.37e7  2022 Mar   10.1… "Object… Lelonek-Kuleta,… "Institute of…
 24 Gambling … 3.37e7  2022 Mar   10.1… "Object… Lelonek-Kuleta,… "Institute of…
 25 Review of… 3.36e7  2021 Feb   &lt;NA&gt;   &lt;NA&gt;    Hasanovic, Mevl… "Department o…
 26 Review of… 3.36e7  2021 Feb   &lt;NA&gt;   &lt;NA&gt;    Hasanovic, Mevl… "Department o…
 27 The neura… 3.36e7  2022 Oct   10.1… "BACKGR… Skandali, Nikol… "Department o…
 28 The neura… 3.36e7  2022 Oct   10.1… "BACKGR… Skandali, Nikol… "Department o…
 29 Young peo… 3.33e7  2021 Jan-… 10.7… "Gambli… Treglia, E       "University o…
 30 Young peo… 3.33e7  2021 Jan-… 10.7… "Gambli… Treglia, E       "University o…
 31 Impulsive… 3.30e7  2020 Jun   1104… "OBJECT… Turek, Aleksand… "Uniwersytet …
 32 Impulsive… 3.30e7  2020 Jun   1104… "OBJECT… Turek, Aleksand… "Uniwersytet …
 33 Schizophr… 3.28e7  2020 Sep   S016… "Indivi… Fortgang, Rebec… "Department o…
 34 Schizophr… 3.28e7  2020 Sep   S016… "Indivi… Fortgang, Rebec… "Department o…
 35 Partial d… 2.87e7  2017 Dec   10.1… "OBJECT… Peterson, Evan;… "Psychiatry R…
 36 Partial d… 2.87e7  2017 Dec   10.1… "OBJECT… Peterson, Evan;… "Psychiatry R…
 37 Delay dis… 2.87e7  2017 Jul   10.1… "BACKGR… Owens, Max M; A… "Department o…
 38 Delay dis… 2.87e7  2017 Jul   10.1… "BACKGR… Owens, Max M; A… "Department o…
 39 Striatal … 2.86e7  2017 Oct   10.1… "Impuls… Loiodice, Simon… "1 EA7280 Neu…
 40 Striatal … 2.86e7  2017 Oct   10.1… "Impuls… Loiodice, Simon… "1 EA7280 Neu…
 41 Gambling … 2.86e7  2018 Mar   10.1… "Gambli… Mathieu, Sasha;… "Laboratory o…
 42 Gambling … 2.86e7  2018 Mar   10.1… "Gambli… Mathieu, Sasha;… "Laboratory o…
 43 Pathologi… 2.84e7  2017 Apr   10.1…  &lt;NA&gt;    Bowden-Jones, H… "National Pro…
 44 Pathologi… 2.84e7  2017 Apr   10.1…  &lt;NA&gt;    Bowden-Jones, H… "National Pro…
 45 Modulatin… 2.83e7  2017 May   10.1… "BACKGR… Benussi, A; Alb… "Neurology Un…
 46 Modulatin… 2.83e7  2017 May   10.1… "BACKGR… Benussi, A; Alb… "Neurology Un…
 47 Addiction… 2.83e7  2017 Aug   10.1… "BACKGR… Zink, A; Herrma… "Department o…
 48 Addiction… 2.83e7  2017 Aug   10.1… "BACKGR… Zink, A; Herrma… "Department o…
 49 Post-trau… 2.83e7  2017 Mar   10.1… "Backgr… Green, Cheryl L… "1 Department…
 50 Post-trau… 2.83e7  2017 Mar   10.1… "Backgr… Green, Cheryl L… "1 Department…
 51 The relat… 2.82e7  2017 Jun   S014… "Impuls… Santangelo, Gab… "Department o…
 52 The relat… 2.82e7  2017 Jun   S014… "Impuls… Santangelo, Gab… "Department o…
 53 Barriers … 2.78e7  2017 Jun   10.1… "A prev… Dabrowska, Kata… "Department o…
 54 Barriers … 2.78e7  2017 Jun   10.1… "A prev… Dabrowska, Kata… "Department o…
 55 The effec… 2.78e7  2016 Dec   S037… "Impuls… Peterson, Jenni… "Kansas State…
 56 The effec… 2.78e7  2016 Dec   S037… "Impuls… Peterson, Jenni… "Kansas State…
 57 Gambling … 2.76e7  2016 Sep   10.1… "Backgr… Assanangkorncha… "1 Epidemiolo…
 58 Gambling … 2.76e7  2016 Sep   10.1… "Backgr… Assanangkorncha… "1 Epidemiolo…
 59 Trends in… 2.76e7  2015 Oct   10.1… "The pu… Dixon, Mark R; … "Southern Ill…
 60 Trends in… 2.76e7  2015 Oct   10.1… "The pu… Dixon, Mark R; … "Southern Ill…
 61 Prevalenc… 2.75e7  2016 Oct   S016… "We exa… Kim, Byung-Soo;… "Department o…
 62 Prevalenc… 2.75e7  2016 Oct   S016… "We exa… Kim, Byung-Soo;… "Department o…
 63 Relations… 2.74e7  2016 Sep   10.1… "Backgr… Sanacora, Rache… "1 Yale Child…
 64 Relations… 2.74e7  2016 Sep   10.1… "Backgr… Sanacora, Rache… "1 Yale Child…
 65 Impulse c… 2.74e7  2016 Oct   10.1… "BACKGR… Antonini, A; Ch… "Parkinson Un…
 66 Impulse c… 2.74e7  2016 Oct   10.1… "BACKGR… Antonini, A; Ch… "Parkinson Un…
 67 Trait Imp… 2.73e7  2016 &lt;NA&gt;  10.3… "Apathy… Houeto, Jean-Lu… "Service de N…
 68 Trait Imp… 2.73e7  2016 &lt;NA&gt;  10.3… "Apathy… Houeto, Jean-Lu… "Service de N…
 69 Pathologi… 2.73e7  2016 Jul   S002… "Impuls… Brusa, L; Pavin… "UOC Neurolog…
 70 Pathologi… 2.73e7  2016 Jul   S002… "Impuls… Brusa, L; Pavin… "UOC Neurolog…
 71 The Exten… 2.72e7  2016 Jun   10.1… "Object… Canale, Natale;… "Department o…
 72 The Exten… 2.72e7  2016 Jun   10.1… "Object… Canale, Natale;… "Department o…
 73 Treating … 2.70e7  2016 Dec   &lt;NA&gt;  "The pr… McIntosh, C C; … "St Vincent's…
 74 Treating … 2.70e7  2016 Dec   &lt;NA&gt;  "The pr… McIntosh, C C; … "St Vincent's…
 75 Gambling … 2.70e7  2016 May   S016… "Previo… Fatseas, Melina… "Laboratoire …
 76 Gambling … 2.70e7  2016 May   S016… "Previo… Fatseas, Melina… "Laboratoire …
 77 Amplified… 2.70e7  2016 Sep   10.1… "Near-m… Sescousse, Guil… "Donders Inst…
 78 Amplified… 2.70e7  2016 Sep   10.1… "Near-m… Sescousse, Guil… "Donders Inst…
 79 Pathologi… 2.69e7  2017 Jul   10.1… "In lig… Fauth-Buhler, M… "Department o…
 80 Pathologi… 2.69e7  2017 Jul   10.1… "In lig… Fauth-Buhler, M… "Department o…
 81 Inactivat… 2.69e7  2017 Mar   S030… "Cognit… Barrus, M M; Ho… "Department o…
 82 Inactivat… 2.69e7  2017 Mar   S030… "Cognit… Barrus, M M; Ho… "Department o…
 83 Reward Pr… 2.68e7  2016 Dec   &lt;NA&gt;  "Among … Ciccarelli, Mar… "Department o…
 84 Reward Pr… 2.68e7  2016 Dec   &lt;NA&gt;  "Among … Ciccarelli, Mar… "Department o…
 85 Compulsiv… 2.68e7  2016 May   S092… "Compul… Figee, Martijn;… "Academic Med…
 86 Compulsiv… 2.68e7  2016 May   S092… "Compul… Figee, Martijn;… "Academic Med…
 87 Frontal c… 2.68e7  2017 May   10.1… "Neuroi… Zois, Evangelos… "Department o…
 88 Frontal c… 2.68e7  2017 May   10.1… "Neuroi… Zois, Evangelos… "Department o…
 89 [Predicto… 2.86e7  2016 &lt;NA&gt;  10.1… "Impuls… Sapronova, M R;… "Voyno-Yasene…
 90 [Predicto… 2.86e7  2016 &lt;NA&gt;  10.1… "Impuls… Sapronova, M R;… "Voyno-Yasene…
 91 Heterogen… 2.67e7  2016 Dec   &lt;NA&gt;  "Pathol… Takeuchi, Hidea… "Department o…
 92 Heterogen… 2.67e7  2016 Dec   &lt;NA&gt;  "Pathol… Takeuchi, Hidea… "Department o…
 93 Blunted E… 2.66e7  2016 Jun   10.1… "Pathol… Mick, Inge; Mye… "Centre for N…
 94 Blunted E… 2.66e7  2016 Jun   10.1… "Pathol… Mick, Inge; Mye… "Centre for N…
 95 Commentar… 2.66e7  2015 Sep   10.1… "This c… Blaszczynski, A… "School of Ps…
 96 Commentar… 2.66e7  2015 Sep   10.1… "This c… Blaszczynski, A… "School of Ps…
 97 Refining … 2.63e7  2015 Aug   10.3… "Proble… Faust, Kyle; Fa… "Department o…
 98 Refining … 2.63e7  2015 Aug   10.3… "Proble… Faust, Kyle; Fa… "Department o…
 99 Dopamine … 2.62e7  2015 Nov   S016… "Pramip… Newton, Thomas … "Baylor Colle…
100 Dopamine … 2.62e7  2015 Nov   S016… "Pramip… Newton, Thomas … "Baylor Colle…
# ℹ 912 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove these asap as they're clear duplicates:</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>results_gambling_sans_duplicates<span class="ot">&lt;-</span> results_gambling2 <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,502 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Developmen… 3.74e7  2023 &lt;NA&gt;  10.3… "The re… Abdul Rahim, Ya… "Helsingborg …
 2 Pharmacoth… 3.74e7  2023 Jul   10.1… "BACKGR… Farkouh, Rezkal… "Faculty of P…
 3 The Parado… 3.74e7  2023 Jul   10.1… "The co… Tanaka, Masuo; … "Internationa…
 4 Using geos… 3.74e7  2023 Jun   fdad… "BACKGR… Saunders, Mike;… "Department o…
 5 Effect of … 3.74e7  2023 Jun   10.1… "AIMS: … Pfund, Rory A; … "Department o…
 6 Gambling a… 3.74e7  2023 May   10.3… "Gambli… Fontaine, Mayli… "Cognition La…
 7 Neural fin… 3.74e7  2023 Aug   S092… "Gambli… Schmidt, Casper… "Department o…
 8 Personal e… 3.74e7  2023 Jun   10.1… "BACKGR… Karlsson, Anna;… "1Department …
 9 Temporal o… 3.73e7  2023 Jun   10.1… "INTROD… Girard, Lisa-Ch… "Department o…
10 Chronicall… 3.73e7  2023 Jun   S002… "BACKGR… Stefanovics, El… "Department o…
# ℹ 3,492 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title (there are some distinct papers with the same title like "gambling disorder", so this is too simplified, but it'll do for a quick check):</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_gambling2 <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  2932</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># How many duplicates (based on title alone) does this remove?</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(results_gambling_sans_duplicates) <span class="sc">-</span> Simple_duplicate_removal_n </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    n
1 570</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>results_gambling_sans_duplicates <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, Journal_name_short, Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [6]
   Title     PMID  Year Month   DOI     Abstract Full_Author_Name Author_Address
   &lt;chr&gt;    &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 &lt;NA&gt;  20517639  2011 Jun     10.100… "This s… Najavits, Lisa M "Harvard Medi…
 2 &lt;NA&gt;  20162442  2010 Dec     10.100… "This p… Najavits, Lisa M "Harvard Medi…
 3 &lt;NA&gt;  19424515  2008 Nov-Dec &lt;NA&gt;    "OBJECT… Abait, Patricia… "Programa de …
 4 &lt;NA&gt;  18273417  2007 Sep-Oct &lt;NA&gt;    "OBJECT… Abait, Patricia… "Programa de …
 5 &lt;NA&gt;  16574335  2006 &lt;NA&gt;    &lt;NA&gt;    "Intert… Takahashi, Taiki "Department o…
 6 &lt;NA&gt;  16516404  2006 &lt;NA&gt;    &lt;NA&gt;    "Risky … Takahashi, Taiki "Department o…
 7 &lt;NA&gt;   7836022  1994 Oct     &lt;NA&gt;     &lt;NA&gt;    Lester, D        "Center for t…
 8 &lt;NA&gt;   1950067  1991 &lt;NA&gt;    &lt;NA&gt;    "In an … Meyer, G         "Studiengang …
 9 &lt;NA&gt;   3788246  1986 &lt;NA&gt;    &lt;NA&gt;    "The in… Meyer, G          &lt;NA&gt;         
10 &lt;NA&gt;   7399752  1980 Feb     &lt;NA&gt;    "The te… Lester, D         &lt;NA&gt;         
11 &lt;NA&gt;   5646092  1968 Apr     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt;              &lt;NA&gt;         
12 &lt;NA&gt;  20790478  1965 Mar     &lt;NA&gt;     &lt;NA&gt;    &lt;NA&gt;              &lt;NA&gt;         
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>results_gambling_sans_duplicates <span class="sc">%&gt;%</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, Journal_name_short, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View()</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 168 × 13
# Groups:   Title, Journal_name_short, Year [61]
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 &lt;NA&gt;        3.64e7  2022 Nov   10.1… "This r… Philander, Kahl… "School of Ho…
 2 &lt;NA&gt;        3.60e7  2022 Aug   10.1… "The st… To, Wai Ming; H… "Faculty of B…
 3 Gambling d… 3.56e7  2022 Jun   S221…  &lt;NA&gt;    Suanes, Patrici… "College of M…
 4 Gambling d… 3.56e7  2022 Jun   S221…  &lt;NA&gt;    van Schalkwyk, … "Faculty of P…
 5 &lt;NA&gt;        3.42e7  2022 Jun   10.1… "Latent… Black, Donald W… "Department o…
 6 &lt;NA&gt;        3.40e7  2022 Mar   10.1… "Casino… Chow, Chin Fung… ", London, UK…
 7 Gambling d… 3.13e7  2019 Jul   10.1…  &lt;NA&gt;    &lt;NA&gt;              &lt;NA&gt;         
 8 Gambling d… 3.13e7  2019 Jul   10.1… "Gambli… Potenza, Marc N… "Department o…
 9 &lt;NA&gt;        3.02e7  2018 Sep   10.1… "BACKGR… Jacob, Louis; H… "1 Faculty of…
10 &lt;NA&gt;        2.98e7  2018 Jun   10.1… "Backgr… Krause, Kristia… "1 Institute …
# ℹ 158 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are a few more of these, suggesting there are some papers with the same title, journal and date but different authors. </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The only one of concern is this one (PMID: 31346181) which is  garaphical abstract for another paper by the looks. </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicates based on above observation:</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>results_gambling_sans_duplicates2<span class="ot">&lt;-</span> results_gambling_sans_duplicates <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(PMID <span class="sc">!=</span> <span class="st">"31346181"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,501 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Developmen… 3.74e7  2023 &lt;NA&gt;  10.3… "The re… Abdul Rahim, Ya… "Helsingborg …
 2 Pharmacoth… 3.74e7  2023 Jul   10.1… "BACKGR… Farkouh, Rezkal… "Faculty of P…
 3 The Parado… 3.74e7  2023 Jul   10.1… "The co… Tanaka, Masuo; … "Internationa…
 4 Using geos… 3.74e7  2023 Jun   fdad… "BACKGR… Saunders, Mike;… "Department o…
 5 Effect of … 3.74e7  2023 Jun   10.1… "AIMS: … Pfund, Rory A; … "Department o…
 6 Gambling a… 3.74e7  2023 May   10.3… "Gambli… Fontaine, Mayli… "Cognition La…
 7 Neural fin… 3.74e7  2023 Aug   S092… "Gambli… Schmidt, Casper… "Department o…
 8 Personal e… 3.74e7  2023 Jun   10.1… "BACKGR… Karlsson, Anna;… "1Department …
 9 Temporal o… 3.73e7  2023 Jun   10.1… "INTROD… Girard, Lisa-Ch… "Department o…
10 Chronicall… 3.73e7  2023 Jun   S002… "BACKGR… Stefanovics, El… "Department o…
# ℹ 3,491 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check this has removed the duplicate:</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(results_gambling_sans_duplicates) <span class="sc">-</span> <span class="fu">count</span>(results_gambling_sans_duplicates2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n
1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we have a clean dataset, let's explore!</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_gambling_sans_duplicates2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1961    2008    2014    2012    2019    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>Gambling_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_gambling_sans_duplicates2<span class="sc">$</span>Year,</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">60</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Gambling Disorder (PubMed)"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>results_gambling_sans_duplicates2 <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 658 × 2
   Journal_name_short                            n
   &lt;chr&gt;                                     &lt;int&gt;
 1 J Gambl Stud                                575
 2 J Behav Addict                              148
 3 Addict Behav                                128
 4 Addiction                                    91
 5 Psychiatry Res                               81
 6 Front Psychiatry                             67
 7 Psychol Addict Behav                         64
 8 Front Psychol                                48
 9 Int J Environ Res Public Health              39
10 Am J Addict                                  34
11 Mov Disord                                   33
12 PLoS One                                     33
13 Compr Psychiatry                             32
14 J Clin Psychiatry                            30
15 Can J Psychiatry                             29
16 Am J Psychiatry                              27
17 Parkinsonism Relat Disord                    27
18 CNS Spectr                                   24
19 Psychol Rep                                  24
20 J Psychiatr Res                              23
21 Ann Clin Psychiatry                          21
22 J Addict Med                                 21
23 Neuropsychopharmacology                      21
24 Addict Biol                                  20
25 Drug Alcohol Depend                          20
26 Encephale                                    20
27 J Addict Dis                                 19
28 Neurosci Biobehav Rev                        18
29 Prog Neuropsychopharmacol Biol Psychiatry    18
30 Br J Psychiatry                              17
31 J Nerv Ment Dis                              17
32 Psychol Med                                  17
33 Subst Use Misuse                             17
34 Biol Psychiatry                              16
35 BMC Psychiatry                               15
36 Front Behav Neurosci                         15
37 J Neurosci                                   15
38 Psychopharmacology (Berl)                    15
39 Zh Nevrol Psikhiatr Im S S Korsakova         15
40 Adicciones                                   14
41 Braz J Psychiatry                            14
42 Eur Addict Res                               14
43 Sci Rep                                      14
44 Behav Brain Res                              13
45 Eur Neuropsychopharmacol                     13
46 Int J Addict                                 13
47 Psychiatr Danub                              13
48 Acta Psychiatr Scand                         12
49 Clin Neuropharmacol                          12
50 Curr Opin Psychiatry                         12
# ℹ 608 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_gambling_sans_duplicates) # Visually inspect results</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the gambling search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(results_gambling_sans_duplicates2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  3501</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Label_Gambling <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"gambling"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_gambling_sans_duplicates2))</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>results_gambling_final <span class="ot">&lt;-</span> results_gambling_sans_duplicates2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Gambling) <span class="sc">%&gt;%</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_gambling_final)</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results:</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_gambling_final, <span class="st">"Data extraction/gambling_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gaming-addiction" class="level2">
<h2 class="anchored" data-anchor-id="gaming-addiction">Gaming addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-2" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-2">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> Mesh terms can be found <a href="https://www.ncbi.nlm.nih.gov/mesh/?term=gaming+disorder">here</a>. Didn’t use all of these terms as some relate to other behavioural addictions</p>
<p><strong>Actual search used:</strong> (((((“gaming disorder”[Title/Abstract]) OR (“internet gaming disorder”[Title/Abstract])) OR (“gaming addiction”[Title/Abstract])) OR (“video game addiction”[Title/Abstract])) OR (“video game disorder”[Title/Abstract])) OR (“gaming dependence”)</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%28%22gaming+disorder%22%5BTitle%2FAbstract%5D%29+OR+%28%22internet+gaming+disorder%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22gaming+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22video+game+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22video+game+disorder%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22gaming+dependence%22%29&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> “video game dependence” returned no results and so was removed. I manually inspected the results directly in the PubMed site and all appeared relevant (July 2023).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: # rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-termsstring-2" class="level1">
<h1>Define the search terms/string:</h1>
<p>search_term_gaming &lt;- ‘(((((“gaming disorder”[Title/Abstract]) OR (“internet gaming disorder”[Title/Abstract])) OR (“gaming addiction”[Title/Abstract])) OR (“video game addiction”[Title/Abstract])) OR (“video game disorder”[Title/Abstract])) OR (“gaming dependence”)’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-2" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_gaming &lt;- entrez_search(db=“pubmed”, term=search_term_gaming, retmax=20000) id_list_gaming &lt;- search_results_gaming$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-2" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_gaming, ceiling(seq_along(id_list_gaming)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-2" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_gaming &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_gaming &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_gaming &lt;- bind_rows(details_gaming)

return(details_df_gaming)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-2" class="level1">
<h1>Check the results:</h1>
<p>article_details_gaming %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-2" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_gaming &lt;- article_details_gaming %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-2" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_gaming, “Data extraction/gaming_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>As with the gambling study extraction, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>url_gaming_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%28%22gaming+disorder%22%5BTitle%2FAbstract%5D%29+OR+%28%22internet+gaming+disorder%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22gaming+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22video+game+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22video+game+disorder%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22gaming+dependence%22%29&amp;size=200"</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>webpage_gaming_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_gaming_rvest)</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>results_count_gaming <span class="ot">&lt;-</span> webpage_gaming_rvest <span class="sc">%&gt;%</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>results_per_page_gaming <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>total_pages_gaming <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_gaming[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_gaming)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_gaming and total_pages_gaming</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_gaming)</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_gaming)</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>results_gaming_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_gaming <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_gaming_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID:</span></span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data:</span></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  current_results_gaming <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results:</span></span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a>  results_gaming_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_gaming_rvest, current_results_gaming)</span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server:</span></span>
<span id="cb47-62"><a href="#cb47-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb47-63"><a href="#cb47-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb47-64"><a href="#cb47-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-65"><a href="#cb47-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-66"><a href="#cb47-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data:</span></span>
<span id="cb47-67"><a href="#cb47-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_gaming_rvest))</span>
<span id="cb47-68"><a href="#cb47-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-69"><a href="#cb47-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb47-70"><a href="#cb47-70" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_gaming_rvest, <span class="st">"Data extraction/gaming_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-2" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-2">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>results_gaming<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/gaming_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>results_gaming_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/gaming_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets:</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>results_gaming2 <span class="ot">&lt;-</span> results_gaming <span class="sc">%&gt;%</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_gaming_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,569 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Letter to … 3.74e7  2023 Jun   S002…  &lt;NA&gt;    Montag, Christi… "Department o…
 2 Positive y… 3.74e7  2023 &lt;NA&gt;  10.1… "As an … Gan, Xiong; Wan… "Department o…
 3 Social sup… 3.74e7  2023 Jun   S002… "BACKGR… Malak, Malakeh … "Community He…
 4 The serial… 3.74e7  2023 Jun   10.1… "Gaming… Servidio, Rocco… "Department o…
 5 The Big Fi… 3.74e7  2023 May   10.3… "Relati… Wartberg, Lutz;… "Department o…
 6 Commentary… 3.74e7  2023 Jun   10.1…  &lt;NA&gt;    Luquiens, Amand… "Department o…
 7 Problemati… 3.74e7  2023 Jun   10.1… "As res… Ghazi, Farah Ra… "Department o…
 8 Relationsh… 3.74e7  2023 Apr   10.1… "Resear… Li, Li; Niu, Zh… "Ganzhou, Chi…
 9 Examining … 3.74e7  2023 May   10.1… "This s… Yildiz Durak, H… "Konya, Turke…
10 Cross-Cult… 3.74e7  2023 May   10.1… "Empiri… Kochuchakkalack… "Manila, Phil…
# ℹ 1,559 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_gaming2)</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_gaming2 <span class="sc">%&gt;%</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  1569</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_gaming2 <span class="sc">%&gt;%</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  1568</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate:</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>results_gaming2 <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="co"># **This is actually two seperate studies**</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
# Groups:   Title [1]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Technologic… 3.61e7  2022 Sep   S019… "Modern… Sherer, James; … "New York Uni…
2 Technologic… 3.58e7  2022 Sep   10.1… "PURPOS… Sherer, James; … "New York Uni…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I know from manual searching that there is a genuine duplicate that is a corrigendum to one study. The PMID  for the corrigendum is 35543161 (Remove later)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>results_gaming2 <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>           Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>results_gaming2 <span class="sc">%&gt;%</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Year [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the duplicate study:</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>results_gaming_sans_duplicates<span class="ot">&lt;-</span> results_gaming2 <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(PMID <span class="sc">!=</span> <span class="st">"35543161"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,568 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Letter to … 3.74e7  2023 Jun   S002…  &lt;NA&gt;    Montag, Christi… "Department o…
 2 Positive y… 3.74e7  2023 &lt;NA&gt;  10.1… "As an … Gan, Xiong; Wan… "Department o…
 3 Social sup… 3.74e7  2023 Jun   S002… "BACKGR… Malak, Malakeh … "Community He…
 4 The serial… 3.74e7  2023 Jun   10.1… "Gaming… Servidio, Rocco… "Department o…
 5 The Big Fi… 3.74e7  2023 May   10.3… "Relati… Wartberg, Lutz;… "Department o…
 6 Commentary… 3.74e7  2023 Jun   10.1…  &lt;NA&gt;    Luquiens, Amand… "Department o…
 7 Problemati… 3.74e7  2023 Jun   10.1… "As res… Ghazi, Farah Ra… "Department o…
 8 Relationsh… 3.74e7  2023 Apr   10.1… "Resear… Li, Li; Niu, Zh… "Ganzhou, Chi…
 9 Examining … 3.74e7  2023 May   10.1… "This s… Yildiz Durak, H… "Konya, Turke…
10 Cross-Cult… 3.74e7  2023 May   10.1… "Empiri… Kochuchakkalack… "Manila, Phil…
# ℹ 1,558 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check this has just remove one study</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(results_gaming2) <span class="sc">-</span> <span class="fu">count</span>(results_gaming_sans_duplicates) <span class="co"># Yep</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  n
1 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we have a clean dataset, let's explore!</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_gaming_sans_duplicates<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1994    2017    2020    2019    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>gaming_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_gaming_sans_duplicates<span class="sc">$</span>Year,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">40</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Gaming Disorder (PubMed)"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>results_gaming_sans_duplicates <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 335 × 2
   Journal_name_short                            n
   &lt;chr&gt;                                     &lt;int&gt;
 1 J Behav Addict                              185
 2 Front Psychiatry                             95
 3 Int J Environ Res Public Health              91
 4 Addict Behav                                 83
 5 Cyberpsychol Behav Soc Netw                  51
 6 Front Psychol                                49
 7 Addiction                                    36
 8 Addict Behav Rep                             35
 9 Addict Biol                                  31
10 PLoS One                                     27
11 J Psychiatr Res                              25
12 Psychiatry Res                               23
13 Int J Ment Health Addict                     19
14 Prog Neuropsychopharmacol Biol Psychiatry    19
15 BMC Psychiatry                               18
16 J Clin Med                                   18
17 Front Public Health                          14
18 Psychiatry Investig                          14
19 Sci Rep                                      14
20 J Affect Disord                              13
# ℹ 315 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_gaming_sans_duplicates) # Visually inspect results</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the gaming search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="fu">count</span>(results_gaming_sans_duplicates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  1568</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>Label_Gaming <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"gaming"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_gaming_sans_duplicates))</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>results_gaming_final <span class="ot">&lt;-</span> results_gaming_sans_duplicates <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Gaming) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_gaming_final)</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results:</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_gaming_final, <span class="st">"Data extraction/gaming_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="work-addiction" class="level2">
<h2 class="anchored" data-anchor-id="work-addiction">Work addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-3" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-3">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> Some key terms I have found in the literature are “<a href="https://pubmed.ncbi.nlm.nih.gov/30920291">work addiction</a>” and “<a href="https://pubmed.ncbi.nlm.nih.gov/28425778">workaholism</a>”</p>
<div class="callout callout-style-simple callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Workaholism
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="https://doi.org/10.1556/2006.7.2018.05">Griffiths et al.&nbsp;(2018)</a> argue that while work addiction and “workaholism” are similar and used interchangeably, the latter can refer more broadly to excessive work and can sometimes be used positively. After reviewing the studies on workaholism, it seems they often <a href="https://pubmed.ncbi.nlm.nih.gov/33465021/">use addiction terminology</a> and/or focus on the <a href="https://pubmed.ncbi.nlm.nih.gov/34909987/">negative effects on people’s lives</a> in a way that resembles addiction research so I decided to retain this search term here.</p>
</div>
</div>
<p><strong>Actual search used:</strong> ((“work addiction”[Title/Abstract]) OR (“addiction to work”[Title/Abstract])) OR (“workaholism”[Title/Abstract])</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%22work+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22addiction+to+work%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22workaholism%22%5BTitle%2FAbstract%5D%29&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> Again, I manually inspected all of the results directly in the PubMed site. All appeared relevant.</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term" class="level1">
<h1>Define the search term:</h1>
<p>search_term_work &lt;- ‘(“work addiction”[Title/Abstract]) OR (“addiction to work”[Title/Abstract]) OR (“workaholism”[Title/Abstract])’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-3" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_work &lt;- entrez_search(db=“pubmed”, term=search_term_work, retmax=20000) id_list_work &lt;- search_results_work$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-3" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_work, ceiling(seq_along(id_list_work)/500))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-3" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_work &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_work &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_work &lt;- bind_rows(details_work)

return(details_df_work)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-3" class="level1">
<h1>Check the results:</h1>
<p>article_details_work %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-3" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_work &lt;- article_details_work %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-3" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_work, “Data extraction/work_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the URL</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>url_work_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%22work+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22addiction+to+work%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22workaholism%22%5BTitle%2FAbstract%5D%29&amp;size=200"</span> <span class="co"># 275 results on 20/07/2023</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>webpage_work_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_work_rvest)</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>results_count_work <span class="ot">&lt;-</span> webpage_work_rvest <span class="sc">%&gt;%</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a>results_per_page_work <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>total_pages_work <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_work[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_work)</span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_work and total_pages_work</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_work)</span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_work)</span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>results_work_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_work <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_work_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-39"><a href="#cb73-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb73-40"><a href="#cb73-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb73-41"><a href="#cb73-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb73-42"><a href="#cb73-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-43"><a href="#cb73-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-44"><a href="#cb73-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb73-45"><a href="#cb73-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb73-46"><a href="#cb73-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb73-47"><a href="#cb73-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb73-48"><a href="#cb73-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-49"><a href="#cb73-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb73-50"><a href="#cb73-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb73-51"><a href="#cb73-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-52"><a href="#cb73-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-53"><a href="#cb73-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-54"><a href="#cb73-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb73-55"><a href="#cb73-55" aria-hidden="true" tabindex="-1"></a>  current_results_work <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb73-56"><a href="#cb73-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb73-57"><a href="#cb73-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-58"><a href="#cb73-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb73-59"><a href="#cb73-59" aria-hidden="true" tabindex="-1"></a>  results_work_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_work_rvest, current_results_work)</span>
<span id="cb73-60"><a href="#cb73-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-61"><a href="#cb73-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb73-62"><a href="#cb73-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb73-63"><a href="#cb73-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb73-64"><a href="#cb73-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-65"><a href="#cb73-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-66"><a href="#cb73-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb73-67"><a href="#cb73-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_work_rvest))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-3" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-3">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>results_work<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/work_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>results_work_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/work_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets:</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>results_work2 <span class="ot">&lt;-</span> results_work <span class="sc">%&gt;%</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_work_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 275 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 The social… 3.74e7  2023 Jun   10.1… "Workah… Negura, Lilian;… "University o…
 2 Validity a… 3.72e7  2023 &lt;NA&gt;  10.3… "BACKGR… Liu, Yuanyuan; … "Department o…
 3 Effects of… 3.72e7  2023 May   bmjq… "OBJECT… Maisonneuve, Fr… "Human Resour…
 4 Work addic… 3.71e7  2023 &lt;NA&gt;  10.3… "INTROD… Bereznowski, Pi… "Faculty of S…
 5 Severity o… 3.69e7  2023 Jun   10.1… "INTROD… Peter, Lea; Pak… "Department o…
 6 The Role o… 3.69e7  2023 Mar   10.3… "The cu… Morkeviciute, M… "Department o…
 7 How and Wh… 3.67e7  2023 Jan   10.3… "Althou… Sommovigo, Vale… "Department o…
 8 Associatio… 3.66e7  2022 &lt;NA&gt;  10.3… "INTROD… Wettstein, Alex… "Department o…
 9 Effect of … 3.66e7  2023 May   10.1… "AIM: T… Xie, Lin-Li; Ji… "University o…
10 Validity o… 3.65e7  2022 Dec   10.1… "There … Seretis, Dionys… "Department o…
# ℹ 265 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_work2 <span class="sc">%&gt;%</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_work2 <span class="sc">%&gt;%</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>results_work2 <span class="sc">%&gt;%</span> </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>           Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>results_work2 <span class="sc">%&gt;%</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)<span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Year [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Upon manual inspection of the dataset, there appears to be one study with the title "Overearning"  which doesn't seem to meet my criteria for inclusion.  Therefore, let's remove this here:</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Visually inspect for duplicates/Check results:</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_work2)</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Confirming that I have checked this reduces the number of studies by 1.</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we are confident that we have a clean dataset, let's explore!</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_work2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1979    2014    2018    2015    2021    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>work_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_work2<span class="sc">$</span>Year,</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">40</span>,</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Work Addiction (PubMed)"</span>,</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>results_work2 <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 120 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 Int J Environ Res Public Health    31
 2 Front Psychol                      20
 3 J Behav Addict                     20
 4 Psychol Rep                        15
 5 Ind Health                          9
 6 J Occup Health Psychol              6
 7 Work                                6
 8 Med Pr                              5
 9 PLoS One                            5
10 Encephale                           4
11 Eur J Psychol                       4
12 Front Public Health                 4
13 Int J Behav Med                     4
14 J Occup Environ Med                 4
15 J Pers Assess                       4
16 Soc Sci Med                         4
17 Stress Health                       4
18 Int J Occup Med Environ Health      3
19 J Psychol                           3
20 Occup Med (Lond)                    3
# ℹ 100 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the work search so that we can distinguish them from other studies results_work2 we later joined the datasets together:</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>Label_work <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"work"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_work2))</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>results_work_final <span class="ot">&lt;-</span> results_work2 <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(Label_work) <span class="sc">%&gt;%</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_work_final)</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_work_final, <span class="st">"Data extraction/work_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="study-addiction" class="level2">
<h2 class="anchored" data-anchor-id="study-addiction">Study addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-4" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-4">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No MeSH terms available.</p>
<p><strong>Actual search used:</strong> “Study addiction”[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Study+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> Had to be careful with the specific terms used here not to pick up phrases that relate to the study of addiction. Despite only including one search phrase, this issue still occurred where the phrase ” study addiction” is included in a sentence like: ” behavioural models used to study addiction…“. The following studies are irrelevant and need to be removed as a result of this issue:</p>
<ul>
<li>Oxytocin and Rodent Models of Addiction.</li>
<li>Experimental Models on Effects of Psychostimulants.</li>
<li>Self-administration of drugs in animals and humans as a model and an investigative tool.</li>
<li>Substance abuse and white matter: Findings, limitations, and future of diffusion tensor imaging research.</li>
<li>Quantifying reinforcement value and demand for psychoactive substances in humans.</li>
<li>Quantifying reinforcement value and demand for psychoactive substances in humans.</li>
<li>How can sociological theory help our understanding of addictions?</li>
<li>Kappa-Opioid Antagonists for Psychiatric Disorders: From Bench to Clinical Trials.</li>
<li>Virus-delivered RNA interference in mouse brain to study addiction-related behaviors.</li>
<li>Prenatal ethanol exposure increases risk of psychostimulant addiction.</li>
<li>Prevalence and practice of opioid prescription at a Swiss emergency department: 2013-2017.</li>
<li>Operant sensation seeking in the mouse.</li>
<li>Place conditioning to apomorphine in rat models of Parkinson’s disease: differences by dose and side-effect expression.</li>
<li>Conditioned locomotion is not correlated with behavioral sensitization to cocaine: an intra-laboratory multi-sample analysis.</li>
<li>Development of a mouse model of ethanol addiction: naltrexone efficacy in reducing consumption but not craving.</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-1" class="level1">
<h1>Define the search term:</h1>
<p>search_term_study &lt;- ‘“Study addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-4" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_study &lt;- entrez_search(db=“pubmed”, term=search_term_study, retmax=20000) id_list_study &lt;- search_results_study$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-4" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_study, ceiling(seq_along(id_list_study)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-4" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_study &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_study &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_study &lt;- bind_rows(details_study)

return(details_df_study)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-4" class="level1">
<h1>Check the results:</h1>
<p>article_details_study %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-4" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_study &lt;- article_details_study %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-4" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_study, “Data extraction/study_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>url_study_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Study+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 33 results returned on 19/08/2023</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>webpage_study_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_study_rvest)</span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>results_count_study <span class="ot">&lt;-</span> webpage_study_rvest <span class="sc">%&gt;%</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a>results_per_page_study <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a>total_pages_study <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_study[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_study)</span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_study and total_pages_study</span></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_study)</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_study)</span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>results_study_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_study <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_study_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-54"><a href="#cb91-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a>  current_results_study <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a>  results_study_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_study_rvest, current_results_study)</span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb91-62"><a href="#cb91-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb91-63"><a href="#cb91-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb91-64"><a href="#cb91-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-65"><a href="#cb91-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-66"><a href="#cb91-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb91-67"><a href="#cb91-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_study_rvest))</span>
<span id="cb91-68"><a href="#cb91-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-69"><a href="#cb91-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-70"><a href="#cb91-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb91-71"><a href="#cb91-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_study_rvest, <span class="st">"Data extraction/study_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-4" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-4">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>results_study<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/study_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>results_study_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/study_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>results_study2 <span class="ot">&lt;-</span> results_study <span class="sc">%&gt;%</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_study_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 33 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Heavy Stud… 3.60e7  2022 Aug   10.3… "Defens… Loscalzo, Yura;… "Department o…
 2 Studyholis… 3.56e7  2022 Apr   10.3… "Studyh… Loscalzo, Yura;… "Department o…
 3 Editorial:… 3.52e7  2022 &lt;NA&gt;  10.3…  &lt;NA&gt;    Loscalzo, Yura;… "Department o…
 4 Studyholis… 3.51e7  2021 &lt;NA&gt;  10.3… "Studyh… Loscalzo, Yura;… "Department o…
 5 Studyholis… 3.37e7  2020 Nov   10.5… "Loscal… Loscalzo, Yura;… "Department o…
 6 Study addi… 3.35e7  2021 Jul-… 10.1… "Backgr… Kircaburun, Kag… "Internationa…
 7 Studyholis… 3.35e7  2021 Jan   10.3… "This s… Loscalzo, Yura   "Department o…
 8 Prevalence… 3.22e7  2020 Apr   Swis… "AIMS O… Gaertner, Katha… "Department o…
 9 Heavy Stud… 3.14e7  2019 &lt;NA&gt;  10.3… "Loscal… Loscalzo, Yura;… "Department o…
10 The Dark S… 3.36e7  2019 Jun   10.5… "This s… Loscalzo, Yura;… "Department o…
# ℹ 23 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_study2)</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>results_study2 <span class="sc">%&gt;%</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>results_study2 <span class="sc">%&gt;%</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    33</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove the irrelevant studies identified manually:</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>results_study3 <span class="ot">&lt;-</span> results_study2  <span class="sc">%&gt;%</span> </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="sc">!</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Oxytocin and Rodent Models of Addiction."</span>,</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a> <span class="st">"Experimental Models on Effects of Psychostimulants."</span>,</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a> <span class="st">"Self-administration of drugs in animals and humans as a model and an investigative tool."</span>,</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a> <span class="st">"Substance abuse and white matter: Findings, limitations, and future of diffusion tensor imaging research."</span>,</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a> <span class="st">"Quantifying reinforcement value and demand for psychoactive substances in humans."</span>,</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a> <span class="st">"How can sociological theory help our understanding of addictions?"</span>,</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a> <span class="st">"Kappa-Opioid Antagonists for Psychiatric Disorders: From Bench to Clinical Trials."</span>,</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a> <span class="st">"Virus-delivered RNA interference in mouse brain to study addiction-related behaviors."</span>,</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a> <span class="st">"Prenatal ethanol exposure increases risk of psychostimulant addiction."</span>,</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a> <span class="st">"Prevalence and practice of opioid prescription at a Swiss emergency department: 2013-2017."</span>,</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a> <span class="st">"Operant sensation seeking in the mouse."</span>,</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a> <span class="st">"Place conditioning to apomorphine in rat models of Parkinson's disease: differences by dose and side-effect expression."</span>,</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a> <span class="st">"Conditioned locomotion is not correlated with behavioral sensitization to cocaine: an intra-laboratory multi-sample analysis."</span>,</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="st">"Development of a mouse model of ethanol addiction: naltrexone efficacy in reducing consumption but not craving."</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>))) </span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_study3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2005    2016    2018    2017    2021    2022 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>study_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_study3<span class="sc">$</span>Year,</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Study Addiction (PubMed)"</span>,</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>results_study3 <span class="sc">%&gt;%</span> </span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 J Behav Addict                      6
 2 Int J Environ Res Public Health     3
 3 Eur J Psychol                       2
 4 Front Psychol                       2
 5 Ann N Y Acad Sci                    1
 6 Curr Pharm Des                      1
 7 Front Psychiatry                    1
 8 J Addict Dis                        1
 9 Pharmacol Ther                      1
10 Prog Brain Res                      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_study2) # Visually inspect results</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the study search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>Label_Study <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"study"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_study2))</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>results_study_final <span class="ot">&lt;-</span> results_study2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Study) <span class="sc">%&gt;%</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_study_final)</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_study_final, <span class="st">"Data extraction/study_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="exercise-addiction" class="level2">
<h2 class="anchored" data-anchor-id="exercise-addiction">Exercise addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-5" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-5">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No MeSH terms for this, so I looked up the most recent systematic review on the topic that I could find (https://doi.org/10.1007/s11469-021-00568-1) and then examine their search strategy. They use the following terms: exercise addiction, exercise dependence, compulsory exercise, obligatory exercise.</p>
<p><strong>Actual search used:</strong> ((((“Exercise addiction”[Title/Abstract]) OR (“exercise dependence”[Title/Abstract])) OR (“compulsory exercise”[Title/Abstract])) OR (“obligatory exercise”[Title/Abstract])) OR (“Addiction to exercise”[Title/Abstract])</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%22Exercise+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22exercise+dependence%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22compulsory+exercise%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22obligatory+exercise%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22Addiction+to+exercise%22%5BTitle%2FAbstract%5D%29&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. The search term ” compulsory exercise” is slightly problematic for this search as it sometimes used in the context of exercise rehabilitation/animal studies. The following studies were found to be not relevant:</p>
<ul>
<li><p>“[Doping in sports].”</p></li>
<li><p>“Psychoeducation: a basic psychotherapeutic intervention for patients with schizophrenia and their families.”</p></li>
<li><p>“Metabolic response to fasting in experimental intrauterine growth retardation induced by surgical and nonsurgical maternal stress.”</p></li>
<li><p>“[Arguments in favor of Integrated Health Care as regular health care provision in cardiology].”</p></li>
<li><p>“[What can a chair on alternatives to animal experimentation effectuate?].”</p></li>
<li><p>“Mandatory Physical Education Classes of Two Hours per Week Can Be Comparable to Losing More than Five Kilograms for Chinese College Students.”</p></li>
<li><p>“Degeneration of dystrophic or injured skeletal muscles induces high expression of Galectin-1.”</p></li>
<li><p>“A Pilot Study of a 12-Week Leg Exercise and a 6- and 12-Month Follow-Up in Community-Dwelling Diabetic Elders: Effect on Dynamic Standing Balance.”</p></li>
<li><p>“Opposite effects of catalase and MnSOD ectopic expression on stress induced defects and mortality in the desmin deficient cardiomyopathy model.”</p></li>
<li><p>“Beef extract supplementation increases leg muscle mass and modifies skeletal muscle fiber types in rats.”</p></li>
<li><p>“Does exercise deprivation increase the tendency towards morphine dependence in rats?.”</p></li>
<li><p>“A Polymeric Bilayer Multi-Legged Soft Millirobot with Dual Actuation and Humidity Sensing.”</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-2" class="level1">
<h1>Define the search term:</h1>
<p>search_term_exercise &lt;- ‘((((“Exercise addiction”[Title/Abstract]) OR (“exercise dependence”[Title/Abstract])) OR (“compulsory exercise”[Title/Abstract])) OR (“obligatory exercise”[Title/Abstract])) OR (“Addiction to exercise”[Title/Abstract])’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-5" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_exercise &lt;- entrez_search(db=“pubmed”, term=search_term_exercise, retmax=20000) id_list_exercise &lt;- search_results_exercise$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-5" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_exercise, ceiling(seq_along(id_list_exercise)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-5" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_exercise &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_exercise &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_exercise &lt;- bind_rows(details_exercise)

return(details_df_exercise)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-5" class="level1">
<h1>Check the results:</h1>
<p>article_details_exercise %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-5" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_exercise &lt;- article_details_exercise %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-5" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_exercise, “Data extraction/exercise_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>url_exercise_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%22Exercise+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22exercise+dependence%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22compulsory+exercise%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22obligatory+exercise%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22Addiction+to+exercise%22%5BTitle%2FAbstract%5D%29&amp;size=200"</span> <span class="co"># 386 results returned on 10/07/2023</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>webpage_exercise_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_exercise_rvest)</span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>results_count_exercise <span class="ot">&lt;-</span> webpage_exercise_rvest <span class="sc">%&gt;%</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>results_per_page_exercise <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>total_pages_exercise <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_exercise[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_exercise)</span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_exercise and total_pages_exercise</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_exercise)</span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_exercise)</span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a>results_exercise_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_exercise <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_exercise_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb105-46"><a href="#cb105-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb105-47"><a href="#cb105-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb105-48"><a href="#cb105-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-49"><a href="#cb105-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb105-50"><a href="#cb105-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb105-51"><a href="#cb105-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb105-52"><a href="#cb105-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb105-53"><a href="#cb105-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-54"><a href="#cb105-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb105-55"><a href="#cb105-55" aria-hidden="true" tabindex="-1"></a>  current_results_exercise <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb105-56"><a href="#cb105-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb105-57"><a href="#cb105-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-58"><a href="#cb105-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb105-59"><a href="#cb105-59" aria-hidden="true" tabindex="-1"></a>  results_exercise_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_exercise_rvest, current_results_exercise)</span>
<span id="cb105-60"><a href="#cb105-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb105-61"><a href="#cb105-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb105-62"><a href="#cb105-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb105-63"><a href="#cb105-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb105-64"><a href="#cb105-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb105-65"><a href="#cb105-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-66"><a href="#cb105-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb105-67"><a href="#cb105-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_exercise_rvest))</span>
<span id="cb105-68"><a href="#cb105-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-69"><a href="#cb105-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-70"><a href="#cb105-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb105-71"><a href="#cb105-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_exercise_rvest, <span class="st">"Data extraction/exercise_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-5" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-5">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>results_exercise<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/exercise_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>results_exercise_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/exercise_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>results_exercise2 <span class="ot">&lt;-</span> results_exercise <span class="sc">%&gt;%</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_exercise_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 386 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 The Expand… 3.74e7  2023 May   10.1… "Exerci… Granziol, Umber… "Via Venezia …
 2 Classifyin… 3.74e7  2023 Jun   10.1… "OBJECT… Cosh, Suzanne M… "School of Ps…
 3 Effects of… 3.73e7  2023 &lt;NA&gt;  10.2… "PURPOS… Wu, Ruoshan; Ji… "School of Ph…
 4 Ready, set… 3.73e7  2023 Jul   S000… "Alexit… Sweetnam, Taylo… "Behavioural …
 5 Compulsive… 3.73e7  2023 May   S144… "OBJECT… Cosh, S M; McNe… "School of Ps…
 6 Embodying … 3.72e7  2023 Jun   S027… "Exerci… Moreau, Nicolas… "University o…
 7 Investigat… 3.72e7  2023 May   10.1… "BACKGR… Scarth, Morgan;… "Anabolic And…
 8 Understand… 3.72e7  2023 Feb   10.1… "Irrati… Miller, Anthony… "Department o…
 9 Sociocultu… 3.71e7  2023 &lt;NA&gt;  10.3… "BACKGR… Guo, Shuai; Izy… "Faculty of S…
10 The mediat… 3.71e7  2023 Apr   10.1… "BACKGR… Rahme, Deema; D… "Pharmacy Pra…
# ℹ 376 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_exercise2)</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_exercise2 <span class="sc">%&gt;%</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   386</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_exercise2 <span class="sc">%&gt;%</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 2 dupes (jUly 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   384</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate:</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>results_exercise2 <span class="sc">%&gt;%</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title) <span class="sc">%&gt;%</span> </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View()</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># These all have different PMIDs, DOIs, authors, and years</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 13
# Groups:   Title [2]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Exercise ad… 2.33e7  2013 Feb   10.1… "This a… Landolfi, Emilio "Department o…
2 Exercise ad… 2.33e7  2004 Jul   virt…  &lt;NA&gt;    Shangold, Mona … "Center for W…
3 Exercise de… 3.40e6  1988 Apr   &lt;NA&gt;   &lt;NA&gt;    Dewsnap, P A      &lt;NA&gt;         
4 Exercise de… 3.31e6  1987 Jul   &lt;NA&gt;   &lt;NA&gt;    de Coverley Vea…  &lt;NA&gt;         
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>results_exercise2 <span class="sc">%&gt;%</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>           Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print() #None</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>results_exercise2 <span class="sc">%&gt;%</span> </span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Year [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We still have lots of irrelevant studies identified in the manual search that need to be removed. Let's do that now:</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>exerise_irrelevant_studies <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="co"># List of irrelevant studies</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"[Doping in sports]."</span>,</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Psychoeducation: a basic psychotherapeutic intervention for patients with schizophrenia and their families."</span>,</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Metabolic response to fasting in experimental intrauterine growth retardation induced by surgical and nonsurgical maternal stress."</span>,</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"[Arguments in favor of Integrated Health Care as regular health care provision in cardiology]."</span>,</span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"[What can a chair on alternatives to animal experimentation effectuate?]."</span>,</span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Mandatory Physical Education Classes of Two Hours per Week Can Be Comparable to Losing More than Five Kilograms for Chinese College Students."</span>,</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Degeneration of dystrophic or injured skeletal muscles induces high expression of Galectin-1."</span>,</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"A Pilot Study of a 12-Week Leg Exercise and a 6- and 12-Month Follow-Up in Community-Dwelling Diabetic Elders: Effect on Dynamic Standing Balance."</span>,</span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Opposite effects of catalase and MnSOD ectopic expression on stress induced defects and mortality in the desmin deficient cardiomyopathy model."</span>,</span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Beef extract supplementation increases leg muscle mass and modifies skeletal muscle fiber types in rats."</span>,</span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Does exercise deprivation increase the tendency towards morphine dependence in rats?"</span>,</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"A Polymeric Bilayer Multi-Legged Soft Millirobot with Dual Actuation and Humidity Sensing."</span></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a>results_exercise3 <span class="ot">&lt;-</span> results_exercise2 <span class="sc">%&gt;%</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>Title <span class="sc">%in%</span> exerise_irrelevant_studies) <span class="co"># Filter out irrelevant studies</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we're confident we have a clean dataset, let's explore!</span></span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_exercise3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1987    2011    2017    2015    2021    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>exercise_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_exercise3<span class="sc">$</span>Year,</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">40</span>,</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Exercise Addiction (PubMed)"</span>,</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>results_exercise3 <span class="sc">%&gt;%</span> </span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 150 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 J Behav Addict                     36
 2 Int J Environ Res Public Health    15
 3 Front Psychol                      13
 4 Int J Eat Disord                   12
 5 Eat Weight Disord                  11
 6 Percept Mot Skills                 11
 7 Eat Behav                          10
 8 J Sports Med Phys Fitness           9
 9 Addict Behav Rep                    8
10 Br J Sports Med                     8
11 Eur Eat Disord Rev                  8
12 Front Psychiatry                    7
13 Front Sports Act Living             7
14 J Eat Disord                        7
15 Body Image                          5
16 J Sports Sci                        5
17 Nutrients                           5
18 Psychiatry Res                      5
19 Compr Psychiatry                    4
20 J Sport Exerc Psychol               4
# ℹ 130 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_exercise2) # Visually inspect results</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the exercise search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>Label_Exercise <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"exercise"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_exercise3))</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>results_exercise_final <span class="ot">&lt;-</span> results_exercise3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Exercise) <span class="sc">%&gt;%</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_exercise_final)</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_exercise_final, <span class="st">"Data extraction/exercise_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="shopping-addiction" class="level2">
<h2 class="anchored" data-anchor-id="shopping-addiction">Shopping addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-6" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-6">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No relevant MeShterms. Looked to literature on the subject to find relevant terms:</p>
<ul>
<li>“Buying-shopping disorder” is the term used in: https://doi.org/10.1556/2006.2020.00035</li>
<li>“Pathological buying” used here: https://pubmed.ncbi.nlm.nih.gov/25393125/</li>
</ul>
<p><strong>Actual search used:</strong> “buying-shopping disorder”[Title/Abstract] OR “shopping addiction”[Title/Abstract] OR “buying addiction”[Title/Abstract]</p>
<ul>
<li>None of these returned any results: “pathological shopping”, “addiction to shopping”, “addiction to buying”, “shopping dependence”, “buying dependence”</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%22buying-shopping+disorder%22%5BTitle%2FAbstract%5D%29+OR+%28%22shopping+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22buying+addiction%22%5BTitle%2FAbstract%5D%29&amp;sort=">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. All studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-3" class="level1">
<h1>Define the search term:</h1>
<p>search_term_shopping &lt;- ‘“buying-shopping disorder”[Title/Abstract] OR “shopping addiction”[Title/Abstract] OR “buying addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-6" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_shopping &lt;- entrez_search(db=“pubmed”, term=search_term_shopping, retmax=20000) id_list_shopping &lt;- search_results_shopping$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-6" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_shopping, ceiling(seq_along(id_list_shopping)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-6" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_shopping &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_shopping &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_shopping &lt;- bind_rows(details_shopping)

return(details_df_shopping)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-6" class="level1">
<h1>Check the results:</h1>
<p>article_details_shopping %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-6" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_shopping &lt;- article_details_shopping %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-6" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_shopping, “Data extraction/shopping_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>url_shopping_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%22buying-shopping+disorder%22%5BTitle%2FAbstract%5D%29+OR+%28%22shopping+addiction%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22buying+addiction%22%5BTitle%2FAbstract%5D%29&amp;size=200"</span> <span class="co"># 74 results returned on 19/08/2023</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage:</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>webpage_shopping_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_shopping_rvest)</span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results:</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>results_count_shopping <span class="ot">&lt;-</span> webpage_shopping_rvest <span class="sc">%&gt;%</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages:</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>results_per_page_shopping <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>total_pages_shopping <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_shopping[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_shopping)</span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_shopping and total_pages_shopping</span></span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_shopping)</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_shopping)</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a empty data frame:</span></span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>results_shopping_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data:</span></span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_shopping <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_shopping_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a>  current_results_shopping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb125-56"><a href="#cb125-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb125-57"><a href="#cb125-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-58"><a href="#cb125-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb125-59"><a href="#cb125-59" aria-hidden="true" tabindex="-1"></a>  results_shopping_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_shopping_rvest, current_results_shopping)</span>
<span id="cb125-60"><a href="#cb125-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-61"><a href="#cb125-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb125-62"><a href="#cb125-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb125-63"><a href="#cb125-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb125-64"><a href="#cb125-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-65"><a href="#cb125-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-66"><a href="#cb125-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb125-67"><a href="#cb125-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_shopping_rvest))</span>
<span id="cb125-68"><a href="#cb125-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-69"><a href="#cb125-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-70"><a href="#cb125-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb125-71"><a href="#cb125-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_shopping_rvest, <span class="st">"Data extraction/shopping_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-6" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-6">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>results_shopping<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/shopping_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>results_shopping_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/shopping_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>results_shopping2 <span class="ot">&lt;-</span> results_shopping <span class="sc">%&gt;%</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_shopping_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 74 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Exploring … 3.75e7  2023 &lt;NA&gt;  10.3… "The ma… Rocha, Susana; … "Centre for S…
 2 Update on … 3.75e7  2023 Jul   10.1… "BACKGR… Muller, Astrid;… "1Department …
 3 Online com… 3.72e7  2023 Jul   S001… "BACKGR… Wegmann, Elisa;… "Department o…
 4 Comparison… 3.70e7  2023 &lt;NA&gt;  10.1… "Diagno… Laskowski, Nora… "Medical Facu…
 5 Buying-sho… 3.69e7  2023 Feb   10.1… "In rec… Etxaburu, Nerea… "University o…
 6 Student St… 3.66e7  2022 Dec   10.3… "Online… Li, Huimin; Ma,… "School of Hu…
 7 Obsessive-… 3.66e7  2023 Apr   S030… "BACKGR… Mestre-Bach, Ge… "Universidad …
 8 Family Sub… 3.65e7  2023 Feb   10.1… "Online… Fan, Liheng; Li… "Institute of…
 9 Therapeuti… 3.64e7  2022 &lt;NA&gt;  10.3… "The pr… Vasiliu, Octavi… "Department o…
10 Estimation… 3.61e7  2022 &lt;NA&gt;  10.1… "PURPOS… Alimoradi, Zain… "Social Deter…
# ℹ 64 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_shopping2)</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_shopping2 <span class="sc">%&gt;%</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    74</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_shopping2 <span class="sc">%&gt;%</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 1 dupes (jUly 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    73</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate:</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>results_shopping2 <span class="sc">%&gt;%</span> </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title) <span class="sc">%&gt;%</span> </span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View()</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># In July 2023  this returns two studies with the same title (Technological Addictions). Despite having the same title, authors, and been published at the same time of year in 2022, these are actually separate papers... (Determined by manually searching the articles) [Note that this appears more than one addiction search]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
# Groups:   Title [1]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Technologic… 3.61e7  2022 Sep   S019… "Modern… Sherer, James; … "New York Uni…
2 Technologic… 3.58e7  2022 Sep   10.1… "PURPOS… Sherer, James; … "New York Uni…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>results_shopping2 <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>           Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print() # None</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>results_shopping2 <span class="sc">%&gt;%</span> </span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Year [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we're confident we have a clean dataset, let's explore!</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_shopping2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2008    2018    2021    2019    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>shopping_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_shopping2<span class="sc">$</span>Year,</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Shopping Addiction (PubMed)"</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>results_shopping2 <span class="sc">%&gt;%</span> </span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 35 × 2
   Journal_name_short                   n
   &lt;chr&gt;                            &lt;int&gt;
 1 J Behav Addict                      13
 2 Addict Behav                         5
 3 Int J Environ Res Public Health      5
 4 Compr Psychiatry                     4
 5 Psychiatry Res                       4
 6 Front Psychiatry                     3
 7 Front Psychol                        3
 8 PLoS One                             3
 9 Addict Behav Rep                     2
10 Addict Biol                          2
11 CNS Spectr                           2
12 Curr Opin Psychol                    2
13 Eur Addict Res                       2
14 Int J Ment Health Addict             2
15 Psychother Psychosom Med Psychol     2
16 Addiction                            1
17 Adicciones                           1
18 Appl Neuropsychol Adult              1
19 Asian J Psychiatr                    1
20 BMC Psychol                          1
# ℹ 15 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_shopping2) # Visually inspect results</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the shopping search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>Label_Shopping <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"shopping"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_shopping2))</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>results_shopping_final <span class="ot">&lt;-</span> results_shopping2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Shopping) <span class="sc">%&gt;%</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_shopping_final)</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_shopping_final, <span class="st">"Data extraction/shopping_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="social-media-addiction" class="level2">
<h2 class="anchored" data-anchor-id="social-media-addiction">Social media addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-7" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-7">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> Comes under “Internet addiction disorder” when searching for MeSH terms. Nothing of relevance beyond the term “social media addictions”. Looked to literature on the subject to find relevant terms:</p>
<ul>
<li><p>“disordered online social networking use” used here: https://pubmed.ncbi.nlm.nih.gov/25170590/</p></li>
<li><p>“social-network-use disorder” is the term used in: https://doi.org/10.1556/2006.2020.00035</p></li>
</ul>
<p><strong>Actual search used:</strong> ((((“social_media addiction”[Title/Abstract]) OR (“social_media dependence”[Title/Abstract])) OR (“compulsory social_media”[Title/Abstract])) OR (“obligatory social_media”[Title/Abstract])) OR (“Addiction to social_media”[Title/Abstract])</p>
<ul>
<li>Not found so removed from search terms: “SnapChat addiction” AND “Twitter addiction”</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%22social_media+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22social_media+dependence%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22compulsory+social_media%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22obligatory+social_media%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22Addiction+to+social_media%22%5BTitle%2FAbstract%5D%29&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. There were a few results where the key search terms weren’t in the title or abstract, but they were in the keywords for the studies, which seems perfectly acceptable considering the types of studies we’re trying to detect with this process. All studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-4" class="level1">
<h1>Define the search term:</h1>
<p>search_term_social_media &lt;- ‘((((“social_media addiction”[Title/Abstract]) OR (“social_media dependence”[Title/Abstract])) OR (“compulsory social_media”[Title/Abstract])) OR (“obligatory social_media”[Title/Abstract])) OR (“Addiction to social_media”[Title/Abstract])’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-7" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_social_media &lt;- entrez_search(db=“pubmed”, term=search_term_social_media, retmax=20000) id_list_social_media &lt;- search_results_social_media$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-7" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_social_media, ceiling(seq_along(id_list_social_media)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-7" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_social_media &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_social_media &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_social_media &lt;- bind_rows(details_social_media)

return(details_df_social_media)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-7" class="level1">
<h1>Check the results:</h1>
<p>article_details_social_media %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-7" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_social_media &lt;- article_details_social_media %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-7" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_social_media, “Data extraction/social_media_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>url_social_media_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%28%22social_media+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22social_media+dependence%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22compulsory+social_media%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22obligatory+social_media%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22Addiction+to+social_media%22%5BTitle%2FAbstract%5D%29&amp;size=200"</span> <span class="co"># 303 results returned on 20/07/2023</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>webpage_social_media_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_social_media_rvest)</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>results_count_social_media <span class="ot">&lt;-</span> webpage_social_media_rvest <span class="sc">%&gt;%</span></span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>results_per_page_social_media <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>total_pages_social_media <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_social_media[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_social_media)</span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_social_media and total_pages_social_media</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_social_media)</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_social_media)</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>results_social_media_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_social_media <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_social_media_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb145-41"><a href="#cb145-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb145-42"><a href="#cb145-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-43"><a href="#cb145-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb145-44"><a href="#cb145-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb145-45"><a href="#cb145-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb145-46"><a href="#cb145-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb145-47"><a href="#cb145-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb145-48"><a href="#cb145-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-49"><a href="#cb145-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb145-50"><a href="#cb145-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb145-51"><a href="#cb145-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb145-52"><a href="#cb145-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb145-53"><a href="#cb145-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-54"><a href="#cb145-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb145-55"><a href="#cb145-55" aria-hidden="true" tabindex="-1"></a>  current_results_social_media <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb145-56"><a href="#cb145-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb145-57"><a href="#cb145-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-58"><a href="#cb145-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb145-59"><a href="#cb145-59" aria-hidden="true" tabindex="-1"></a>  results_social_media_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_social_media_rvest, current_results_social_media)</span>
<span id="cb145-60"><a href="#cb145-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-61"><a href="#cb145-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb145-62"><a href="#cb145-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb145-63"><a href="#cb145-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb145-64"><a href="#cb145-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb145-65"><a href="#cb145-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-66"><a href="#cb145-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb145-67"><a href="#cb145-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_social_media_rvest))</span>
<span id="cb145-68"><a href="#cb145-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-69"><a href="#cb145-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-70"><a href="#cb145-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb145-71"><a href="#cb145-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_social_media_rvest, <span class="st">"Data extraction/social_media_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-7" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-7">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>results_social_media<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/social_media_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>results_social_media_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/social_media_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>results_social_media2 <span class="ot">&lt;-</span> results_social_media <span class="sc">%&gt;%</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_social_media_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 303 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Conceptual… 3.74e7  2023 Jul   10.1… "BACKGR… Tullett-Prado, … "Institute fo…
 2 Exploring … 3.74e7  2023 Jul   S000… "Previo… Yue, Heng; Yue,… "School of Ps…
 3 Self-estee… 3.74e7  2023 May   10.4… "BACKGR… Colak, Mehmet; … "Department o…
 4 Relationsh… 3.74e7  2023 Jun   10.3… "The pr… Sommantico, Mas… "Dynamic Psyc…
 5 The Big Fi… 3.74e7  2023 May   10.3… "Relati… Wartberg, Lutz;… "Department o…
 6 Problemati… 3.74e7  2023 Jun   10.1… "As res… Ghazi, Farah Ra… "Department o…
 7 Social med… 3.74e7  2023 Oct   S016… "BACKGR… Muskens, Lotte;… "Department o…
 8 Mediating … 3.74e7  2023 Jun   10.1… "OBJECT… Malik, Lipika; … "Mumbai, Indi…
 9 Problemati… 3.74e7  2023 Oct   S030… "While … Tsilosani, Akak… "Hartwick Col…
10 Associatio… 3.73e7  2023 Jun   10.1… "BACKGR… Raney, Julia H;… "Department o…
# ℹ 293 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_social_media2)</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_social_media2 <span class="sc">%&gt;%</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   303</code></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_social_media2 <span class="sc">%&gt;%</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 1 dupes (jUly 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   302</code></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate:</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>results_social_media2 <span class="sc">%&gt;%</span> </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title) <span class="sc">%&gt;%</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View()</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># In July 2023  this returns two studies with the same title (Technological Addictions). Despite having the same title, authors, and been published at the same time of year in 2022, these are actually separate papers... (Determined by manually searching the articles)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
# Groups:   Title [1]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Technologic… 3.61e7  2022 Sep   S019… "Modern… Sherer, James; … "New York Uni…
2 Technologic… 3.58e7  2022 Sep   10.1… "PURPOS… Sherer, James; … "New York Uni…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>results_social_media2 <span class="sc">%&gt;%</span> </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>           Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print() # None</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>results_social_media2 <span class="sc">%&gt;%</span> </span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 13
# Groups:   Title, Journal_name_short, Year [0]
# ℹ 13 variables: Title &lt;chr&gt;, PMID &lt;int&gt;, Year &lt;int&gt;, Month &lt;chr&gt;, DOI &lt;chr&gt;,
#   Abstract &lt;chr&gt;, Full_Author_Name &lt;chr&gt;, Author_Address &lt;chr&gt;,
#   Language &lt;chr&gt;, Publication_Type &lt;chr&gt;, Journal_name_short &lt;chr&gt;,
#   Conflict_of_Interest_Statement &lt;chr&gt;, Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we're confident we have a clean dataset, let's explore!</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_social_media2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2015    2021    2022    2021    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>social_media_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_social_media2<span class="sc">$</span>Year,</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Social Media Addiction (PubMed)"</span>,</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>results_social_media2 <span class="sc">%&gt;%</span> </span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 123 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 Int J Environ Res Public Health    29
 2 Addict Behav                       19
 3 J Behav Addict                     15
 4 Front Psychiatry                   14
 5 Front Psychol                      14
 6 Front Public Health                12
 7 Healthcare (Basel)                  8
 8 PLoS One                            7
 9 Cyberpsychol Behav Soc Netw         6
10 Acta Psychol (Amst)                 5
11 Addict Behav Rep                    5
12 Alpha Psychiatry                    5
13 BMC Psychol                         5
14 Curr Psychol                        5
15 Int J Ment Health Addict            5
16 Perspect Psychiatr Care             5
17 J Affect Disord                     4
18 Psychiatr Q                         4
19 Psychol Rep                         4
20 Psychol Res Behav Manag             4
# ℹ 103 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_social_media2) # Visually inspect results</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the social_media search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>Label_Social_media <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"social_media"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_social_media2))</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>results_social_media_final <span class="ot">&lt;-</span> results_social_media2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Social_media) <span class="sc">%&gt;%</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_social_media_final)</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_social_media_final, <span class="st">"Data extraction/social_media_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="internet-addiction" class="level2">
<h2 class="anchored" data-anchor-id="internet-addiction">Internet addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-8" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-8">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> MeSH terms: https://www.ncbi.nlm.nih.gov/mesh/?term=internet+addiction</p>
<p><strong>Actual search used:</strong> (((“internet addiction”[Title/Abstract]) OR (“addictive internet use”[Title/Abstract])) OR (“internet use disorder”[Title/Abstract])) OR (“addiction to the internet”[Title/Abstract])</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%28%28%28%22internet+addiction%22%5BTitle%2FAbstract%5D%29+OR+%28%22addictive+internet+use%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22internet+use+disorder%22%5BTitle%2FAbstract%5D%29%29+OR+%28%22addiction+to+the+internet%22%5BTitle%2FAbstract%5D%29&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. This took quite some time given the number of studies available. As far as I can see, all studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-5" class="level1">
<h1>Define the search term:</h1>
<p>search_term_internet &lt;- ‘(((“internet addiction”[Title/Abstract]) OR (“addictive internet use”[Title/Abstract])) OR (“internet use disorder”[Title/Abstract])) OR (“addiction to the internet”[Title/Abstract])’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-8" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_internet &lt;- entrez_search(db=“pubmed”, term=search_term_internet, retmax=20000) id_list_internet &lt;- search_results_internet$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-8" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_internet, ceiling(seq_along(id_list_internet)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-8" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_internet &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_internet &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_internet &lt;- bind_rows(details_internet)

return(details_df_internet)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-8" class="level1">
<h1>Check the results:</h1>
<p>article_details_internet %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-8" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_internet &lt;- article_details_internet %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-8" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_internet, “Data extraction/internet_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>url_internet_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=(((%22internet%20addiction%22%5BTitle%2FAbstract%5D)%20OR%20(%22addictive%20internet%20use%22%5BTitle%2FAbstract%5D))%20OR%20(%22internet%20use%20disorder%22%5BTitle%2FAbstract%5D))%20OR%20(%22addiction%20to%20the%20internet%22%5BTitle%2FAbstract%5D)&amp;size=200"</span> <span class="co"># 2335 results returned on 20/07/2023</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>webpage_internet_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_internet_rvest)</span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>results_count_internet <span class="ot">&lt;-</span> webpage_internet_rvest <span class="sc">%&gt;%</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>results_per_page_internet <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>total_pages_internet <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_internet[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_internet)</span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_internet and total_pages_internet</span></span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_internet)</span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_internet)</span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>results_internet_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_internet <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb165-34"><a href="#cb165-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_internet_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb165-35"><a href="#cb165-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-36"><a href="#cb165-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb165-37"><a href="#cb165-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb165-38"><a href="#cb165-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-39"><a href="#cb165-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb165-40"><a href="#cb165-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb165-41"><a href="#cb165-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb165-42"><a href="#cb165-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-43"><a href="#cb165-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb165-44"><a href="#cb165-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb165-45"><a href="#cb165-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb165-46"><a href="#cb165-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb165-47"><a href="#cb165-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb165-48"><a href="#cb165-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-49"><a href="#cb165-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb165-50"><a href="#cb165-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb165-51"><a href="#cb165-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb165-52"><a href="#cb165-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb165-53"><a href="#cb165-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-54"><a href="#cb165-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb165-55"><a href="#cb165-55" aria-hidden="true" tabindex="-1"></a>  current_results_internet <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb165-56"><a href="#cb165-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb165-57"><a href="#cb165-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-58"><a href="#cb165-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb165-59"><a href="#cb165-59" aria-hidden="true" tabindex="-1"></a>  results_internet_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_internet_rvest, current_results_internet)</span>
<span id="cb165-60"><a href="#cb165-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb165-61"><a href="#cb165-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb165-62"><a href="#cb165-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb165-63"><a href="#cb165-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb165-64"><a href="#cb165-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb165-65"><a href="#cb165-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-66"><a href="#cb165-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb165-67"><a href="#cb165-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_internet_rvest))</span>
<span id="cb165-68"><a href="#cb165-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-69"><a href="#cb165-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-70"><a href="#cb165-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb165-71"><a href="#cb165-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_internet_rvest, <span class="st">"Data extraction/internet_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-8" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-8">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a>results_internet<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/internet_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a>results_internet_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/internet_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>results_internet2 <span class="ot">&lt;-</span> results_internet <span class="sc">%&gt;%</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_internet_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,335 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 An interve… 3.75e7  2023 Jul   10.1… "Unheal… Fantini, Luana;… "Department o…
 2 At-risk in… 3.75e7  2023 Jul   10.1… "BACKGR… Fukuda, Mari; C… "Okayama Univ…
 3 Eye moveme… 3.75e7  2023 Jul   10.1… "BACKGR… Ge, Ying; Huo, … "Key Laborato…
 4 Parental n… 3.75e7  2023 Jul   S014… "BACKGR… Li, Fang; Wang,… "School of Ps…
 5 Potential … 3.74e7  2023 Jul   S030… "This s… Akbari, Mehdi; … "Department o…
 6 Latent pro… 3.74e7  2023 Jul   10.1… "Health… Yu, Ling; Wu, Y… "Phase I Clin…
 7 Network an… 3.74e7  2023 Jul   S016… "BACKGR… Yang, Yuan; Zha… "Guangdong Me…
 8 A systemat… 3.74e7  2023 Jul   S016… "BACKGR… Jin, Meng-Ke; W… "School of Ps…
 9 Cue-reacti… 3.74e7  2023 Jul   S001… "BACKGR… Diers, Martin; … "Department o…
10 Associatio… 3.74e7  2023 &lt;NA&gt;  10.3… "Object… Shi, Yijian; Ta… "Department o…
# ℹ 2,325 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_internet2)</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_internet2 <span class="sc">%&gt;%</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  2335</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_internet2 <span class="sc">%&gt;%</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 4 dupes (jUly 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1  2331</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Show duplicate:</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>results_internet2 <span class="sc">%&gt;%</span> </span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title) <span class="sc">%&gt;%</span> </span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># View()</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># In July 2023 this returns 3 studies, 2 which have 2 duplicate titles and one three times. These three identical papers are all called "Internet addiction", and are all separate, distinct papers. One of the two pairs duplicates contains a published erratum so let's remove that (PMID: 32320594). The other pair of duplicates (title: Personality Disorders in Female and Male College Students With Internet Addiction.) are an original study and comment so we will keep those.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 13
# Groups:   Title [3]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 The Current… 3.23e7  2020 Apr   10.3…  &lt;NA&gt;    Wang, Yanqiu; Z… "Department o…
2 The Current… 3.22e7  2020 Mar   10.3… "OBJECT… Wang, Yanqiu; Z… "Department o…
3 Personality… 2.88e7  2017 Sep   10.1…  &lt;NA&gt;    Ko, Huei-Chen; … "*Department …
4 Personality… 2.67e7  2016 Mar   10.1… "A high… Wu, Jo Yung-Wei… "*Institute o…
5 [Internet a… 2.64e7  2015 Sep   &lt;NA&gt;  "Intern… Nakayama, Hidek…  &lt;NA&gt;         
6 [Internet a… 2.26e7  2012 &lt;NA&gt;  &lt;NA&gt;  "Intern… Korkeila, Jyrki  "Turun yliopi…
7 [Internet a… 1.78e7  2007 Jul   &lt;NA&gt;  "The In… Dannon, Pinhas … "Rehovot Ment…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates where the title, year, and authors are all the same:</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>results_internet2 <span class="sc">%&gt;%</span> </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>           Full_Author_Name) <span class="sc">%&gt;%</span> </span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
# Groups:   Title, Journal_name_short, Full_Author_Name [1]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 The Current… 3.23e7  2020 Apr   10.3…  &lt;NA&gt;    Wang, Yanqiu; Z… "Department o…
2 The Current… 3.22e7  2020 Mar   10.3… "OBJECT… Wang, Yanqiu; Z… "Department o…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>  <span class="co"># print() # 1 - the one we're already planning to remove</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Have a look at duplicates were just the title, journal and year are the same:</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>results_internet2 <span class="sc">%&gt;%</span> </span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Title, </span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>           Journal_name_short, </span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>           Year) <span class="sc">%&gt;%</span> </span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>()<span class="sc">&gt;</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co">#  1 - the one we're already planning to remove</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
# Groups:   Title, Journal_name_short, Year [1]
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 The Current… 3.23e7  2020 Apr   10.3…  &lt;NA&gt;    Wang, Yanqiu; Z… "Department o…
2 The Current… 3.22e7  2020 Mar   10.3… "OBJECT… Wang, Yanqiu; Z… "Department o…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicate:</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>results_internet3 <span class="ot">&lt;-</span> results_internet2 <span class="sc">%&gt;%</span> </span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PMID <span class="sc">!=</span> <span class="dv">32320594</span>)</span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  Okay, now we're confident we have a clean dataset, let's explore!</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the Year  variable:</span></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_internet3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1996    2015    2018    2018    2021    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>internet_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_internet3<span class="sc">$</span>Year,</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Internet Addiction (PubMed)"</span>,</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>results_internet3 <span class="sc">%&gt;%</span> </span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 561 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 Int J Environ Res Public Health   146
 2 J Behav Addict                    110
 3 Front Psychiatry                   94
 4 Cyberpsychol Behav Soc Netw        88
 5 Front Psychol                      85
 6 Addict Behav                       76
 7 Psychiatry Res                     67
 8 PLoS One                           53
 9 Cyberpsychol Behav                 50
10 J Affect Disord                    31
11 BMC Psychiatry                     28
12 Psychiatry Investig                28
13 Compr Psychiatry                   27
14 Psychiatry Clin Neurosci           24
15 Front Public Health                23
16 Addict Behav Rep                   16
17 Asian J Psychiatr                  16
18 J Psychiatr Res                    15
19 Psychol Rep                        15
20 BMC Public Health                  14
# ℹ 541 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_internet2) # Visually inspect results</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the internet search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>Label_Internet <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"internet"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_internet3))</span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>results_internet_final <span class="ot">&lt;-</span> results_internet3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Internet) <span class="sc">%&gt;%</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_internet_final)</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_internet_final, <span class="st">"Data extraction/internet_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="smart-phone-addiction" class="level2">
<h2 class="anchored" data-anchor-id="smart-phone-addiction">Smart phone addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-9" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-9">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> MeSH terms: There are very few specific terms for smartphone addiction, and instead the general term “Internet addiction” is returned when searching it in the MeSH database (see: <a href="https://www.ncbi.nlm.nih.gov/mesh/?term=Smartphone+addiction">here</a>). Looking at the literature, it seems like ” smartphone addiction” is the most commonly used term, but sometimes “mobile phone” is used instead of smartphone.</p>
<p><strong>Actual search used:</strong> “Smartphone addiction”[Title/Abstract] OR “Smartphone disorder”[Title/Abstract] OR “Smartphone dependence”[Title/Abstract] OR “Mobile phone addiction”[Title/Abstract] OR “Mobile phone dependence”[Title/Abstract]</p>
<ul>
<li>Not found so removed from search terms: “Mobile phone disorder”</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Smartphone+addiction%22%5BTitle%2FAbstract%5D+OR+%22Smartphone+disorder%22%5BTitle%2FAbstract%5D+OR+%22Smartphone+dependence%22%5BTitle%2FAbstract%5D+OR+%22Mobile+phone+addiction%22%5BTitle%2FAbstract%5D+OR+%22Mobile+phone+dependence%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. As far as I can see, all studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-6" class="level1">
<h1>Define the search term:</h1>
<p>search_term_smart_phone &lt;- ‘“Smartphone addiction”[Title/Abstract] OR “Smartphone disorder”[Title/Abstract] OR “Smartphone dependence”[Title/Abstract] OR “Mobile phone addiction”[Title/Abstract] OR “Mobile phone dependence”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-9" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_smart_phone &lt;- entrez_search(db=“pubmed”, term=search_term_smart_phone, retmax=20000) id_list_smart_phone &lt;- search_results_smart_phone$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-9" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_smart_phone, ceiling(seq_along(id_list_smart_phone)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-9" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_smart_phone &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_smart_phone &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_smart_phone &lt;- bind_rows(details_smart_phone)

return(details_df_smart_phone)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-9" class="level1">
<h1>Check the results:</h1>
<p>article_details_smart_phone %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-9" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_smart_phone &lt;- article_details_smart_phone %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-9" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_smart_phone, “Data extraction/smart_phone_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>url_smart_phone_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Smartphone+addiction%22%5BTitle%2FAbstract%5D+OR+%22Smartphone+disorder%22%5BTitle%2FAbstract%5D+OR+%22Smartphone+dependence%22%5BTitle%2FAbstract%5D+OR+%22Mobile+phone+addiction%22%5BTitle%2FAbstract%5D+OR+%22Mobile+phone+dependence%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 882 results returned on 19/08/2023</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>webpage_smart_phone_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_smart_phone_rvest)</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>results_count_smart_phone <span class="ot">&lt;-</span> webpage_smart_phone_rvest <span class="sc">%&gt;%</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>results_per_page_smart_phone <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>total_pages_smart_phone <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_smart_phone[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_smart_phone)</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_smart_phone and total_pages_smart_phone</span></span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_smart_phone)</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_smart_phone)</span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a>results_smart_phone_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_smart_phone <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_smart_phone_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-49"><a href="#cb185-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb185-50"><a href="#cb185-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb185-51"><a href="#cb185-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb185-52"><a href="#cb185-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb185-53"><a href="#cb185-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-54"><a href="#cb185-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb185-55"><a href="#cb185-55" aria-hidden="true" tabindex="-1"></a>  current_results_smart_phone <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb185-56"><a href="#cb185-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb185-57"><a href="#cb185-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-58"><a href="#cb185-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb185-59"><a href="#cb185-59" aria-hidden="true" tabindex="-1"></a>  results_smart_phone_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_smart_phone_rvest, current_results_smart_phone)</span>
<span id="cb185-60"><a href="#cb185-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb185-61"><a href="#cb185-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb185-62"><a href="#cb185-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb185-63"><a href="#cb185-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb185-64"><a href="#cb185-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb185-65"><a href="#cb185-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-66"><a href="#cb185-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb185-67"><a href="#cb185-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_smart_phone_rvest))</span>
<span id="cb185-68"><a href="#cb185-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-69"><a href="#cb185-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-70"><a href="#cb185-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb185-71"><a href="#cb185-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_smart_phone_rvest, <span class="st">"Data extraction/smart_phone_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-9" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-9">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>results_smart_phone<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/smart_phone_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>results_smart_phone_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/smart_phone_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>results_smart_phone2 <span class="ot">&lt;-</span> results_smart_phone <span class="sc">%&gt;%</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_smart_phone_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 884 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 "Is There … 3.76e7  2023 Aug   1501… "Purpos… AlSaif, Haytham… "Department o…
 2 "The Relat… 3.76e7  2023 Aug   647 … "Smartp… Gong, Yanbin; Y… "College of H…
 3 "Impact of… 3.76e7  2023 &lt;NA&gt;  10.2… "PURPOS… Wu, Rong; Luo, … "Department o…
 4 "An Integr… 3.76e7  2023 Jan-… 10.4… "BACKGR… Tadpatrikar, As… "Service for …
 5 "The effec… 3.76e7  2023 Aug   10.1… "AIM: T… Erden, Ibrahim … "Enka Adapaza…
 6 "The role … 3.76e7  2023 &lt;NA&gt;  10.3… "BACKGR… Zhang, Li; Wang… "School of Pu…
 7 "Toward th… 3.76e7  2023 Jul   10.3… "Orthos… Shinno, Kazuma;… "Department o…
 8 "Factors a… 3.75e7  2023 Aug   S016… "BACKGR… Kim, Jinyung; L… "University o…
 9 "Can restr… 3.75e7  2023 Jul   S030… "BACKGR… Tu, Zhihao; He,… "Navy Special…
10 "Intoleran… 3.75e7  2023 Jul   10.1… "OBJECT… Zhang, Sensen; … "Institute of…
# ℹ 874 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_smart_phone2)</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_smart_phone2 <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   884</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_smart_phone2 <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   884</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_smart_phone2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2008    2019    2021    2020    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>smart_phone_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_smart_phone2<span class="sc">$</span>Year,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">30</span>,</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Smartphone Addiction (PubMed)"</span>,</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a>results_smart_phone2 <span class="sc">%&gt;%</span> </span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 258 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 Int J Environ Res Public Health    94
 2 Front Psychol                      77
 3 Front Psychiatry                   41
 4 J Behav Addict                     38
 5 PLoS One                           38
 6 Addict Behav                       25
 7 Front Public Health                24
 8 BMC Psychiatry                     22
 9 Perspect Psychiatr Care            17
10 Psychol Res Behav Manag            17
11 Cyberpsychol Behav Soc Netw        15
12 J Affect Disord                    14
13 Healthcare (Basel)                 13
14 Heliyon                            11
15 Psychiatry Investig                11
16 Psychiatry Res                     10
17 Int J Ment Health Addict            8
18 J Family Med Prim Care              8
19 J Educ Health Promot                6
20 J Korean Med Sci                    6
# ℹ 238 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_smart_phone2) # Visually inspect results</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the smart_phone search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a>Label_Smartphone <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"smart_phone"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_smart_phone2))</span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>results_smart_phone_final <span class="ot">&lt;-</span> results_smart_phone2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Smartphone) <span class="sc">%&gt;%</span></span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_smart_phone_final)</span></span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_smart_phone_final, <span class="st">"Data extraction/smart_phone_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="cybersex-addiction" class="level2">
<h2 class="anchored" data-anchor-id="cybersex-addiction">Cybersex addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-10" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-10">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> There are no MeSH terms for this. Searching around the literature it seems like the most commonly Used term is “cybersex addiction”. “compulsive cybersex” It is also commonly used and seems to be consistently used to indicate an addiction (see https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7044618/). “addictive cybersex” is also sometimes included in study abstracts.</p>
<p><strong>Actual search used:</strong> “Cybersex addiction”[Title/Abstract] OR “Compulsive Cybersex”[Title/Abstract] OR “Addictive cybersex”[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Cybersex+addiction%22%5BTitle%2FAbstract%5D+OR+%22Compulsive+Cybersex%22%5BTitle%2FAbstract%5D+OR+%22Addictive+cybersex%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed (there aren’t too many this time). As far as I can see, all studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-7" class="level1">
<h1>Define the search term:</h1>
<p>search_term_cybersex &lt;- ‘“Cybersex addiction”[Title/Abstract] OR “Compulsive Cybersex”[Title/Abstract] OR “Addictive cybersex”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-10" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_cybersex &lt;- entrez_search(db=“pubmed”, term=search_term_cybersex, retmax=20000) id_list_cybersex &lt;- search_results_cybersex$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-10" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_cybersex, ceiling(seq_along(id_list_cybersex)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-10" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_cybersex &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_cybersex &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_cybersex &lt;- bind_rows(details_cybersex)

return(details_df_cybersex)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-10" class="level1">
<h1>Check the results:</h1>
<p>article_details_cybersex %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-10" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_cybersex &lt;- article_details_cybersex %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-10" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_cybersex, “Data extraction/cybersex_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb199-3"><a href="#cb199-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-4"><a href="#cb199-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb199-5"><a href="#cb199-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-6"><a href="#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb199-7"><a href="#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb199-8"><a href="#cb199-8" aria-hidden="true" tabindex="-1"></a>url_cybersex_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Cybersex+addiction%22%5BTitle%2FAbstract%5D+OR+%22Compulsive+Cybersex%22%5BTitle%2FAbstract%5D+OR+%22Addictive+cybersex%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 28 results returned on 19/08/2023</span></span>
<span id="cb199-9"><a href="#cb199-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-10"><a href="#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb199-11"><a href="#cb199-11" aria-hidden="true" tabindex="-1"></a>webpage_cybersex_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_cybersex_rvest)</span>
<span id="cb199-12"><a href="#cb199-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-13"><a href="#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb199-14"><a href="#cb199-14" aria-hidden="true" tabindex="-1"></a>results_count_cybersex <span class="ot">&lt;-</span> webpage_cybersex_rvest <span class="sc">%&gt;%</span></span>
<span id="cb199-15"><a href="#cb199-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-16"><a href="#cb199-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb199-17"><a href="#cb199-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-18"><a href="#cb199-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb199-19"><a href="#cb199-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-20"><a href="#cb199-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb199-21"><a href="#cb199-21" aria-hidden="true" tabindex="-1"></a>results_per_page_cybersex <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb199-22"><a href="#cb199-22" aria-hidden="true" tabindex="-1"></a>total_pages_cybersex <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_cybersex[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_cybersex)</span>
<span id="cb199-23"><a href="#cb199-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_cybersex and total_pages_cybersex</span></span>
<span id="cb199-24"><a href="#cb199-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_cybersex)</span>
<span id="cb199-25"><a href="#cb199-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_cybersex)</span>
<span id="cb199-26"><a href="#cb199-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-27"><a href="#cb199-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-28"><a href="#cb199-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb199-29"><a href="#cb199-29" aria-hidden="true" tabindex="-1"></a>results_cybersex_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb199-30"><a href="#cb199-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-31"><a href="#cb199-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb199-32"><a href="#cb199-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_cybersex <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb199-33"><a href="#cb199-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb199-34"><a href="#cb199-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_cybersex_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb199-35"><a href="#cb199-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-36"><a href="#cb199-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb199-37"><a href="#cb199-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb199-38"><a href="#cb199-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-39"><a href="#cb199-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb199-40"><a href="#cb199-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb199-41"><a href="#cb199-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb199-42"><a href="#cb199-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-43"><a href="#cb199-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb199-44"><a href="#cb199-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb199-45"><a href="#cb199-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb199-46"><a href="#cb199-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb199-47"><a href="#cb199-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb199-48"><a href="#cb199-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-49"><a href="#cb199-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb199-50"><a href="#cb199-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb199-51"><a href="#cb199-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb199-52"><a href="#cb199-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb199-53"><a href="#cb199-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-54"><a href="#cb199-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb199-55"><a href="#cb199-55" aria-hidden="true" tabindex="-1"></a>  current_results_cybersex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb199-56"><a href="#cb199-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb199-57"><a href="#cb199-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-58"><a href="#cb199-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb199-59"><a href="#cb199-59" aria-hidden="true" tabindex="-1"></a>  results_cybersex_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_cybersex_rvest, current_results_cybersex)</span>
<span id="cb199-60"><a href="#cb199-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb199-61"><a href="#cb199-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb199-62"><a href="#cb199-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb199-63"><a href="#cb199-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb199-64"><a href="#cb199-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb199-65"><a href="#cb199-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-66"><a href="#cb199-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb199-67"><a href="#cb199-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_cybersex_rvest))</span>
<span id="cb199-68"><a href="#cb199-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-69"><a href="#cb199-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb199-70"><a href="#cb199-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb199-71"><a href="#cb199-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_cybersex_rvest, <span class="st">"Data extraction/cybersex_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-10" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-10">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>results_cybersex<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/cybersex_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a>results_cybersex_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/cybersex_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a>results_cybersex2 <span class="ot">&lt;-</span> results_cybersex <span class="sc">%&gt;%</span></span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_cybersex_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 28 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 How the Ri… 3.73e7  2023 Jun   10.7… "On Jan… Irizarry, Ricar… "Psychiatry, …
 2 [Behaviora… 3.67e7  2023 &lt;NA&gt;  10.1… "The re… Egorov, A Y      "Sechenov Ins…
 3 Global pre… 3.52e7  2022 Mar   S027… "The pr… Meng, Shi-Qiu; … "National Ins…
 4 Electrophy… 3.48e7  2021 Nov   10.1… "BACKGR… Wang, Jianfeng;…  &lt;NA&gt;         
 5 Self-Perce… 3.48e7  2022 Feb   10.1… "Online… Mennig, Manuel;… "Department o…
 6 The Impact… 3.43e7  2021 &lt;NA&gt;  10.3… "Backgr… Markert, Charlo… "Department o…
 7 Cybersex a… 3.34e7  2021 Jul-… 10.1… "BACKGR… Skryabin, Valen… "Moscow Resea…
 8 Event-rela… 3.29e7  2020 Oct   10.1… "BACKGR… Wang, Jianfeng;…  &lt;NA&gt;         
 9 Contributi… 3.15e7  2019 Sep   10.1… "BACKGR… Brahim, Farah B… "Department o…
10 Sexual Des… 3.07e7  2019 Jan   10.2… "BACKGR… Varfi, Nektaria… "Geneva Unive…
# ℹ 18 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_cybersex2)</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb202-5"><a href="#cb202-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_cybersex2 <span class="sc">%&gt;%</span></span>
<span id="cb202-6"><a href="#cb202-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb202-7"><a href="#cb202-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb202-8"><a href="#cb202-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_cybersex2 <span class="sc">%&gt;%</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb204-5"><a href="#cb204-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    28</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_cybersex2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2007    2015    2018    2017    2020    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>cybersex_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_cybersex2<span class="sc">$</span>Year,</span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Cybersex Addiction (PubMed)"</span>,</span>
<span id="cb208-6"><a href="#cb208-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>results_cybersex2 <span class="sc">%&gt;%</span> </span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 15 × 2
   Journal_name_short                       n
   &lt;chr&gt;                                &lt;int&gt;
 1 J Behav Addict                           6
 2 Addict Behav                             3
 3 Cyberpsychol Behav Soc Netw              3
 4 J Sex Marital Ther                       3
 5 Front Psychol                            2
 6 Psychol Addict Behav                     2
 7 Arch Sex Behav                           1
 8 Clin Psychol Rev                         1
 9 Cureus                                   1
10 Front Psychiatry                         1
11 J Addict Dis                             1
12 JMIR Ment Health                         1
13 Psychiatr Clin North Am                  1
14 Taehan Kanho Hakhoe Chi                  1
15 Zh Nevrol Psikhiatr Im S S Korsakova     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_cybersex2) # Visually inspect results</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the cybersex search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a>Label_Cybersex <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"cybersex"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_cybersex2))</span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a>results_cybersex_final <span class="ot">&lt;-</span> results_cybersex2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Cybersex) <span class="sc">%&gt;%</span></span>
<span id="cb211-7"><a href="#cb211-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb211-8"><a href="#cb211-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb211-9"><a href="#cb211-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-10"><a href="#cb211-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_cybersex_final)</span></span>
<span id="cb211-11"><a href="#cb211-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb211-12"><a href="#cb211-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_cybersex_final, <span class="st">"Data extraction/cybersex_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sex-addiction" class="level2">
<h2 class="anchored" data-anchor-id="sex-addiction">Sex addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-11" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-11">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> MeSH terms: None available.</p>
<p><strong>Actual search used:</strong> “sexual addiction”[Title/Abstract] OR “sex addiction”[Title/Abstract]</p>
<ul>
<li>Originally included “sex dependence” as a search term, but it didn’t return anything related to sexual addiction and returned lots of studies that said the expression/presence of something e.g., a disease) was dependent on sex.</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22sexual+addiction%22%5BTitle%2FAbstract%5D+OR+%22sex+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> # The manual search of results revealed that there were multiple irrelevant studies returned here. This is because there were several studies that listed sex and then addiction as variables of interest like “…, sex, addiction, …”. There is also one book called “Drug Addiction”. Here’s the full list of irrelevant studies that will need to be removed when refining the dataset:</p>
<ul>
<li>The SCOPE study: health-care consumption related to patients with chronic obstructive pulmonary disease in France</li>
<li>Correlation of addictive factors, human papilloma virus infection and histopathology of oral submucous fibrosis</li>
<li>Serum malondialdehyde level: Surrogate stress marker in the Sikkimese diabetics</li>
<li>Design in topographical space of peptide and peptidomimetic ligands that affect behavior. A chemist’s glimpse at the mind–body problem</li>
<li>Tricyclic antidepressants intoxication in Tehran, Iran: epidemiology and associated factors</li>
<li>Biochemical aspects of effects of mesenchymal stem cell treatment in chronic wounds progressive healing</li>
<li>Drug Addiction</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-8" class="level1">
<h1>Define the search term:</h1>
<p>search_term_sex &lt;- ‘“sexual addiction”[Title/Abstract] OR “sex addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-11" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_sex &lt;- entrez_search(db=“pubmed”, term=search_term_sex, retmax=20000) id_list_sex &lt;- search_results_sex$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-11" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_sex, ceiling(seq_along(id_list_sex)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-11" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_sex &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_sex &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_sex &lt;- bind_rows(details_sex)

return(details_df_sex)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-11" class="level1">
<h1>Check the results:</h1>
<p>article_details_sex %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-11" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_sex &lt;- article_details_sex %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-11" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_sex, “Data extraction/sex_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-2"><a href="#cb213-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb213-3"><a href="#cb213-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-4"><a href="#cb213-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb213-5"><a href="#cb213-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-6"><a href="#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb213-7"><a href="#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb213-8"><a href="#cb213-8" aria-hidden="true" tabindex="-1"></a>url_sex_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22sexual+addiction%22%5BTitle%2FAbstract%5D+OR+%22sex+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 275 results returned on 19/08/2023</span></span>
<span id="cb213-9"><a href="#cb213-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-10"><a href="#cb213-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb213-11"><a href="#cb213-11" aria-hidden="true" tabindex="-1"></a>webpage_sex_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_sex_rvest)</span>
<span id="cb213-12"><a href="#cb213-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-13"><a href="#cb213-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb213-14"><a href="#cb213-14" aria-hidden="true" tabindex="-1"></a>results_count_sex <span class="ot">&lt;-</span> webpage_sex_rvest <span class="sc">%&gt;%</span></span>
<span id="cb213-15"><a href="#cb213-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-16"><a href="#cb213-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb213-17"><a href="#cb213-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-18"><a href="#cb213-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb213-19"><a href="#cb213-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-20"><a href="#cb213-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb213-21"><a href="#cb213-21" aria-hidden="true" tabindex="-1"></a>results_per_page_sex <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb213-22"><a href="#cb213-22" aria-hidden="true" tabindex="-1"></a>total_pages_sex <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_sex[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_sex)</span>
<span id="cb213-23"><a href="#cb213-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_sex and total_pages_sex</span></span>
<span id="cb213-24"><a href="#cb213-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_sex)</span>
<span id="cb213-25"><a href="#cb213-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_sex)</span>
<span id="cb213-26"><a href="#cb213-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-27"><a href="#cb213-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-28"><a href="#cb213-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb213-29"><a href="#cb213-29" aria-hidden="true" tabindex="-1"></a>results_sex_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb213-30"><a href="#cb213-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-31"><a href="#cb213-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb213-32"><a href="#cb213-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_sex <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb213-33"><a href="#cb213-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb213-34"><a href="#cb213-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_sex_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb213-35"><a href="#cb213-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-36"><a href="#cb213-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb213-37"><a href="#cb213-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb213-38"><a href="#cb213-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-39"><a href="#cb213-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb213-40"><a href="#cb213-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb213-41"><a href="#cb213-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb213-42"><a href="#cb213-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-43"><a href="#cb213-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb213-44"><a href="#cb213-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb213-45"><a href="#cb213-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb213-46"><a href="#cb213-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb213-47"><a href="#cb213-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb213-48"><a href="#cb213-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-49"><a href="#cb213-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb213-50"><a href="#cb213-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb213-51"><a href="#cb213-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb213-52"><a href="#cb213-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb213-53"><a href="#cb213-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-54"><a href="#cb213-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb213-55"><a href="#cb213-55" aria-hidden="true" tabindex="-1"></a>  current_results_sex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb213-56"><a href="#cb213-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb213-57"><a href="#cb213-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-58"><a href="#cb213-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb213-59"><a href="#cb213-59" aria-hidden="true" tabindex="-1"></a>  results_sex_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_sex_rvest, current_results_sex)</span>
<span id="cb213-60"><a href="#cb213-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb213-61"><a href="#cb213-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb213-62"><a href="#cb213-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb213-63"><a href="#cb213-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb213-64"><a href="#cb213-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb213-65"><a href="#cb213-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-66"><a href="#cb213-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb213-67"><a href="#cb213-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_sex_rvest))</span>
<span id="cb213-68"><a href="#cb213-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-69"><a href="#cb213-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-70"><a href="#cb213-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb213-71"><a href="#cb213-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_sex_rvest, <span class="st">"Data extraction/sex_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-11" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-11">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>results_sex<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/sex_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb214-4"><a href="#cb214-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-5"><a href="#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb214-6"><a href="#cb214-6" aria-hidden="true" tabindex="-1"></a>results_sex_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/sex_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb214-7"><a href="#cb214-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb214-8"><a href="#cb214-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-9"><a href="#cb214-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb214-10"><a href="#cb214-10" aria-hidden="true" tabindex="-1"></a>results_sex2 <span class="ot">&lt;-</span> results_sex <span class="sc">%&gt;%</span></span>
<span id="cb214-11"><a href="#cb214-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb214-12"><a href="#cb214-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb214-13"><a href="#cb214-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_sex_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb214-14"><a href="#cb214-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb214-15"><a href="#cb214-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb214-16"><a href="#cb214-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 275 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Decision m… 3.76e7  2023 &lt;NA&gt;  10.3… "INTROD… Muller, Silke M… "Department o…
 2 Mapping th… 3.75e7  2023 Jul   S016… "Contem… Hunt, Brian; Za… "Institute fo…
 3 The World … 3.75e7  2022 Dec   10.1… "OBJECT… Turner, Daniel;… "Department o…
 4 Should pro… 3.75e7  2023 Dec   10.1… "Despit… Pistre, Natasha… "Department o…
 5 Measuring … 3.75e7  2023 Jul   10.1… "BACKGR… Miele, Cecile; … "Laboratory Q…
 6 Fetal Fant… 3.75e7  2023 Jul   10.1… "This a… Erdman, Andrew L "LCSW, 235 We…
 7 Personalit… 3.74e7  2023 Jun   10.1… "BACKGR… Engel, Jannis; … "Department o…
 8 How the Ri… 3.73e7  2023 Jun   10.7… "On Jan… Irizarry, Ricar… "Psychiatry, …
 9 Childhood … 3.72e7  2023 Jan   10.1… "Object… Zashchirinskaia… "Saint-Peters…
10 Frequency … 3.71e7  2023 &lt;NA&gt;  10.1… "INTROD… Schreck, Benoit… "Nantes Unive…
# ℹ 265 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_sex2)</span></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>results_sex2 <span class="sc">%&gt;%</span></span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb216-7"><a href="#cb216-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb216-8"><a href="#cb216-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 2 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   273</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect duplicates:</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="co"># results_sex2 %&gt;%</span></span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a><span class="co">#    group_by(Title) %&gt;% </span></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(n()&gt;1) %&gt;%  </span></span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   View()  #  both duplicates appear to be genuine duplicates. Unsure why they are duplicated in pubmed, but there are some very minor differences in author initials  which may explain it.</span></span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>results_sex2 <span class="sc">%&gt;%</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicates and irrelevant studies identified manually:</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>results_sex3 <span class="ot">&lt;-</span> results_sex2 <span class="sc">%&gt;%</span></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"The SCOPE study: health-care consumption related to patients with chronic obstructive pulmonary disease in France."</span>,</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Correlation of addictive factors, human papilloma virus infection and histopathology of oral submucous fibrosis."</span>,</span>
<span id="cb220-8"><a href="#cb220-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Serum malondialdehyde level: Surrogate stress marker in the Sikkimese diabetics."</span>,</span>
<span id="cb220-9"><a href="#cb220-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Design in topographical space of peptide and peptidomimetic ligands that affect behavior. A chemist's glimpse at the mind--body problem."</span>,</span>
<span id="cb220-10"><a href="#cb220-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Tricyclic antidepressants intoxication in Tehran, Iran: epidemiology and associated factors."</span>,</span>
<span id="cb220-11"><a href="#cb220-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Biochemical aspects of effects of mesenchymal stem cell treatment in chronic wounds progressive healing."</span>,</span>
<span id="cb220-12"><a href="#cb220-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Drug Addiction."</span></span>
<span id="cb220-13"><a href="#cb220-13" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb220-14"><a href="#cb220-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb220-15"><a href="#cb220-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-16"><a href="#cb220-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-17"><a href="#cb220-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb220-18"><a href="#cb220-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_sex3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1987    2010    2016    2014    2020    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>sex_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_sex3<span class="sc">$</span>Year,</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">20</span>,</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Sex Addiction (PubMed)"</span>,</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>results_sex2 <span class="sc">%&gt;%</span> </span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb223-5"><a href="#cb223-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb223-6"><a href="#cb223-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb223-7"><a href="#cb223-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb223-8"><a href="#cb223-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 143 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 J Behav Addict                     25
 2 J Sex Med                          17
 3 J Sex Marital Ther                 13
 4 Arch Sex Behav                      9
 5 Cureus                              7
 6 Int J Environ Res Public Health     5
 7 J Addict Med                        5
 8 J Sex Res                           5
 9 Addiction                           4
10 Encephale                           4
11 Front Psychiatry                    4
12 Addict Behav Rep                    3
13 BMC Psychiatry                      3
14 Braz J Psychiatry                   3
15 CNS Spectr                          3
16 Clin Psychol Rev                    3
17 Front Psychol                       3
18 Indian J Psychiatry                 3
19 J Clin Med                          3
20 J Psychoactive Drugs                3
# ℹ 123 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_sex2) # Visually inspect results</span></span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the sex search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>Label_Sex <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"sex"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_sex2))</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a>results_sex_final <span class="ot">&lt;-</span> results_sex2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Sex) <span class="sc">%&gt;%</span></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_sex_final)</span></span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_sex_final, <span class="st">"Data extraction/sex_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pornography-addiction" class="level2">
<h2 class="anchored" data-anchor-id="pornography-addiction">Pornography addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-12" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-12">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No MeSH terms available. Pornography-use disorder is the term used in https://doi.org/10.1556/2006.2020.00035. Cybersex addiction refers to a more broad focus on internet-related sexual stimulation (E.g., chat rooms and VR), but it seems like there is definitely some overlap between the search returns.</p>
<p><strong>Actual search used:</strong> “pornography-use disorder”[Title/Abstract] OR “pornography addiction”[Title/Abstract]</p>
<ul>
<li>Not found so removed from search terms: “pornography dependence”, “addiction to pornography”, “cybersex dependence”</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22pornography-use+disorder%22%5BTitle%2FAbstract%5D+OR+%22pornography+addiction%22%5BTitle%2FAbstract%5D+&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. As far as I can see, all studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-9" class="level1">
<h1>Define the search term:</h1>
<p>search_term_pornography &lt;- ‘“pornography-use disorder”[Title/Abstract] OR “pornography addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-12" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_pornography &lt;- entrez_search(db=“pubmed”, term=search_term_pornography, retmax=20000) id_list_pornography &lt;- search_results_pornography$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-12" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_pornography, ceiling(seq_along(id_list_pornography)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-12" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_pornography &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_pornography &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_pornography &lt;- bind_rows(details_pornography)

return(details_df_pornography)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-12" class="level1">
<h1>Check the results:</h1>
<p>article_details_pornography %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-12" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_pornography &lt;- article_details_pornography %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-12" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_pornography, “Data extraction/pornography_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a>url_pornography_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22pornography-use+disorder%22%5BTitle%2FAbstract%5D+OR+%22pornography+addiction%22%5BTitle%2FAbstract%5D+&amp;size=200"</span> <span class="co"># 71 results returned on 19/08/2023</span></span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a>webpage_pornography_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_pornography_rvest)</span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>results_count_pornography <span class="ot">&lt;-</span> webpage_pornography_rvest <span class="sc">%&gt;%</span></span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>results_per_page_pornography <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a>total_pages_pornography <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_pornography[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_pornography)</span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_pornography and total_pages_pornography</span></span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_pornography)</span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_pornography)</span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a>results_pornography_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_pornography <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_pornography_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>  current_results_pornography <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>  results_pornography_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_pornography_rvest, current_results_pornography)</span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb227-61"><a href="#cb227-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb227-62"><a href="#cb227-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb227-63"><a href="#cb227-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb227-64"><a href="#cb227-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb227-65"><a href="#cb227-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-66"><a href="#cb227-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb227-67"><a href="#cb227-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_pornography_rvest))</span>
<span id="cb227-68"><a href="#cb227-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-69"><a href="#cb227-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-70"><a href="#cb227-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb227-71"><a href="#cb227-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_pornography_rvest, <span class="st">"Data extraction/pornography_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-12" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-12">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>results_pornography<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/pornography_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-5"><a href="#cb228-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb228-6"><a href="#cb228-6" aria-hidden="true" tabindex="-1"></a>results_pornography_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/pornography_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb228-7"><a href="#cb228-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb228-8"><a href="#cb228-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb228-9"><a href="#cb228-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb228-10"><a href="#cb228-10" aria-hidden="true" tabindex="-1"></a>results_pornography2 <span class="ot">&lt;-</span> results_pornography <span class="sc">%&gt;%</span></span>
<span id="cb228-11"><a href="#cb228-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb228-12"><a href="#cb228-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb228-13"><a href="#cb228-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_pornography_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb228-14"><a href="#cb228-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb228-15"><a href="#cb228-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb228-16"><a href="#cb228-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 71 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Decision m… 3.76e7  2023 &lt;NA&gt;  10.3… "INTROD… Muller, Silke M… "Department o…
 2 Pornograph… 3.75e7  2023 Aug   10.1… "Accord… Privara, Michal… "Center for N…
 3 How the Ri… 3.73e7  2023 Jun   10.7… "On Jan… Irizarry, Ricar… "Psychiatry, …
 4 On the cur… 3.71e7  2023 Jun   10.1… "BACKGR… Markert, Charlo… "1Department …
 5 Pornograph… 3.70e7  2023 Apr   &lt;NA&gt;  "OBJECT… Noel, Jonathan … "Department o…
 6 Impact of … 3.69e7  2023 Jun   10.1… "A sign… Kostopoulou, Ei… "Department o…
 7 Physiologi… 3.68e7  2023 Jan   10.7… "Intern… Mehmood Qadri, … "Surgery, Lah…
 8 The Potent… 3.67e7  2022 Dec   10.7… "Pornog… Rasul, Taha F; … "Dr. Phillip …
 9 Males' Liv… 3.67e7  2023 Jan   10.3… "The po… Hanseder, Sophi… "Curtin Schoo…
10 Web-Based … 3.66e7  2023 May   10.1… "Resear… Hatch, S Gabe; … "Department o…
# ℹ 61 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_pornography2)</span></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>results_pornography2 <span class="sc">%&gt;%</span></span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 1 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    70</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check duplicate:</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a><span class="co"># results_pornography2 %&gt;%</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   group_by(Title) %&gt;% </span></span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     filter(n()&gt;1)  %&gt;% </span></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   View()# **This is a genuine duplicate.The PMID  for removal is: 34400111</span></span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>results_pornography2 <span class="sc">%&gt;%</span></span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb232-10"><a href="#cb232-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb232-11"><a href="#cb232-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    71</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out duplicate:</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>results_pornography3 <span class="ot">&lt;-</span> results_pornography2 <span class="sc">%&gt;%</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(PMID <span class="sc">!=</span> <span class="st">"34400111"</span>)</span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_pornography3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2008    2018    2020    2019    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>pornography_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_pornography3<span class="sc">$</span>Year,</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">15</span>,</span>
<span id="cb236-5"><a href="#cb236-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Pornography Addiction (PubMed)"</span>,</span>
<span id="cb236-6"><a href="#cb236-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>results_pornography3 <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 43 × 2
   Journal_name_short                  n
   &lt;chr&gt;                           &lt;int&gt;
 1 J Behav Addict                     12
 2 J Sex Med                           6
 3 Arch Sex Behav                      3
 4 Cureus                              3
 5 Front Psychiatry                    3
 6 J Sex Res                           3
 7 Addict Behav                        2
 8 Addiction                           2
 9 Int J Environ Res Public Health     2
10 Addict Health                       1
11 Am J Addict                         1
12 BMJ                                 1
13 Behav Sci (Basel)                   1
14 Biol Psychol                        1
15 CNS Spectr                          1
16 Clin Psychol Rev                    1
17 Compr Psychiatry                    1
18 Comput Biol Med                     1
19 Data Brief                          1
20 Eur J Pediatr                       1
# ℹ 23 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_pornography2) # Visually inspect results</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the pornography search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a>Label_Pornography <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"pornography"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_pornography3))</span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a>results_pornography_final <span class="ot">&lt;-</span> results_pornography3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Pornography) <span class="sc">%&gt;%</span></span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_pornography_final)</span></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_pornography_final, <span class="st">"Data extraction/pornography_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tanning-addiction" class="level2">
<h2 class="anchored" data-anchor-id="tanning-addiction">Tanning addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-13" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-13">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> There are obviously no MeSH terms for this.The few studies are confined on this scene to either call it “excessive tanning” or, more commonly, “tanning addiction”</p>
<p><strong>Actual search used:</strong> “Tanning addiction”[Title/Abstract] - Not found so removed from search terms: “Addicted to tanning”[Title/Abstract] AND “Tanning disorder”[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Tanning+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. As far as I can see, all studies appeared relevant as of latest search date (see top of document).</p>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-10" class="level1">
<h1>Define the search term:</h1>
<p>search_term_tanning &lt;- ‘“Tanning addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-13" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_tanning &lt;- entrez_search(db=“pubmed”, term=search_term_tanning, retmax=20000) id_list_tanning &lt;- search_results_tanning$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-13" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_tanning, ceiling(seq_along(id_list_tanning)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-13" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_tanning &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_tanning &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_tanning &lt;- bind_rows(details_tanning)

return(details_df_tanning)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-13" class="level1">
<h1>Check the results:</h1>
<p>article_details_tanning %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-13" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_tanning &lt;- article_details_tanning %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-13" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_tanning, “Data extraction/tanning_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb241-3"><a href="#cb241-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-4"><a href="#cb241-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb241-5"><a href="#cb241-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-6"><a href="#cb241-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb241-7"><a href="#cb241-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb241-8"><a href="#cb241-8" aria-hidden="true" tabindex="-1"></a>url_tanning_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Tanning+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 29 results returned on 19/08/2023</span></span>
<span id="cb241-9"><a href="#cb241-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-10"><a href="#cb241-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb241-11"><a href="#cb241-11" aria-hidden="true" tabindex="-1"></a>webpage_tanning_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_tanning_rvest)</span>
<span id="cb241-12"><a href="#cb241-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-13"><a href="#cb241-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb241-14"><a href="#cb241-14" aria-hidden="true" tabindex="-1"></a>results_count_tanning <span class="ot">&lt;-</span> webpage_tanning_rvest <span class="sc">%&gt;%</span></span>
<span id="cb241-15"><a href="#cb241-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb241-16"><a href="#cb241-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb241-17"><a href="#cb241-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb241-18"><a href="#cb241-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb241-19"><a href="#cb241-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-20"><a href="#cb241-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb241-21"><a href="#cb241-21" aria-hidden="true" tabindex="-1"></a>results_per_page_tanning <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb241-22"><a href="#cb241-22" aria-hidden="true" tabindex="-1"></a>total_pages_tanning <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_tanning[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_tanning)</span>
<span id="cb241-23"><a href="#cb241-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_tanning and total_pages_tanning</span></span>
<span id="cb241-24"><a href="#cb241-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_tanning)</span>
<span id="cb241-25"><a href="#cb241-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_tanning)</span>
<span id="cb241-26"><a href="#cb241-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-27"><a href="#cb241-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-28"><a href="#cb241-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb241-29"><a href="#cb241-29" aria-hidden="true" tabindex="-1"></a>results_tanning_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb241-30"><a href="#cb241-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-31"><a href="#cb241-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb241-32"><a href="#cb241-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_tanning <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb241-33"><a href="#cb241-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb241-34"><a href="#cb241-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_tanning_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb241-35"><a href="#cb241-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb241-36"><a href="#cb241-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb241-37"><a href="#cb241-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb241-38"><a href="#cb241-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb241-39"><a href="#cb241-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb241-40"><a href="#cb241-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb241-41"><a href="#cb241-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb241-42"><a href="#cb241-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb241-43"><a href="#cb241-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-44"><a href="#cb241-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb241-45"><a href="#cb241-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb241-46"><a href="#cb241-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb241-47"><a href="#cb241-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb241-48"><a href="#cb241-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb241-49"><a href="#cb241-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb241-50"><a href="#cb241-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb241-51"><a href="#cb241-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb241-52"><a href="#cb241-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-53"><a href="#cb241-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb241-54"><a href="#cb241-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb241-55"><a href="#cb241-55" aria-hidden="true" tabindex="-1"></a>  current_results_tanning <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb241-56"><a href="#cb241-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb241-57"><a href="#cb241-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb241-58"><a href="#cb241-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb241-59"><a href="#cb241-59" aria-hidden="true" tabindex="-1"></a>  results_tanning_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_tanning_rvest, current_results_tanning)</span>
<span id="cb241-60"><a href="#cb241-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb241-61"><a href="#cb241-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb241-62"><a href="#cb241-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb241-63"><a href="#cb241-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb241-64"><a href="#cb241-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb241-65"><a href="#cb241-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-66"><a href="#cb241-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb241-67"><a href="#cb241-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_tanning_rvest))</span>
<span id="cb241-68"><a href="#cb241-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-69"><a href="#cb241-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-70"><a href="#cb241-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb241-71"><a href="#cb241-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_tanning_rvest, <span class="st">"Data extraction/tanning_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-13" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-13">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>results_tanning<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/tanning_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a>results_tanning_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/tanning_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a>results_tanning2 <span class="ot">&lt;-</span> results_tanning <span class="sc">%&gt;%</span></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_tanning_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 29 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Encouragin… 3.57e7  2022 Jun   10.1… "Childr… Stockfleth, E; … "Klinik fur D…
 2 Skin cance… 3.31e7  2020 Oct   10.1… "Since … Phan, Mimi N; K… "College of M…
 3 Heritabili… 3.26e7  2020 Nov   S019…  &lt;NA&gt;    Tripathi, Ragha… "Department o…
 4 Ultraviole… 3.24e7  2020 Jul/… 10.1…  &lt;NA&gt;    Ouchene, Lydia;… "1236754473 D…
 5 Attitudes … 3.19e7  2020 Nov   10.1… "The ai… Nahar, Vinayak … "Department o…
 6 Genetic As… 3.12e7  2020 Jan   10.1… "BACKGR… Mays, Darren; A… "Lombardi Com…
 7 Can neuroi… 3.00e7  2018 Oct   S088… "High u… Iacopetta, Krys… "Adelaide Cen…
 8 Tanning Ad… 2.99e7  2018 Jul   S002… "Little… Tripp, Mary K    "Department o…
 9 Prevalence… 2.95e7  2018 Jul   S002… "Eviden… Miller, Kimberl… "Department o…
10 Tanning ad… 2.95e7  2018 Aug   10.1… "BACKGR… Andreassen, C S… "Department o…
# ℹ 19 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_tanning2)</span></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_tanning2 <span class="sc">%&gt;%</span></span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>Simple_duplicate_removal_n <span class="ot">&lt;-</span> results_tanning2 <span class="sc">%&gt;%</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    29</code></pre>
</div>
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_tanning2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2009    2014    2016    2016    2018    2022 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>tanning_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_tanning2<span class="sc">$</span>Year,</span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb250-4"><a href="#cb250-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">15</span>,</span>
<span id="cb250-5"><a href="#cb250-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Tanning Addiction (PubMed)"</span>,</span>
<span id="cb250-6"><a href="#cb250-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>results_tanning2 <span class="sc">%&gt;%</span> </span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 24 × 2
   Journal_name_short               n
   &lt;chr&gt;                        &lt;int&gt;
 1 J Am Acad Dermatol               3
 2 Br J Dermatol                    2
 3 J Eur Acad Dermatol Venereol     2
 4 J Invest Dermatol                2
 5 Addict Behav                     1
 6 Am J Drug Alcohol Abuse          1
 7 Ann Behav Med                    1
 8 Arch Dermatol                    1
 9 Arch Dermatol Res                1
10 Brain Behav Immun                1
11 Clin Exp Dermatol                1
12 Commun Integr Biol               1
13 Curr Pharm Des                   1
14 Curr Probl Dermatol              1
15 Dermatol Clin                    1
16 Encephale                        1
17 J Biomed Res                     1
18 J Cutan Med Surg                 1
19 J Exp Anal Behav                 1
20 Pediatrics                       1
# ℹ 4 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_tanning2) # Visually inspect results</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the tanning search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb253-4"><a href="#cb253-4" aria-hidden="true" tabindex="-1"></a>Label_tanning <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"tanning"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_tanning2))</span>
<span id="cb253-5"><a href="#cb253-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-6"><a href="#cb253-6" aria-hidden="true" tabindex="-1"></a>results_tanning_final <span class="ot">&lt;-</span> results_tanning2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_tanning) <span class="sc">%&gt;%</span></span>
<span id="cb253-7"><a href="#cb253-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb253-8"><a href="#cb253-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb253-9"><a href="#cb253-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb253-10"><a href="#cb253-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_tanning_final)</span></span>
<span id="cb253-11"><a href="#cb253-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb253-12"><a href="#cb253-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_tanning_final, <span class="st">"Data extraction/tanning_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="hair-pulling-addiction" class="level2">
<h2 class="anchored" data-anchor-id="hair-pulling-addiction">Hair pulling addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-14" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-14">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> MeSH terms: The only term used here is the official diagnostic term, trichotillomania (see: <a href="https://www.ncbi.nlm.nih.gov/mesh/?term=Trichotillomania">here</a>).</p>
<p><strong>Actual search used:</strong> “Hair pulling addiction” OR “trichotillomania addiction” - Searching just trichotillomania led to many relevant studies (see notes post-search).</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22trichotillomania+addiction%22&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> The strategy here was very different as many people consider here pulling/trichotillomania to be a form of impulse control disorder, rather than behavioural addiction. So, I varied the search terms to get as many studies as possible that discuss it within the context of addiction, and as few studies as possible that do not. Then, from the 68 studies returned in this initial sample, I manually inspected all of them to see which discussed this condition as a behavioural addiction to some extent. The following studies were identified as being relevant and will be removed when refining the dataset:</p>
<ol type="1">
<li>The neurobiology and genetics of impulse control disorders: relationships to drug addictions</li>
<li>Behavioural addiction-A rising tide?</li>
<li>Compulsivity in obsessive-compulsive disorder and addictions</li>
<li>Naltrexone in the Treatment of Broadly Defined Behavioral Addictions: A Review and Meta-Analysis of Randomized Controlled Trials</li>
<li>An A-B-C model of habit disorders: hair-pulling, skin-picking, and other stereotypic conditions</li>
<li>Co-occurrences of substance use and other potentially addictive behaviors: Epidemiological results from the Psychological and Genetic Factors of the Addictive Behaviors (PGA) Study</li>
<li>Epidemiology of behavioral dependence: literature review and results of original studies</li>
<li>Opioid antagonists in broadly defined behavioral addictions: a narrative review</li>
<li>Addicted to hair pulling? How an alternate model of trichotillomania may improve treatment outcome</li>
<li>Tricotillomania: pathopsychology theories and treatment possibilities</li>
<li>[Trichotillomania and comorbidity–lamotrigine in a new perspective]</li>
<li><a href="#internet-addiction">Internet addiction</a></li>
<li>Naltrexone: A Pan-Addiction Treatment?</li>
</ol>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-11" class="level1">
<h1>Define the search term:</h1>
<p>search_term_hair_pulling &lt;- ‘“Hair pulling addiction” OR “trichotillomania addiction”’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-14" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_hair_pulling &lt;- entrez_search(db=“pubmed”, term=search_term_hair_pulling, retmax=20000) id_list_hair_pulling &lt;- search_results_hair_pulling$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-14" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_hair_pulling, ceiling(seq_along(id_list_hair_pulling)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-14" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_hair_pulling &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_hair_pulling &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_hair_pulling &lt;- bind_rows(details_hair_pulling)

return(details_df_hair_pulling)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-14" class="level1">
<h1>Check the results:</h1>
<p>article_details_hair_pulling %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-14" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_hair_pulling &lt;- article_details_hair_pulling %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-14" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_hair_pulling, “Data extraction/hair_pulling_data.csv”, row.names=FALSE)</p>
<pre><code>
#### Extract full title using rvest

Again, we're going to use the `rvest` package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.

```{ {r warning=FALSE, message=FALSE}}
# Add search URL:
url_hair_pulling_rvest &lt;- "https://pubmed.ncbi.nlm.nih.gov/?term=%22Hair+pulling+addiction%22+OR+%22trichotillomania+addiction%22&amp;size=200" # 68 results returned on 20/08/2023

# Read and parse the webpage
webpage_hair_pulling_rvest &lt;- read_html(url_hair_pulling_rvest)

# Get the total number of search results
results_count_hair_pulling &lt;- webpage_hair_pulling_rvest %&gt;%
  html_node(".results-amount .value") %&gt;%
  html_text() %&gt;%
  str_replace(",", "") %&gt;%
  as.numeric()

# Calculate the number of pages
results_per_page_hair_pulling &lt;- 50
total_pages_hair_pulling &lt;- ceiling(results_count_hair_pulling[1] / results_per_page_hair_pulling)
# Print results_count_hair_pulling and total_pages_hair_pulling
print(results_count_hair_pulling)
print(total_pages_hair_pulling)


# Initialize an empty data frame
results_hair_pulling_rvest &lt;- data.frame()

# Loop through each page and scrape the data
for (page in 0:(total_pages_hair_pulling - 1)) {
  # Update the page parameter in the URL for the current page
  current_url &lt;- paste0(url_hair_pulling_rvest, "&amp;page=", page + 1)
  
  # Read and parse the current webpage
  current_page &lt;- read_html(current_url)
  
  # Extract title
  Title &lt;- tryCatch({
    current_page %&gt;%
      html_nodes(".docsum-title") %&gt;%
      html_text(trim = TRUE)
  }, error = function(e) {
    print(paste("Error extracting title info on page", page + 1))
    rep(NA, length(Title))  # Return a vector of NAs with the same length as Title
  })
  
  # Extract the PMID
  pmid &lt;- current_page %&gt;%
    html_nodes(".docsum-pmid") %&gt;%
    html_text(trim = TRUE)
  
  # Create a data frame with the extracted data
  current_results_hair_pulling &lt;- data.frame(Title = Title,
                                       PMID = pmid)
  
  # Combine the current results with the previous results
  results_hair_pulling_rvest &lt;- rbind(results_hair_pulling_rvest, current_results_hair_pulling)
  
  # Introduce a delay to avoid overloading the server
  sleep_time &lt;- runif(1, min = 5, max = 15)
  Sys.sleep(sleep_time)
}

# Print the extracted data
print(as_tibble(results_hair_pulling_rvest))


# Now save the titles before proceeding so we can't lose them!
write.csv(results_hair_pulling_rvest, "Data extraction/hair_pulling_titles.csv", row.names=FALSE)</code></pre>
<section id="refine-dataset-14" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-14">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>results_hair_pulling<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/hair_pulling_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb256-6"><a href="#cb256-6" aria-hidden="true" tabindex="-1"></a>results_hair_pulling_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/hair_pulling_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb256-7"><a href="#cb256-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb256-8"><a href="#cb256-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb256-9"><a href="#cb256-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb256-10"><a href="#cb256-10" aria-hidden="true" tabindex="-1"></a>results_hair_pulling2 <span class="ot">&lt;-</span> results_hair_pulling <span class="sc">%&gt;%</span></span>
<span id="cb256-11"><a href="#cb256-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb256-12"><a href="#cb256-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb256-13"><a href="#cb256-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_hair_pulling_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb256-14"><a href="#cb256-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb256-15"><a href="#cb256-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb256-16"><a href="#cb256-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 68 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Impulse Co… 3.30e7  2023 Jan   &lt;NA&gt;  "Impuls… Fariba, Kamron … "University H…
 2 Obsessive-… 3.20e7  2023 Jan   &lt;NA&gt;  "Obsess… Brock, Hannah; … "University H…
 3 Treatment … 3.71e7  2023 May   10.1…  &lt;NA&gt;    Kalin, Ned H     "Department o…
 4 Body Focus… 3.70e7  2023 Spri… 10.5… "OBJECT… Okumus, Hande G…  &lt;NA&gt;         
 5 Severity o… 3.69e7  2023 Jun   10.1… "INTROD… Peter, Lea; Pak… "Department o…
 6 rTMS inves… 3.68e7  2022 &lt;NA&gt;  10.3… "INTROD… Di Ponzio, Mich… "Institute fo…
 7 Autism and… 3.67e7  2023 Apr   S014… "Autism… Chamberlain, Sa… "Department o…
 8 FOXN3 and … 3.56e7  2022 Apr   10.3… "Epidem… Vereczkei, Andr… "Department o…
 9 Editorial:… 3.52e7  2022 &lt;NA&gt;  10.3…  &lt;NA&gt;    Loscalzo, Yura;… "Department o…
10 The Preval… 3.51e7  2021 &lt;NA&gt;  10.3… "Aim: I… Devoe, Daniel J… "Mathison Cen…
# ℹ 58 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_hair_pulling2)</span></span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>results_hair_pulling2 <span class="sc">%&gt;%</span></span>
<span id="cb258-6"><a href="#cb258-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb258-7"><a href="#cb258-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb258-8"><a href="#cb258-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    68</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>results_hair_pulling2 <span class="sc">%&gt;%</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    68</code></pre>
</div>
<div class="sourceCode cell-code" id="cb262"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb262-1"><a href="#cb262-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now isolate the relevant studies:</span></span>
<span id="cb262-2"><a href="#cb262-2" aria-hidden="true" tabindex="-1"></a>results_hair_pulling3 <span class="ot">&lt;-</span>  results_hair_pulling2 <span class="sc">%&gt;%</span> </span>
<span id="cb262-3"><a href="#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb262-4"><a href="#cb262-4" aria-hidden="true" tabindex="-1"></a><span class="st">"The neurobiology and genetics of impulse control disorders: relationships to drug addictions."</span>,</span>
<span id="cb262-5"><a href="#cb262-5" aria-hidden="true" tabindex="-1"></a><span class="st">"Behavioural addiction-A rising tide?"</span>,</span>
<span id="cb262-6"><a href="#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="st">"Compulsivity in obsessive-compulsive disorder and addictions."</span>,</span>
<span id="cb262-7"><a href="#cb262-7" aria-hidden="true" tabindex="-1"></a><span class="st">"Naltrexone in the Treatment of Broadly Defined Behavioral Addictions: A Review and Meta-Analysis of Randomized Controlled Trials."</span>,</span>
<span id="cb262-8"><a href="#cb262-8" aria-hidden="true" tabindex="-1"></a><span class="st">"An A-B-C model of habit disorders: hair-pulling, skin-picking, and other stereotypic conditions."</span>,</span>
<span id="cb262-9"><a href="#cb262-9" aria-hidden="true" tabindex="-1"></a><span class="st">"Co-occurrences of substance use and other potentially addictive behaviors: Epidemiological results from the Psychological and Genetic Factors of the Addictive Behaviors (PGA) Study."</span>,</span>
<span id="cb262-10"><a href="#cb262-10" aria-hidden="true" tabindex="-1"></a><span class="st">"Epidemiology of behavioral dependence: literature review and results of original studies."</span>,</span>
<span id="cb262-11"><a href="#cb262-11" aria-hidden="true" tabindex="-1"></a><span class="st">"Opioid antagonists in broadly defined behavioral addictions: a narrative review."</span>,</span>
<span id="cb262-12"><a href="#cb262-12" aria-hidden="true" tabindex="-1"></a><span class="st">"Addicted to hair pulling? How an alternate model of trichotillomania may improve treatment outcome."</span>,</span>
<span id="cb262-13"><a href="#cb262-13" aria-hidden="true" tabindex="-1"></a><span class="st">"Tricotillomania: pathopsychology theories and treatment possibilities."</span>,</span>
<span id="cb262-14"><a href="#cb262-14" aria-hidden="true" tabindex="-1"></a><span class="st">"[Trichotillomania and comorbidity--lamotrigine in a new perspective]."</span>,</span>
<span id="cb262-15"><a href="#cb262-15" aria-hidden="true" tabindex="-1"></a><span class="st">"[Internet addiction]."</span>,</span>
<span id="cb262-16"><a href="#cb262-16" aria-hidden="true" tabindex="-1"></a><span class="st">"Naltrexone: A Pan-Addiction Treatment?"</span>))</span>
<span id="cb262-17"><a href="#cb262-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-18"><a href="#cb262-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb262-19"><a href="#cb262-19" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_hair_pulling3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2000    2007    2012    2011    2016    2020 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb264-2"><a href="#cb264-2" aria-hidden="true" tabindex="-1"></a>hair_pulling_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_hair_pulling3<span class="sc">$</span>Year,</span>
<span id="cb264-3"><a href="#cb264-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb264-4"><a href="#cb264-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="dv">15</span>,</span>
<span id="cb264-5"><a href="#cb264-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Hair Pulling Addiction (PubMed)"</span>,</span>
<span id="cb264-6"><a href="#cb264-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>results_hair_pulling3 <span class="sc">%&gt;%</span> </span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb265-6"><a href="#cb265-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb265-7"><a href="#cb265-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb265-8"><a href="#cb265-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 2
   Journal_name_short            n
   &lt;chr&gt;                     &lt;int&gt;
 1 Eur Neuropsychopharmacol      2
 2 Biochem Pharmacol             1
 3 CNS Drugs                     1
 4 CNS Spectr                    1
 5 Eur Addict Res                1
 6 Eur Psychiatry                1
 7 Expert Opin Pharmacother      1
 8 Harefuah                      1
 9 Harv Rev Psychiatry           1
10 Isr Med Assoc J               1
11 J Behav Addict                1
12 Neuropsychopharmacol Hung     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_hair_pulling2) # Visually inspect results</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the hair_pulling search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb267-4"><a href="#cb267-4" aria-hidden="true" tabindex="-1"></a>Label_hair_pulling <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"hair_pulling"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_hair_pulling3))</span>
<span id="cb267-5"><a href="#cb267-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-6"><a href="#cb267-6" aria-hidden="true" tabindex="-1"></a>results_hair_pulling_final <span class="ot">&lt;-</span> results_hair_pulling3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_hair_pulling) <span class="sc">%&gt;%</span></span>
<span id="cb267-7"><a href="#cb267-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb267-8"><a href="#cb267-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb267-9"><a href="#cb267-9" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_hair_pulling_final)</span></span>
<span id="cb267-10"><a href="#cb267-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb267-11"><a href="#cb267-11" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_hair_pulling_final, <span class="st">"Data extraction/hair_pulling_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="love-addiction" class="level2">
<h2 class="anchored" data-anchor-id="love-addiction">Love addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-15" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-15">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> There are no MeSH termsunsurprisingly.</p>
<p><strong>Actual search used:</strong> “Love addiction”[Title/Abstract]</p>
<ul>
<li>Not found so removed from search terms: “Love Passion addiction”[Title/Abstract]</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Love+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. The following study is not relevant to include and will be removed when refining the dataset:</p>
<ul>
<li>The sexual response as exercise. A brief review and theoretical proposal</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-12" class="level1">
<h1>Define the search term:</h1>
<p>search_term_love &lt;- ‘“Love addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-15" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_love &lt;- entrez_search(db=“pubmed”, term=search_term_love, retmax=20000) id_list_love &lt;- search_results_love$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-15" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_love, ceiling(seq_along(id_list_love)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-15" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_love &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_love &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_love &lt;- bind_rows(details_love)

return(details_df_love)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-15" class="level1">
<h1>Check the results:</h1>
<p>article_details_love %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-15" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_love &lt;- article_details_love %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-15" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_love, “Data extraction/love_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>url_love_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Love+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 12 results returned on 20/08/2023</span></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>webpage_love_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_love_rvest)</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>results_count_love <span class="ot">&lt;-</span> webpage_love_rvest <span class="sc">%&gt;%</span></span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>results_per_page_love <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>total_pages_love <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_love[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_love)</span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_love and total_pages_love</span></span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_love)</span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_love)</span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb269-29"><a href="#cb269-29" aria-hidden="true" tabindex="-1"></a>results_love_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb269-30"><a href="#cb269-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-31"><a href="#cb269-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb269-32"><a href="#cb269-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_love <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb269-33"><a href="#cb269-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb269-34"><a href="#cb269-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_love_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb269-35"><a href="#cb269-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-36"><a href="#cb269-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb269-37"><a href="#cb269-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb269-38"><a href="#cb269-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-39"><a href="#cb269-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb269-40"><a href="#cb269-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb269-41"><a href="#cb269-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb269-42"><a href="#cb269-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb269-43"><a href="#cb269-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb269-44"><a href="#cb269-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb269-45"><a href="#cb269-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb269-46"><a href="#cb269-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb269-47"><a href="#cb269-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb269-48"><a href="#cb269-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-49"><a href="#cb269-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb269-50"><a href="#cb269-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb269-51"><a href="#cb269-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb269-52"><a href="#cb269-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb269-53"><a href="#cb269-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-54"><a href="#cb269-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb269-55"><a href="#cb269-55" aria-hidden="true" tabindex="-1"></a>  current_results_love <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb269-56"><a href="#cb269-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb269-57"><a href="#cb269-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-58"><a href="#cb269-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb269-59"><a href="#cb269-59" aria-hidden="true" tabindex="-1"></a>  results_love_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_love_rvest, current_results_love)</span>
<span id="cb269-60"><a href="#cb269-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb269-61"><a href="#cb269-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb269-62"><a href="#cb269-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb269-63"><a href="#cb269-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb269-64"><a href="#cb269-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb269-65"><a href="#cb269-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-66"><a href="#cb269-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb269-67"><a href="#cb269-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_love_rvest))</span>
<span id="cb269-68"><a href="#cb269-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-69"><a href="#cb269-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-70"><a href="#cb269-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb269-71"><a href="#cb269-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_love_rvest, <span class="st">"Data extraction/love_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-15" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-15">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>results_love<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/love_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb270-6"><a href="#cb270-6" aria-hidden="true" tabindex="-1"></a>results_love_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/love_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb270-7"><a href="#cb270-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb270-8"><a href="#cb270-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-9"><a href="#cb270-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb270-10"><a href="#cb270-10" aria-hidden="true" tabindex="-1"></a>results_love2 <span class="ot">&lt;-</span> results_love <span class="sc">%&gt;%</span></span>
<span id="cb270-11"><a href="#cb270-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb270-12"><a href="#cb270-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb270-13"><a href="#cb270-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_love_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb270-14"><a href="#cb270-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb270-15"><a href="#cb270-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb270-16"><a href="#cb270-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Love Addic… 3.71e7  2023 &lt;NA&gt;  10.5… "BACKGR… Maglia, Marilen… "DEPARTMENT O…
 2 Love Addic… 3.68e7  2023 Jan   10.3… "Love a… Gori, Alessio; … "Department o…
 3 Concept of… 3.66e7  2022 &lt;NA&gt;  10.2… "BACKGR… Sirvent-Ruiz, C… "Research and…
 4 Jealousy, … 3.48e7  2021 Nov   10.3… "BACKGR… Arbinaga, Felix… "Department o…
 5 Addicted t… 2.84e7  2017 Mar   &lt;NA&gt;  "Recent… Earp, Brian D; … "Uehiro Centr…
 6 Characteri… 2.55e7  2015 Apr   S074… "Relaps… Laudet, Alexand… "Center for t…
 7 Is love pa… 2.05e7  2010 Sep   10.3… "AIMS: … Reynaud, Michel… "Inserm, U, P…
 8 The sexual… 2.19e6  1990 Jun   &lt;NA&gt;  "The se… Butt, D S        "Department o…
 9 The role o… 2.20e6  1990 Apr-… &lt;NA&gt;  "Compre… Young, E B        &lt;NA&gt;         
10 Overcoming… 2.19e6  1990 Apr   &lt;NA&gt;  "Counse… Timmreck, T C    "Department o…
11 Love: addi… 7.17e6  1982 Fall  &lt;NA&gt;  "One as… Simon, J          &lt;NA&gt;         
12 Love: addi… 1.20e6  1975 Wint… &lt;NA&gt;   &lt;NA&gt;    Simon, J          &lt;NA&gt;         
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_love2)</span></span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a>results_love2 <span class="sc">%&gt;%</span></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>results_love2 <span class="sc">%&gt;%</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now remove the irrelevant study:</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>results_love3 <span class="ot">&lt;-</span> results_love2 <span class="sc">%&gt;%</span> </span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">!=</span> <span class="st">"The sexual response as exercise. A brief review and theoretical proposal."</span>)</span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_love3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1975    1990    2015    2006    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>love_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_love3<span class="sc">$</span>Year,</span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Love Addiction (PubMed)"</span>,</span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>results_love3 <span class="sc">%&gt;%</span> </span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 2
   Journal_name_short           n
   &lt;chr&gt;                    &lt;int&gt;
 1 Am J Psychoanal              2
 2 Am J Drug Alcohol Abuse      1
 3 Children (Basel)             1
 4 Health Psychol Res           1
 5 J Pers Med                   1
 6 J Psychoactive Drugs         1
 7 J Subst Abuse Treat          1
 8 Philos Psychiatr Psychol     1
 9 Psychol Rep                  1
10 Psychol Res Behav Manag      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_love3) # Visually inspect results</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the love search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>Label_Love <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"love"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_love3))</span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>results_love_final <span class="ot">&lt;-</span> results_love3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Love) <span class="sc">%&gt;%</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_love_final)</span></span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_love_final, <span class="st">"Data extraction/love_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="selfie-addiction" class="level2">
<h2 class="anchored" data-anchor-id="selfie-addiction">Selfie addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-16" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-16">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The term “selfitis” is included in the title of some studies, the reason it seems like this actually came from a hoax perpetrated by the media who claimed that selfie addiction was a new craze… an now genuine academic research on this has been done!</p>
<p><strong>Actual search used:</strong> “selfie addiction”</p>
<ul>
<li>Including the “[Title/Abstract]” indicator in PubMed did not return any studies, for some reason, so I removed it from the search string.</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22selfie+addiction%22&amp;size=200">link</a></p>
<ul>
<li><p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. The following studies are not relevant to include and will be removed when refining the dataset:</p></li>
<li><p>Selfie-engagement on social media: Pathological narcissism, positive expectation, and body objectification - Which is more influential?</p></li>
<li><p>Association between physiological oscillations in self-esteem, narcissism and internet addiction: A cross-sectional study</p></li>
<li><p>The Influence of Social Media on Addictive Behaviors in College Students</p></li>
<li><p>Social Media Interventions for Risky Drinking Among Adolescents and Emerging Adults: Protocol for a Randomized Controlled Trial</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-13" class="level1">
<h1>Define the search term:</h1>
<p>search_term_selfie &lt;- ‘“selfie addiction”’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-16" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_selfie &lt;- entrez_search(db=“pubmed”, term=search_term_selfie, retmax=20000) id_list_selfie &lt;- search_results_selfie$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-16" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_selfie, ceiling(seq_along(id_list_selfie)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-16" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_selfie &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_selfie &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_selfie &lt;- bind_rows(details_selfie)

return(details_df_selfie)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-16" class="level1">
<h1>Check the results:</h1>
<p>article_details_selfie %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-16" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_selfie &lt;- article_details_selfie %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-16" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_selfie, “Data extraction/selfie_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb283-3"><a href="#cb283-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-4"><a href="#cb283-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb283-5"><a href="#cb283-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-6"><a href="#cb283-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb283-7"><a href="#cb283-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb283-8"><a href="#cb283-8" aria-hidden="true" tabindex="-1"></a>url_selfie_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22selfie+addiction%22&amp;size=200"</span> <span class="co"># 13 results returned on 20/08/2023</span></span>
<span id="cb283-9"><a href="#cb283-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-10"><a href="#cb283-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb283-11"><a href="#cb283-11" aria-hidden="true" tabindex="-1"></a>webpage_selfie_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_selfie_rvest)</span>
<span id="cb283-12"><a href="#cb283-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-13"><a href="#cb283-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb283-14"><a href="#cb283-14" aria-hidden="true" tabindex="-1"></a>results_count_selfie <span class="ot">&lt;-</span> webpage_selfie_rvest <span class="sc">%&gt;%</span></span>
<span id="cb283-15"><a href="#cb283-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb283-16"><a href="#cb283-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb283-17"><a href="#cb283-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb283-18"><a href="#cb283-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb283-19"><a href="#cb283-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-20"><a href="#cb283-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb283-21"><a href="#cb283-21" aria-hidden="true" tabindex="-1"></a>results_per_page_selfie <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb283-22"><a href="#cb283-22" aria-hidden="true" tabindex="-1"></a>total_pages_selfie <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_selfie[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_selfie)</span>
<span id="cb283-23"><a href="#cb283-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_selfie and total_pages_selfie</span></span>
<span id="cb283-24"><a href="#cb283-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_selfie)</span>
<span id="cb283-25"><a href="#cb283-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_selfie)</span>
<span id="cb283-26"><a href="#cb283-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-27"><a href="#cb283-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-28"><a href="#cb283-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb283-29"><a href="#cb283-29" aria-hidden="true" tabindex="-1"></a>results_selfie_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb283-30"><a href="#cb283-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-31"><a href="#cb283-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb283-32"><a href="#cb283-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_selfie <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb283-33"><a href="#cb283-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb283-34"><a href="#cb283-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_selfie_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb283-35"><a href="#cb283-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-36"><a href="#cb283-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb283-37"><a href="#cb283-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb283-38"><a href="#cb283-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-39"><a href="#cb283-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb283-40"><a href="#cb283-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb283-41"><a href="#cb283-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb283-42"><a href="#cb283-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb283-43"><a href="#cb283-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb283-44"><a href="#cb283-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb283-45"><a href="#cb283-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb283-46"><a href="#cb283-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb283-47"><a href="#cb283-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb283-48"><a href="#cb283-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-49"><a href="#cb283-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb283-50"><a href="#cb283-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb283-51"><a href="#cb283-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb283-52"><a href="#cb283-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb283-53"><a href="#cb283-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-54"><a href="#cb283-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb283-55"><a href="#cb283-55" aria-hidden="true" tabindex="-1"></a>  current_results_selfie <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb283-56"><a href="#cb283-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb283-57"><a href="#cb283-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-58"><a href="#cb283-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb283-59"><a href="#cb283-59" aria-hidden="true" tabindex="-1"></a>  results_selfie_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_selfie_rvest, current_results_selfie)</span>
<span id="cb283-60"><a href="#cb283-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb283-61"><a href="#cb283-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb283-62"><a href="#cb283-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb283-63"><a href="#cb283-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb283-64"><a href="#cb283-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb283-65"><a href="#cb283-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-66"><a href="#cb283-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb283-67"><a href="#cb283-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_selfie_rvest))</span>
<span id="cb283-68"><a href="#cb283-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-69"><a href="#cb283-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb283-70"><a href="#cb283-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb283-71"><a href="#cb283-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_selfie_rvest, <span class="st">"Data extraction/selfie_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-16" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-16">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>results_selfie<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/selfie_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a>results_selfie_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/selfie_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a>results_selfie2 <span class="ot">&lt;-</span> results_selfie <span class="sc">%&gt;%</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_selfie_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 "Patient F… 3.71e7  2023 Apr   10.2… "BACKGR… Smith, Crystal … "Department o…
 2 "Selfitis … 3.28e7  2020 Aug   10.3… "Resear… Monacis, Lucia;… "Department o…
 3 "'Selfie'-… 3.26e7  2020 Jun   10.1… "BACKGR… Spoorthi, V; Ho… "Kasturba Med…
 4 "Use of In… 3.25e7  2020 Jun   10.3… "It is … Romero-Rodrigue… "Department o…
 5 "Selfie ad… 3.25e7  2021 Jan   10.1… "OBJECT… El Khoueiry, Ch… "Drug Informa…
 6 "Selfie-en… 3.25e7  2020 Jun   10.1… "The cu… Boursier, Valen… "Department o…
 7 "Social Me… 3.24e7  2020 May   10.2… "BACKGR… Bonar, Erin E; … "Department o…
 8 "An Explor… 2.99e7  2018 &lt;NA&gt;  10.1… "In 201… Balakrishnan, J… "Thiagarajar …
 9 "Selfitis,… 2.96e7  2018 May   10.1…  &lt;NA&gt;    Starcevic, Vlad… "1 Sydney Med…
10 "Associati… 2.88e7  2017 Dec   S016… "Intern… Pantic, Igor; M… "University o…
11 "The Influ… 2.85e7  2016 Dec   10.1… "Social… Steers, Mai-Ly … "University o…
12 "Smartphon… 2.76e7  2016 Sep   10.1… "Backgr… Kormendi, Attil… "1 Department…
13 "Attitudes… 2.73e7  2016 May-… 10.4… "BACKGR… Dutta, Era; Sha… "Department o…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_selfie2)</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>results_selfie2 <span class="sc">%&gt;%</span></span>
<span id="cb286-6"><a href="#cb286-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb286-7"><a href="#cb286-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb286-8"><a href="#cb286-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>results_selfie2 <span class="sc">%&gt;%</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now remove the irrelevant studies:</span></span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>results_selfie3 <span class="ot">&lt;-</span>  results_selfie2 <span class="sc">%&gt;%</span> </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="st">"Selfie-engagement on social media: Pathological narcissism, positive expectation, and body objectification - Which is more influential?"</span>,</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a><span class="st">"Association between physiological oscillations in self-esteem, narcissism and internet addiction: A cross-sectional study."</span>,</span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="st">"The Influence of Social Media on Addictive Behaviors in College Students."</span>,</span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a><span class="st">"Social Media Interventions for Risky Drinking Among Adolescents and Emerging Adults: Protocol for a Randomized Controlled Trial."</span></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a>  )))</span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_selfie3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2016    2018    2020    2019    2020    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>selfie_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_selfie3<span class="sc">$</span>Year,</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb292-4"><a href="#cb292-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb292-5"><a href="#cb292-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Selfie Addiction (PubMed)"</span>,</span>
<span id="cb292-6"><a href="#cb292-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>results_selfie3 <span class="sc">%&gt;%</span> </span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
  Journal_name_short                  n
  &lt;chr&gt;                           &lt;int&gt;
1 Int J Environ Res Public Health     2
2 Aust N Z J Psychiatry               1
3 Indian J Psychol Med                1
4 Int J Adolesc Med Health            1
5 Int J Ment Health Addict            1
6 J Behav Addict                      1
7 JMIR Form Res                       1
8 Perspect Psychiatr Care             1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_selfie2) # Visually inspect results</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the selfie search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>Label_Selfie <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"selfie"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_selfie3))</span>
<span id="cb295-5"><a href="#cb295-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-6"><a href="#cb295-6" aria-hidden="true" tabindex="-1"></a>results_selfie_final <span class="ot">&lt;-</span> results_selfie3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Selfie) <span class="sc">%&gt;%</span></span>
<span id="cb295-7"><a href="#cb295-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb295-8"><a href="#cb295-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb295-9"><a href="#cb295-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb295-10"><a href="#cb295-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_selfie_final)</span></span>
<span id="cb295-11"><a href="#cb295-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb295-12"><a href="#cb295-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_selfie_final, <span class="st">"Data extraction/selfie_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="extreme-sport-addiction" class="level2">
<h2 class="anchored" data-anchor-id="extreme-sport-addiction">Extreme sport addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-17" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-17">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. Used my own knowledge of this research area to develop the range of terms, most of which were ultimately removed for a simple search strategy brackets see below).</p>
<p><strong>Actual search used:</strong> “extreme sports addiction” OR “Adventure sports addiction”</p>
<ul>
<li>My original search strategy was extensive and complex, but PubMed did not seem to like it at all and so I opted to simplify it to the above selection and then manually search the outcomes: (((((((((((“extreme sports addiction”[Title/Abstract]) OR (“addicted to extreme sports”[Title/Abstract])) OR (“addiction to extreme sports”[Title/Abstract])) OR (“adventure sports addiction”[Title/Abstract])) OR (“addicted to adventure sports”[Title/Abstract])) OR (“addiction to adventure sports”[Title/Abstract])) OR (“skydiving addiction”[Title/Abstract])) OR (“addicted to skydiving”[Title/Abstract])) OR (“addiction to skydiving”[Title/Abstract])) OR (“rock climbing addiction”[Title/Abstract])) OR (“addicted to rock climbing”[Title/Abstract])) OR (“addiction to rock climbing”[Title/Abstract])</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%E2%80%9Cextreme+sports+addiction%E2%80%9D+OR+%E2%80%9CAdventure+sports+addiction%E2%80%9D+&amp;size=200">link</a></p>
<ul>
<li><p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. The following studies are relevant to include and will be isolated when refining the dataset:</p></li>
<li><p>“Addiction in Extreme Sports: An Exploration of Withdrawal States in Rock Climbers.”,</p></li>
<li><p>“Commentary on: Addiction in extreme sports: An exploration of withdrawal states in rock climbers.”,</p></li>
<li><p>“[Social-psychological characteristics of different types addictive behavior].”,</p></li>
<li><p>“Why do we climb mountains? An exploration of features of behavioural addiction in mountaineering and the association with stress-related psychiatric disorders.”,</p></li>
<li><p>“Response to "Nature fix: Addiction to outdoor activities"R. C. Buckley’s commentary on Heirene, R. M., Shearer, D., Roderique-Davies, G., &amp; Mellalieu, S. D. (2016). Addiction in extreme sports: An exploration of withdrawal states in rock climbers. Journal of Behavioral Addictions, 5, 332-341.”,</p></li>
<li><p>“Adventure Thrills are Addictive.”,</p></li>
<li><p>“Development and Initial Validation of a Rock Climbing Craving Questionnaire (RCCQ).” ))</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-14" class="level1">
<h1>Define the search term:</h1>
<p>search_term_extreme_sport &lt;- ‘“extreme sports addiction” OR “Adventure sports addiction”’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-17" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_extreme_sport &lt;- entrez_search(db=“pubmed”, term=search_term_extreme_sport, retmax=20000) id_list_extreme_sport &lt;- search_results_extreme_sport$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-17" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_extreme_sport, ceiling(seq_along(id_list_extreme_sport)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-17" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_extreme_sport &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_extreme_sport &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_extreme_sport &lt;- bind_rows(details_extreme_sport)

return(details_df_extreme_sport)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-17" class="level1">
<h1>Check the results:</h1>
<p>article_details_extreme_sport %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-17" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_extreme_sport &lt;- article_details_extreme_sport %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-17" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_extreme_sport, “Data extraction/extreme_sport_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-6"><a href="#cb297-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb297-7"><a href="#cb297-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb297-8"><a href="#cb297-8" aria-hidden="true" tabindex="-1"></a>url_extreme_sport_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%E2%80%9Cextreme+sports+addiction%E2%80%9D+OR+%E2%80%9CAdventure+sports+addiction%E2%80%9D+&amp;size=200"</span> <span class="co"># 50 results returned on 20/08/2023</span></span>
<span id="cb297-9"><a href="#cb297-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-10"><a href="#cb297-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb297-11"><a href="#cb297-11" aria-hidden="true" tabindex="-1"></a>webpage_extreme_sport_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_extreme_sport_rvest)</span>
<span id="cb297-12"><a href="#cb297-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-13"><a href="#cb297-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb297-14"><a href="#cb297-14" aria-hidden="true" tabindex="-1"></a>results_count_extreme_sport <span class="ot">&lt;-</span> webpage_extreme_sport_rvest <span class="sc">%&gt;%</span></span>
<span id="cb297-15"><a href="#cb297-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb297-16"><a href="#cb297-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb297-17"><a href="#cb297-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb297-18"><a href="#cb297-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb297-19"><a href="#cb297-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-20"><a href="#cb297-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb297-21"><a href="#cb297-21" aria-hidden="true" tabindex="-1"></a>results_per_page_extreme_sport <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb297-22"><a href="#cb297-22" aria-hidden="true" tabindex="-1"></a>total_pages_extreme_sport <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_extreme_sport[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_extreme_sport)</span>
<span id="cb297-23"><a href="#cb297-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_extreme_sport and total_pages_extreme_sport</span></span>
<span id="cb297-24"><a href="#cb297-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_extreme_sport)</span>
<span id="cb297-25"><a href="#cb297-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_extreme_sport)</span>
<span id="cb297-26"><a href="#cb297-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-27"><a href="#cb297-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-28"><a href="#cb297-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb297-29"><a href="#cb297-29" aria-hidden="true" tabindex="-1"></a>results_extreme_sport_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb297-30"><a href="#cb297-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-31"><a href="#cb297-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb297-32"><a href="#cb297-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_extreme_sport <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb297-33"><a href="#cb297-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb297-34"><a href="#cb297-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_extreme_sport_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb297-35"><a href="#cb297-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-36"><a href="#cb297-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb297-37"><a href="#cb297-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb297-38"><a href="#cb297-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-39"><a href="#cb297-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb297-40"><a href="#cb297-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb297-41"><a href="#cb297-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb297-42"><a href="#cb297-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb297-43"><a href="#cb297-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb297-44"><a href="#cb297-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb297-45"><a href="#cb297-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb297-46"><a href="#cb297-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb297-47"><a href="#cb297-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb297-48"><a href="#cb297-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-49"><a href="#cb297-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb297-50"><a href="#cb297-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb297-51"><a href="#cb297-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb297-52"><a href="#cb297-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb297-53"><a href="#cb297-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-54"><a href="#cb297-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb297-55"><a href="#cb297-55" aria-hidden="true" tabindex="-1"></a>  current_results_extreme_sport <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb297-56"><a href="#cb297-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb297-57"><a href="#cb297-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-58"><a href="#cb297-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb297-59"><a href="#cb297-59" aria-hidden="true" tabindex="-1"></a>  results_extreme_sport_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_extreme_sport_rvest, current_results_extreme_sport)</span>
<span id="cb297-60"><a href="#cb297-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb297-61"><a href="#cb297-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb297-62"><a href="#cb297-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb297-63"><a href="#cb297-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb297-64"><a href="#cb297-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb297-65"><a href="#cb297-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-66"><a href="#cb297-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb297-67"><a href="#cb297-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_extreme_sport_rvest))</span>
<span id="cb297-68"><a href="#cb297-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-69"><a href="#cb297-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb297-70"><a href="#cb297-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb297-71"><a href="#cb297-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_extreme_sport_rvest, <span class="st">"Data extraction/extreme_sport_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-17" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-17">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>results_extreme_sport<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/extreme_sport_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>results_extreme_sport_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/extreme_sport_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb298-8"><a href="#cb298-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb298-9"><a href="#cb298-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb298-10"><a href="#cb298-10" aria-hidden="true" tabindex="-1"></a>results_extreme_sport2 <span class="ot">&lt;-</span> results_extreme_sport <span class="sc">%&gt;%</span></span>
<span id="cb298-11"><a href="#cb298-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb298-12"><a href="#cb298-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb298-13"><a href="#cb298-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_extreme_sport_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb298-14"><a href="#cb298-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb298-15"><a href="#cb298-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb298-16"><a href="#cb298-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 50 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 "Long-Term… 3.74e7  2023 Jun   10.3… "As tim… Gili, Alessio; … "Hygiene and …
 2 "[Compulsi… 3.69e7  2023 Mar   D682… "Anorex… Snijders, Frans… "GGZ Rivierdu…
 3 "A novel n… 3.64e7  2022 Nov   10.1… "BACKGR… Li, Yue; Long, … "Department o…
 4 "\"No Risk… 3.63e7  2022 Oct   10.3… "(1) Ba… Krokosz, Daniel… "Departament …
 5 "Developme… 3.61e7  2022 Sep   10.1… "BACKGR… Perrot, Bastien… "1Nantes Univ…
 6 "Why do we… 3.60e7  2023 Apr   10.1… "Common… Habelt, Leonie;… "Department o…
 7 "New Insig… 3.59e7  2022 &lt;NA&gt;  10.3… "While … Bailly, Melina;… "Universite C…
 8 "Assessmen… 3.57e7  2022 Aug   10.1… "IMPORT… Tseng, Ping-Tao… "Department o…
 9 "Emotion-d… 3.52e7  2022 Jan-… 10.1… "Impuls… Willie, Christo… "Institute fo…
10 "Jealousy,… 3.48e7  2021 Nov   10.3… "BACKGR… Arbinaga, Felix… "Department o…
# ℹ 40 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_extreme_sport2)</span></span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb300-5"><a href="#cb300-5" aria-hidden="true" tabindex="-1"></a>results_extreme_sport2 <span class="sc">%&gt;%</span></span>
<span id="cb300-6"><a href="#cb300-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb300-7"><a href="#cb300-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb300-8"><a href="#cb300-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 dupes (August 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>results_extreme_sport2 <span class="sc">%&gt;%</span></span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now isolate the relevant studies:</span></span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a>results_extreme_sport3 <span class="ot">&lt;-</span>  results_extreme_sport2 <span class="sc">%&gt;%</span> </span>
<span id="cb304-3"><a href="#cb304-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb304-4"><a href="#cb304-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Addiction in Extreme Sports: An Exploration of Withdrawal States in Rock Climbers."</span>,</span>
<span id="cb304-5"><a href="#cb304-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Commentary on: Addiction in extreme sports: An exploration of withdrawal states in rock climbers."</span>,</span>
<span id="cb304-6"><a href="#cb304-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"[Social-psychological characteristics of different types addictive behavior]."</span>,</span>
<span id="cb304-7"><a href="#cb304-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Why do we climb mountains? An exploration of features of behavioural addiction in mountaineering and the association with stress-related psychiatric disorders."</span>,</span>
<span id="cb304-8"><a href="#cb304-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Response to </span><span class="sc">\"</span><span class="st">Nature fix: Addiction to outdoor activities</span><span class="sc">\"</span><span class="st">R. C. Buckley's commentary on Heirene, R. M., Shearer, D., Roderique-Davies, G., &amp; Mellalieu, S. D. (2016). Addiction in extreme sports: An exploration of withdrawal states in rock climbers. Journal of Behavioral Addictions, 5, 332-341."</span>,</span>
<span id="cb304-9"><a href="#cb304-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Adventure Thrills are Addictive."</span>,</span>
<span id="cb304-10"><a href="#cb304-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Development and Initial Validation of a Rock Climbing Craving Questionnaire (RCCQ)."</span></span>
<span id="cb304-11"><a href="#cb304-11" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb304-12"><a href="#cb304-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-13"><a href="#cb304-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb304-14"><a href="#cb304-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb304-15"><a href="#cb304-15" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_extreme_sport3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2015    2016    2016    2018    2018    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a>extreme_sport_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_extreme_sport3<span class="sc">$</span>Year,</span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Extreme Sport Addiction (PubMed)"</span>,</span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>results_extreme_sport3 <span class="sc">%&gt;%</span> </span>
<span id="cb307-3"><a href="#cb307-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb307-4"><a href="#cb307-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb307-5"><a href="#cb307-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb307-6"><a href="#cb307-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb307-7"><a href="#cb307-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb307-8"><a href="#cb307-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  Journal_name_short                       n
  &lt;chr&gt;                                &lt;int&gt;
1 J Behav Addict                           3
2 Front Psychol                            2
3 Eur Arch Psychiatry Clin Neurosci        1
4 Zh Nevrol Psikhiatr Im S S Korsakova     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_extreme_sport2) # Visually inspect results</span></span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the extreme_sport search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a>Label_Extreme_sport <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"extreme_sport"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_extreme_sport3))</span>
<span id="cb309-5"><a href="#cb309-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-6"><a href="#cb309-6" aria-hidden="true" tabindex="-1"></a>results_extreme_sport_final <span class="ot">&lt;-</span> results_extreme_sport3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Extreme_sport) <span class="sc">%&gt;%</span></span>
<span id="cb309-7"><a href="#cb309-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb309-8"><a href="#cb309-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb309-9"><a href="#cb309-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-10"><a href="#cb309-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_extreme_sport_final)</span></span>
<span id="cb309-11"><a href="#cb309-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb309-12"><a href="#cb309-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_extreme_sport_final, <span class="st">"Data extraction/extreme_sport_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="running-addiction" class="level2">
<h2 class="anchored" data-anchor-id="running-addiction">Running addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-18" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-18">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “running addiction” seems to be most commonly used.</p>
<p><strong>Actual search used:</strong> “Running addiction”[Title/Abstract]</p>
<ul>
<li>Removed as it did not return any results: “addiction to running”[Title/Abstract]</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Running+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<ul>
<li><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. As far as I can see, all studies appeared relevant as of latest search date (see top of document).</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-15" class="level1">
<h1>Define the search term:</h1>
<p>search_term_running &lt;- ‘“Running addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-18" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_running &lt;- entrez_search(db=“pubmed”, term=search_term_running, retmax=20000) id_list_running &lt;- search_results_running$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-18" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_running, ceiling(seq_along(id_list_running)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-18" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_running &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_running &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_running &lt;- bind_rows(details_running)

return(details_df_running)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-18" class="level1">
<h1>Check the results:</h1>
<p>article_details_running %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-18" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_running &lt;- article_details_running %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-18" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_running, “Data extraction/running_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a>url_running_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Running+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 11 results returned on 20/08/2023</span></span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a>webpage_running_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_running_rvest)</span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>results_count_running <span class="ot">&lt;-</span> webpage_running_rvest <span class="sc">%&gt;%</span></span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>results_per_page_running <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb311-22"><a href="#cb311-22" aria-hidden="true" tabindex="-1"></a>total_pages_running <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_running[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_running)</span>
<span id="cb311-23"><a href="#cb311-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_running and total_pages_running</span></span>
<span id="cb311-24"><a href="#cb311-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_running)</span>
<span id="cb311-25"><a href="#cb311-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_running)</span>
<span id="cb311-26"><a href="#cb311-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-27"><a href="#cb311-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-28"><a href="#cb311-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb311-29"><a href="#cb311-29" aria-hidden="true" tabindex="-1"></a>results_running_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb311-30"><a href="#cb311-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-31"><a href="#cb311-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb311-32"><a href="#cb311-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_running <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb311-33"><a href="#cb311-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb311-34"><a href="#cb311-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_running_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb311-35"><a href="#cb311-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb311-36"><a href="#cb311-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb311-37"><a href="#cb311-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb311-38"><a href="#cb311-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb311-39"><a href="#cb311-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb311-40"><a href="#cb311-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb311-41"><a href="#cb311-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb311-42"><a href="#cb311-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-43"><a href="#cb311-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb311-44"><a href="#cb311-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb311-45"><a href="#cb311-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb311-46"><a href="#cb311-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb311-47"><a href="#cb311-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb311-48"><a href="#cb311-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb311-49"><a href="#cb311-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb311-50"><a href="#cb311-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb311-51"><a href="#cb311-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb311-52"><a href="#cb311-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb311-53"><a href="#cb311-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb311-54"><a href="#cb311-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb311-55"><a href="#cb311-55" aria-hidden="true" tabindex="-1"></a>  current_results_running <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb311-56"><a href="#cb311-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb311-57"><a href="#cb311-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb311-58"><a href="#cb311-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb311-59"><a href="#cb311-59" aria-hidden="true" tabindex="-1"></a>  results_running_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_running_rvest, current_results_running)</span>
<span id="cb311-60"><a href="#cb311-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb311-61"><a href="#cb311-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb311-62"><a href="#cb311-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb311-63"><a href="#cb311-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb311-64"><a href="#cb311-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb311-65"><a href="#cb311-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-66"><a href="#cb311-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb311-67"><a href="#cb311-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_running_rvest))</span>
<span id="cb311-68"><a href="#cb311-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-69"><a href="#cb311-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-70"><a href="#cb311-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb311-71"><a href="#cb311-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_running_rvest, <span class="st">"Data extraction/running_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-18" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-18">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>results_running<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/running_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a>results_running_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/running_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a>results_running2 <span class="ot">&lt;-</span> results_running <span class="sc">%&gt;%</span></span>
<span id="cb312-11"><a href="#cb312-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb312-12"><a href="#cb312-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb312-13"><a href="#cb312-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_running_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb312-14"><a href="#cb312-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb312-15"><a href="#cb312-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb312-16"><a href="#cb312-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 Running ad… 3.64e7  2023 Mar   10.2… "BACKGR… Zivcic Tomic, D… "Department f…
 2 Relationsh… 3.50e7  2021 Dec   10.3… "Curren… Monserrat Herna… "Faculty of H…
 3 Amateur Ru… 3.20e7  2020 Feb   10.3… "The ai… Parra-Camacho, … "Department o…
 4 Psychometr… 2.21e7  2011 Nov   &lt;NA&gt;  "Despit… Zarauz Sancho, … "Universidad …
 5 Motives fo… 1.20e7  2002 Jun   &lt;NA&gt;  "BACKGR… Hamer, M; Karag… "Physical Act…
 6 The relati… 8.85e6  1996 Oct   &lt;NA&gt;  "The pu… Estok, P J; Rud… "School of Nu…
 7 The impact… 8.60e6  1995 Sep   &lt;NA&gt;  "The li… Szabo, A         "Department o…
 8 Running ad… 1.87e6  1991 Jul   &lt;NA&gt;   &lt;NA&gt;    Salmon, P         &lt;NA&gt;         
 9 Running ad… 2.27e6  1990 Sep   &lt;NA&gt;  "Runner… Chapman, C L; D… "Department o…
10 Running ad… 2.37e6  1990 Aug   &lt;NA&gt;  "Runnin… Rudy, E B; Esto… "Frances Payn…
11 Marathon r… 3.65e6  1987 Apr   &lt;NA&gt;  "Physic… Estok, P J; Rud…  &lt;NA&gt;         
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_running2)</span></span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>results_running2 <span class="sc">%&gt;%</span></span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 1 dupes: This is to studies of the title "running addiction" which are clearly distinct (different year, author, and journal)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>results_running2 <span class="sc">%&gt;%</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb316-5"><a href="#cb316-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_running2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1987    1990    1996    2002    2016    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a>running_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_running2<span class="sc">$</span>Year,</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">15</span>,</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Running Addiction (PubMed)"</span>,</span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a>results_running2 <span class="sc">%&gt;%</span> </span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb321-6"><a href="#cb321-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb321-7"><a href="#cb321-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb321-8"><a href="#cb321-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 2
  Journal_name_short                  n
  &lt;chr&gt;                           &lt;int&gt;
1 J Sports Med Phys Fitness           3
2 Res Nurs Health                     3
3 Aust J Sci Med Sport                1
4 Br J Hosp Med                       1
5 Int J Environ Res Public Health     1
6 Nutrients                           1
7 Span J Psychol                      1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_running2) # Visually inspect results</span></span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the running search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a>Label_Running <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"running"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_running2))</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>results_running_final <span class="ot">&lt;-</span> results_running2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_Running) <span class="sc">%&gt;%</span></span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_running_final)</span></span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_running_final, <span class="st">"Data extraction/running_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dance-addiction" class="level2">
<h2 class="anchored" data-anchor-id="dance-addiction">Dance addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-19" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-19">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “dance addiction” seems to be most commonly used. Adding in the [Title/Abstract] filter resulted in no results and so it was removed.</p>
<p><strong>Actual search used:</strong> “dance addiction”</p>
<ul>
<li>Removed as it did not return any results: “Dancing addiction” OR “addiction to dancing”</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22dance+addiction%22+&amp;size=200">link</a></p>
<ul>
<li><p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. Only the following studies appeared relevant and will be isolated when refining the dataset:</p></li>
<li><p>An empirical investigation of dance addiction</p></li>
<li><p>Argentine tango: Another behavioral addiction?</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-16" class="level1">
<h1>Define the search term:</h1>
<p>search_term_dance &lt;- ‘“dance addiction”’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-19" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_dance &lt;- entrez_search(db=“pubmed”, term=search_term_dance, retmax=20000) id_list_dance &lt;- search_results_dance$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-19" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_dance, ceiling(seq_along(id_list_dance)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-19" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_dance &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_dance &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_dance &lt;- bind_rows(details_dance)

return(details_df_dance)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-19" class="level1">
<h1>Check the results:</h1>
<p>article_details_dance %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-19" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_dance &lt;- article_details_dance %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-19" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_dance, “Data extraction/dance_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb325-5"><a href="#cb325-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-6"><a href="#cb325-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb325-7"><a href="#cb325-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb325-8"><a href="#cb325-8" aria-hidden="true" tabindex="-1"></a>url_dance_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22dance+addiction%22+&amp;size=200"</span> <span class="co"># 103 results returned on 20/08/2023</span></span>
<span id="cb325-9"><a href="#cb325-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-10"><a href="#cb325-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb325-11"><a href="#cb325-11" aria-hidden="true" tabindex="-1"></a>webpage_dance_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_dance_rvest)</span>
<span id="cb325-12"><a href="#cb325-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-13"><a href="#cb325-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb325-14"><a href="#cb325-14" aria-hidden="true" tabindex="-1"></a>results_count_dance <span class="ot">&lt;-</span> webpage_dance_rvest <span class="sc">%&gt;%</span></span>
<span id="cb325-15"><a href="#cb325-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb325-16"><a href="#cb325-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb325-17"><a href="#cb325-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb325-18"><a href="#cb325-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb325-19"><a href="#cb325-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-20"><a href="#cb325-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb325-21"><a href="#cb325-21" aria-hidden="true" tabindex="-1"></a>results_per_page_dance <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb325-22"><a href="#cb325-22" aria-hidden="true" tabindex="-1"></a>total_pages_dance <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_dance[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_dance)</span>
<span id="cb325-23"><a href="#cb325-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_dance and total_pages_dance</span></span>
<span id="cb325-24"><a href="#cb325-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_dance)</span>
<span id="cb325-25"><a href="#cb325-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_dance)</span>
<span id="cb325-26"><a href="#cb325-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-27"><a href="#cb325-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-28"><a href="#cb325-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb325-29"><a href="#cb325-29" aria-hidden="true" tabindex="-1"></a>results_dance_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb325-30"><a href="#cb325-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-31"><a href="#cb325-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb325-32"><a href="#cb325-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_dance <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb325-33"><a href="#cb325-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb325-34"><a href="#cb325-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_dance_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb325-35"><a href="#cb325-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-36"><a href="#cb325-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb325-37"><a href="#cb325-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb325-38"><a href="#cb325-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-39"><a href="#cb325-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb325-40"><a href="#cb325-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb325-41"><a href="#cb325-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb325-42"><a href="#cb325-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb325-43"><a href="#cb325-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb325-44"><a href="#cb325-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb325-45"><a href="#cb325-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb325-46"><a href="#cb325-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb325-47"><a href="#cb325-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb325-48"><a href="#cb325-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-49"><a href="#cb325-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb325-50"><a href="#cb325-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb325-51"><a href="#cb325-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb325-52"><a href="#cb325-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb325-53"><a href="#cb325-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-54"><a href="#cb325-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb325-55"><a href="#cb325-55" aria-hidden="true" tabindex="-1"></a>  current_results_dance <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb325-56"><a href="#cb325-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb325-57"><a href="#cb325-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-58"><a href="#cb325-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb325-59"><a href="#cb325-59" aria-hidden="true" tabindex="-1"></a>  results_dance_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_dance_rvest, current_results_dance)</span>
<span id="cb325-60"><a href="#cb325-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb325-61"><a href="#cb325-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb325-62"><a href="#cb325-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb325-63"><a href="#cb325-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb325-64"><a href="#cb325-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb325-65"><a href="#cb325-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-66"><a href="#cb325-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb325-67"><a href="#cb325-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_dance_rvest))</span>
<span id="cb325-68"><a href="#cb325-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-69"><a href="#cb325-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb325-70"><a href="#cb325-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb325-71"><a href="#cb325-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_dance_rvest, <span class="st">"Data extraction/dance_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-19" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-19">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a>results_dance<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/dance_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>results_dance_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/dance_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>results_dance2 <span class="ot">&lt;-</span> results_dance <span class="sc">%&gt;%</span></span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_dance_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 103 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 "Effective… 3.73e7  2023 &lt;NA&gt;  10.3… "INTROD… Abbing, Annemar… "Department o…
 2 "Substance… 3.68e7  2023 Jan   10.3… "EDM ev… Van Dyck, Edith… "Institute fo…
 3 "No Good T… 3.64e7  2022 &lt;NA&gt;  10.3… "INTROD… Kirtadze, I; Mg… "Ilia State U…
 4 "Intervent… 3.62e7  2022 &lt;NA&gt;  10.3… "INTROD… Mathisen, There… "Department o…
 5 "Connectin… 3.59e7  2022 Sep   10.1… "Indivi… Hill, Kimberley… "Psychology a…
 6 "Aggressiv… 3.53e7  2022 Apr   S138… "BACKGR… Cavallotti, Sim… "Department o…
 7 "The Relat… 3.52e7  2022 &lt;NA&gt;  10.3… "This s… Guo, Ke-Lei; Ma… "School of Ph…
 8 "Commentar… 3.51e7  2021 Dec   10.1…  &lt;NA&gt;    Soklaridis, Sop… "S. Soklaridi…
 9 "Conscious… 3.43e7  2021 Aug   S174… "BACKGR… Laird, Kelsey T… "Department o…
10 "Algorithm… 3.42e7  2021 &lt;NA&gt;  10.2… "PURPOS… Zhang, Lirong; … "Department o…
# ℹ 93 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_dance2)</span></span>
<span id="cb328-3"><a href="#cb328-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb328-4"><a href="#cb328-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb328-5"><a href="#cb328-5" aria-hidden="true" tabindex="-1"></a>results_dance2 <span class="sc">%&gt;%</span></span>
<span id="cb328-6"><a href="#cb328-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb328-7"><a href="#cb328-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb328-8"><a href="#cb328-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 1 dupes: This is to studies of the title "dance addiction" which are clearly distinct (different year, author, and journal)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>results_dance2 <span class="sc">%&gt;%</span></span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   103</code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now isolate the relevant studies:</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>results_dance3 <span class="ot">&lt;-</span>  results_dance2 <span class="sc">%&gt;%</span> </span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"An empirical investigation of dance addiction."</span>,</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Argentine tango: Another behavioral addiction?"</span></span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_dance3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2013    2014    2014    2014    2014    2015 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>dance_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_dance3<span class="sc">$</span>Year,</span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">2</span>,</span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on dance Addiction (PubMed)"</span>,</span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>results_dance3 <span class="sc">%&gt;%</span> </span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Journal_name_short     n
  &lt;chr&gt;              &lt;int&gt;
1 J Behav Addict         1
2 PLoS One               1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_dance2) # Visually inspect results</span></span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the dance search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>Label_dance <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"dance"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_dance3))</span>
<span id="cb337-5"><a href="#cb337-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-6"><a href="#cb337-6" aria-hidden="true" tabindex="-1"></a>results_dance_final <span class="ot">&lt;-</span> results_dance3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_dance) <span class="sc">%&gt;%</span></span>
<span id="cb337-7"><a href="#cb337-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb337-8"><a href="#cb337-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb337-9"><a href="#cb337-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb337-10"><a href="#cb337-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_dance_final)</span></span>
<span id="cb337-11"><a href="#cb337-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb337-12"><a href="#cb337-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_dance_final, <span class="st">"Data extraction/dance_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="joy-riding-addiction" class="level2">
<h2 class="anchored" data-anchor-id="joy-riding-addiction">Joy riding addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-20" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-20">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “joy riding addiction” seems to be used in the literature. Adding in the [Title/Abstract] filter resulted in no results and so it was removed.</p>
<p><strong>Actual search used:</strong> “joy riding addiction”</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22joy+riding+addiction%22&amp;size=200">link</a></p>
<ul>
<li><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. Only two studies are returned and they both appear relevant</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-17" class="level1">
<h1>Define the search term:</h1>
<p>search_term_joyriding &lt;- ‘“joy riding addiction”’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-20" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_joyriding &lt;- entrez_search(db=“pubmed”, term=search_term_joyriding, retmax=20000) id_list_joyriding &lt;- search_results_joyriding$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-20" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_joyriding, ceiling(seq_along(id_list_joyriding)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-20" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_joyriding &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_joyriding &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_joyriding &lt;- bind_rows(details_joyriding)

return(details_df_joyriding)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-20" class="level1">
<h1>Check the results:</h1>
<p>article_details_joyriding %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-20" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_joyriding &lt;- article_details_joyriding %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-20" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_joyriding, “Data extraction/joyriding_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>url_joyriding_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22joy+riding+addiction%22&amp;size=200"</span> <span class="co"># 2 results returned on 20/08/2023</span></span>
<span id="cb339-9"><a href="#cb339-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-10"><a href="#cb339-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb339-11"><a href="#cb339-11" aria-hidden="true" tabindex="-1"></a>webpage_joyriding_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_joyriding_rvest)</span>
<span id="cb339-12"><a href="#cb339-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-13"><a href="#cb339-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb339-14"><a href="#cb339-14" aria-hidden="true" tabindex="-1"></a>results_count_joyriding <span class="ot">&lt;-</span> webpage_joyriding_rvest <span class="sc">%&gt;%</span></span>
<span id="cb339-15"><a href="#cb339-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-16"><a href="#cb339-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb339-17"><a href="#cb339-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-18"><a href="#cb339-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb339-19"><a href="#cb339-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-20"><a href="#cb339-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb339-21"><a href="#cb339-21" aria-hidden="true" tabindex="-1"></a>results_per_page_joyriding <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb339-22"><a href="#cb339-22" aria-hidden="true" tabindex="-1"></a>total_pages_joyriding <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_joyriding[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_joyriding)</span>
<span id="cb339-23"><a href="#cb339-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_joyriding and total_pages_joyriding</span></span>
<span id="cb339-24"><a href="#cb339-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_joyriding)</span>
<span id="cb339-25"><a href="#cb339-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_joyriding)</span>
<span id="cb339-26"><a href="#cb339-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-27"><a href="#cb339-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-28"><a href="#cb339-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb339-29"><a href="#cb339-29" aria-hidden="true" tabindex="-1"></a>results_joyriding_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb339-30"><a href="#cb339-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-31"><a href="#cb339-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb339-32"><a href="#cb339-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_joyriding <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb339-33"><a href="#cb339-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb339-34"><a href="#cb339-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_joyriding_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb339-35"><a href="#cb339-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-36"><a href="#cb339-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb339-37"><a href="#cb339-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb339-38"><a href="#cb339-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-39"><a href="#cb339-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb339-40"><a href="#cb339-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb339-41"><a href="#cb339-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb339-42"><a href="#cb339-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-43"><a href="#cb339-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb339-44"><a href="#cb339-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb339-45"><a href="#cb339-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb339-46"><a href="#cb339-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb339-47"><a href="#cb339-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb339-48"><a href="#cb339-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-49"><a href="#cb339-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb339-50"><a href="#cb339-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb339-51"><a href="#cb339-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb339-52"><a href="#cb339-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb339-53"><a href="#cb339-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-54"><a href="#cb339-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb339-55"><a href="#cb339-55" aria-hidden="true" tabindex="-1"></a>  current_results_joyriding <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb339-56"><a href="#cb339-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb339-57"><a href="#cb339-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-58"><a href="#cb339-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb339-59"><a href="#cb339-59" aria-hidden="true" tabindex="-1"></a>  results_joyriding_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_joyriding_rvest, current_results_joyriding)</span>
<span id="cb339-60"><a href="#cb339-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb339-61"><a href="#cb339-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb339-62"><a href="#cb339-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb339-63"><a href="#cb339-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb339-64"><a href="#cb339-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb339-65"><a href="#cb339-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-66"><a href="#cb339-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb339-67"><a href="#cb339-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_joyriding_rvest))</span>
<span id="cb339-68"><a href="#cb339-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-69"><a href="#cb339-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-70"><a href="#cb339-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb339-71"><a href="#cb339-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_joyriding_rvest, <span class="st">"Data extraction/joyriding_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-20" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-20">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>results_joyriding<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/joyriding_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>results_joyriding_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/joyriding_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb340-7"><a href="#cb340-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb340-8"><a href="#cb340-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-9"><a href="#cb340-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb340-10"><a href="#cb340-10" aria-hidden="true" tabindex="-1"></a>results_joyriding2 <span class="ot">&lt;-</span> results_joyriding <span class="sc">%&gt;%</span></span>
<span id="cb340-11"><a href="#cb340-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb340-12"><a href="#cb340-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb340-13"><a href="#cb340-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_joyriding_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb340-14"><a href="#cb340-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb340-15"><a href="#cb340-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb340-16"><a href="#cb340-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 13
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;lgl&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 [Joy riding… 9.01e6  1996 Sep-… NA    "Joy ri… Knecht, T        Aus der Psych…
2 [Joy riding… 7.58e6  1995 Jul-… NA    "Going … Knecht, T        Kantonalen Ps…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;lgl&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_joyriding2)</span></span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We know there's no duplicate so no point even checking.</span></span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_joyriding2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1995    1995    1996    1996    1996    1996 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>joyriding_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_joyriding2<span class="sc">$</span>Year,</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on joyriding Addiction (PubMed)"</span>,</span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb345-2"><a href="#cb345-2" aria-hidden="true" tabindex="-1"></a>results_joyriding2 <span class="sc">%&gt;%</span> </span>
<span id="cb345-3"><a href="#cb345-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb345-4"><a href="#cb345-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb345-5"><a href="#cb345-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb345-6"><a href="#cb345-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb345-7"><a href="#cb345-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb345-8"><a href="#cb345-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  Journal_name_short     n
  &lt;chr&gt;              &lt;int&gt;
1 Arch Kriminol          2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_joyriding2) # Visually inspect results</span></span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the joyriding search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a>Label_joyriding <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"joyriding"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_joyriding2))</span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>results_joyriding_final <span class="ot">&lt;-</span> results_joyriding2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_joyriding) <span class="sc">%&gt;%</span></span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_joyriding_final)</span></span>
<span id="cb347-11"><a href="#cb347-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb347-12"><a href="#cb347-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_joyriding_final, <span class="st">"Data extraction/joyriding_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="crime-addiction" class="level2">
<h2 class="anchored" data-anchor-id="crime-addiction">Crime addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-21" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-21">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “Crime addiction” seems to be used in the literature.</p>
<p><strong>Actual search used:</strong> “crime addiction”[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22crime+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<ul>
<li><p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. Only 3 studies are returned and two appear relevant. The one irrelevant study is listed below and will be removed when refining this dataset:</p></li>
<li><p>The Politics of Tackling Inequalities: The Rise of Psychological Fundamentalism in Public Health and Welfare Reform.</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-18" class="level1">
<h1>Define the search term:</h1>
<p>search_term_crime &lt;- ‘“Crime addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-21" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_crime &lt;- entrez_search(db=“pubmed”, term=search_term_crime, retmax=20000) id_list_crime &lt;- search_results_crime$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-21" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_crime, ceiling(seq_along(id_list_crime)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-21" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_crime &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_crime &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_crime &lt;- bind_rows(details_crime)

return(details_df_crime)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-21" class="level1">
<h1>Check the results:</h1>
<p>article_details_crime %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-21" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_crime &lt;- article_details_crime %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-21" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_crime, “Data extraction/crime_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-2"><a href="#cb349-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb349-3"><a href="#cb349-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-4"><a href="#cb349-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb349-5"><a href="#cb349-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-6"><a href="#cb349-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb349-7"><a href="#cb349-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb349-8"><a href="#cb349-8" aria-hidden="true" tabindex="-1"></a>url_crime_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22crime+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 3 results returned on 20/08/2023</span></span>
<span id="cb349-9"><a href="#cb349-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-10"><a href="#cb349-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb349-11"><a href="#cb349-11" aria-hidden="true" tabindex="-1"></a>webpage_crime_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_crime_rvest)</span>
<span id="cb349-12"><a href="#cb349-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-13"><a href="#cb349-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb349-14"><a href="#cb349-14" aria-hidden="true" tabindex="-1"></a>results_count_crime <span class="ot">&lt;-</span> webpage_crime_rvest <span class="sc">%&gt;%</span></span>
<span id="cb349-15"><a href="#cb349-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb349-16"><a href="#cb349-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb349-17"><a href="#cb349-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb349-18"><a href="#cb349-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb349-19"><a href="#cb349-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-20"><a href="#cb349-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb349-21"><a href="#cb349-21" aria-hidden="true" tabindex="-1"></a>results_per_page_crime <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb349-22"><a href="#cb349-22" aria-hidden="true" tabindex="-1"></a>total_pages_crime <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_crime[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_crime)</span>
<span id="cb349-23"><a href="#cb349-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_crime and total_pages_crime</span></span>
<span id="cb349-24"><a href="#cb349-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_crime)</span>
<span id="cb349-25"><a href="#cb349-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_crime)</span>
<span id="cb349-26"><a href="#cb349-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-27"><a href="#cb349-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-28"><a href="#cb349-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb349-29"><a href="#cb349-29" aria-hidden="true" tabindex="-1"></a>results_crime_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb349-30"><a href="#cb349-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-31"><a href="#cb349-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb349-32"><a href="#cb349-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_crime <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb349-33"><a href="#cb349-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb349-34"><a href="#cb349-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_crime_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb349-35"><a href="#cb349-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-36"><a href="#cb349-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb349-37"><a href="#cb349-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb349-38"><a href="#cb349-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-39"><a href="#cb349-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb349-40"><a href="#cb349-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb349-41"><a href="#cb349-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb349-42"><a href="#cb349-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb349-43"><a href="#cb349-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb349-44"><a href="#cb349-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb349-45"><a href="#cb349-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb349-46"><a href="#cb349-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb349-47"><a href="#cb349-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb349-48"><a href="#cb349-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-49"><a href="#cb349-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb349-50"><a href="#cb349-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb349-51"><a href="#cb349-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb349-52"><a href="#cb349-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb349-53"><a href="#cb349-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-54"><a href="#cb349-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb349-55"><a href="#cb349-55" aria-hidden="true" tabindex="-1"></a>  current_results_crime <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb349-56"><a href="#cb349-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb349-57"><a href="#cb349-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-58"><a href="#cb349-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb349-59"><a href="#cb349-59" aria-hidden="true" tabindex="-1"></a>  results_crime_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_crime_rvest, current_results_crime)</span>
<span id="cb349-60"><a href="#cb349-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb349-61"><a href="#cb349-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb349-62"><a href="#cb349-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb349-63"><a href="#cb349-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb349-64"><a href="#cb349-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb349-65"><a href="#cb349-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-66"><a href="#cb349-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb349-67"><a href="#cb349-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_crime_rvest))</span>
<span id="cb349-68"><a href="#cb349-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-69"><a href="#cb349-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb349-70"><a href="#cb349-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb349-71"><a href="#cb349-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_crime_rvest, <span class="st">"Data extraction/crime_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-21" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-21">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a>results_crime<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/crime_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>results_crime_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/crime_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a>results_crime2 <span class="ot">&lt;-</span> results_crime <span class="sc">%&gt;%</span></span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_crime_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 13
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Tests of th… 2.93e7  2018 Sep   10.1… "The At… Lindberg, Marc … 1 Marshall Un…
2 The Politic… 2.77e7  2015 Nov   &lt;NA&gt;  "This c… Friedli, Lynne   Reader, Globa…
3 Tests of Th… 2.61e7  2017 Feb   10.1… "Severa… Lindberg, Marc … 1 Marshall Un…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;lgl&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_crime2)</span></span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We know there's no duplicate so no point even checking.</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove irrelevant study:</span></span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a>results_crime3 <span class="ot">&lt;-</span>  results_crime2 <span class="sc">%&gt;%</span> </span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">!=</span> <span class="st">"The Politics of Tackling Inequalities: The Rise of Psychological Fundamentalism in Public Health and Welfare Reform."</span>)</span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb352-11"><a href="#cb352-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_crime3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2017    2017    2018    2018    2018    2018 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a>crime_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_crime3<span class="sc">$</span>Year,</span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Crime Addiction (PubMed)"</span>,</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a>results_crime3 <span class="sc">%&gt;%</span> </span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb355-4"><a href="#cb355-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb355-5"><a href="#cb355-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb355-6"><a href="#cb355-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb355-7"><a href="#cb355-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb355-8"><a href="#cb355-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  Journal_name_short                    n
  &lt;chr&gt;                             &lt;int&gt;
1 Int J Offender Ther Comp Criminol     2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_crime2) # Visually inspect results</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the crime search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb357-4"><a href="#cb357-4" aria-hidden="true" tabindex="-1"></a>Label_crime <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"crime"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_crime3))</span>
<span id="cb357-5"><a href="#cb357-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-6"><a href="#cb357-6" aria-hidden="true" tabindex="-1"></a>results_crime_final <span class="ot">&lt;-</span> results_crime3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_crime) <span class="sc">%&gt;%</span></span>
<span id="cb357-7"><a href="#cb357-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb357-8"><a href="#cb357-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb357-9"><a href="#cb357-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-10"><a href="#cb357-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_crime_final)</span></span>
<span id="cb357-11"><a href="#cb357-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb357-12"><a href="#cb357-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_crime_final, <span class="st">"Data extraction/crime_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="polysurgical-addiction" class="level2">
<h2 class="anchored" data-anchor-id="polysurgical-addiction">Polysurgical addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-22" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-22">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “polysurgical addiction” seems to be used in the literature. Adding in the [Title/Abstract] filter resulted in no results and so it was removed.</p>
<p><strong>Actual search used:</strong> “polysurgical addiction”</p>
<ul>
<li>“pathomimia” and “Factitious disorder” are used similarly sometimes, but only returned irrelevant studies.</li>
</ul>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Polysurgical+addiction%22&amp;size=200">link</a></p>
<ul>
<li><p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. Only 3 studies are returned and two appear relevant. The one irrelevant study is listed below and will be removed when refining this dataset:</p></li>
<li><p>Hypnosis in living systems theory: a living systems autopsy in a polysurgical, polymedical, polypsychiatric patient addicted to talwin.</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-19" class="level1">
<h1>Define the search term:</h1>
<p>search_term_polysurgical &lt;- ‘“polysurgical addiction’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-22" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_polysurgical &lt;- entrez_search(db=“pubmed”, term=search_term_polysurgical, retmax=20000) id_list_polysurgical &lt;- search_results_polysurgical$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-22" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_polysurgical, ceiling(seq_along(id_list_polysurgical)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-22" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_polysurgical &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_polysurgical &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_polysurgical &lt;- bind_rows(details_polysurgical)

return(details_df_polysurgical)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-22" class="level1">
<h1>Check the results:</h1>
<p>article_details_polysurgical %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-22" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_polysurgical &lt;- article_details_polysurgical %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-22" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_polysurgical, “Data extraction/polysurgical_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb359"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a>url_polysurgical_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Polysurgical+addiction%22&amp;size=200"</span> <span class="co"># 3 results returned on 20/08/2023</span></span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>webpage_polysurgical_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_polysurgical_rvest)</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>results_count_polysurgical <span class="ot">&lt;-</span> webpage_polysurgical_rvest <span class="sc">%&gt;%</span></span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>results_per_page_polysurgical <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>total_pages_polysurgical <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_polysurgical[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_polysurgical)</span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_polysurgical and total_pages_polysurgical</span></span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_polysurgical)</span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_polysurgical)</span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>results_polysurgical_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_polysurgical <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_polysurgical_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a>  current_results_polysurgical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a>  results_polysurgical_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_polysurgical_rvest, current_results_polysurgical)</span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb359-62"><a href="#cb359-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb359-63"><a href="#cb359-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb359-64"><a href="#cb359-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb359-65"><a href="#cb359-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-66"><a href="#cb359-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb359-67"><a href="#cb359-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_polysurgical_rvest))</span>
<span id="cb359-68"><a href="#cb359-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-69"><a href="#cb359-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-70"><a href="#cb359-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb359-71"><a href="#cb359-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_polysurgical_rvest, <span class="st">"Data extraction/polysurgical_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-22" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-22">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>results_polysurgical<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/polysurgical_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a>results_polysurgical_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/polysurgical_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb360-8"><a href="#cb360-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb360-9"><a href="#cb360-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb360-10"><a href="#cb360-10" aria-hidden="true" tabindex="-1"></a>results_polysurgical2 <span class="ot">&lt;-</span> results_polysurgical <span class="sc">%&gt;%</span></span>
<span id="cb360-11"><a href="#cb360-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb360-12"><a href="#cb360-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb360-13"><a href="#cb360-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_polysurgical_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb360-14"><a href="#cb360-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb360-15"><a href="#cb360-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb360-16"><a href="#cb360-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 13
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;lgl&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Psychosomat… 1.78e7  2007 Sep   NA    "Medica… Harth, Wolfgang… "Department o…
2 Hypnosis in… 5.51e6  1970 Jul   NA     &lt;NA&gt;    Kolouch, F T      &lt;NA&gt;         
3 The van Gog… 5.96e6  1966 Oct   NA     &lt;NA&gt;    Abram, H S        &lt;NA&gt;         
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;lgl&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_polysurgical2)</span></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We know there's no duplicate so no point even checking.</span></span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove irrelevant study:</span></span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>results_polysurgical3 <span class="ot">&lt;-</span>  results_polysurgical2 <span class="sc">%&gt;%</span> </span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">!=</span> <span class="st">"Hypnosis in living systems theory: a living systems autopsy in a polysurgical, polymedical, polypsychiatric patient addicted to talwin."</span>)</span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_polysurgical3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1966    1976    1986    1986    1997    2007 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>polysurgical_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_polysurgical3<span class="sc">$</span>Year,</span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Polysurgical Addiction (PubMed)"</span>,</span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a>results_polysurgical3 <span class="sc">%&gt;%</span> </span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  Journal_name_short       n
  &lt;chr&gt;                &lt;int&gt;
1 Am J Psychiatry          1
2 J Dtsch Dermatol Ges     1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_polysurgical3) # Visually inspect results</span></span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the polysurgical search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>Label_polysurgical <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"polysurgical"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_polysurgical3))</span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>results_polysurgical_final <span class="ot">&lt;-</span> results_polysurgical3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_polysurgical) <span class="sc">%&gt;%</span></span>
<span id="cb367-7"><a href="#cb367-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb367-8"><a href="#cb367-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb367-9"><a href="#cb367-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb367-10"><a href="#cb367-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_polysurgical_final)</span></span>
<span id="cb367-11"><a href="#cb367-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb367-12"><a href="#cb367-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_polysurgical_final, <span class="st">"Data extraction/polysurgical_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fortune-telling-addiction" class="level2">
<h2 class="anchored" data-anchor-id="fortune-telling-addiction">Fortune telling addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-23" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-23">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “fortune telling addiction” seems to be used in the literature.</p>
<p><strong>Actual search used:</strong> “fortune telling addiction”[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22fortune+telling+addiction%22%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<ul>
<li><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. Only 3 studies are returned and all appear relevant.</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-20" class="level1">
<h1>Define the search term:</h1>
<p>search_term_fortune_telling &lt;- ‘fortune telling addiction”[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-23" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_fortune_telling &lt;- entrez_search(db=“pubmed”, term=search_term_fortune_telling, retmax=20000) id_list_fortune_telling &lt;- search_results_fortune_telling$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-23" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_fortune_telling, ceiling(seq_along(id_list_fortune_telling)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-23" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_fortune_telling &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_fortune_telling &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_fortune_telling &lt;- bind_rows(details_fortune_telling)

return(details_df_fortune_telling)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-23" class="level1">
<h1>Check the results:</h1>
<p>article_details_fortune_telling %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-23" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_fortune_telling &lt;- article_details_fortune_telling %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-23" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_fortune_telling, “Data extraction/fortune_telling_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb369-5"><a href="#cb369-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-6"><a href="#cb369-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb369-7"><a href="#cb369-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb369-8"><a href="#cb369-8" aria-hidden="true" tabindex="-1"></a>url_fortune_telling_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22fortune+telling+addiction%22%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 3 results returned on 20/08/2023</span></span>
<span id="cb369-9"><a href="#cb369-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-10"><a href="#cb369-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb369-11"><a href="#cb369-11" aria-hidden="true" tabindex="-1"></a>webpage_fortune_telling_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_fortune_telling_rvest)</span>
<span id="cb369-12"><a href="#cb369-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-13"><a href="#cb369-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb369-14"><a href="#cb369-14" aria-hidden="true" tabindex="-1"></a>results_count_fortune_telling <span class="ot">&lt;-</span> webpage_fortune_telling_rvest <span class="sc">%&gt;%</span></span>
<span id="cb369-15"><a href="#cb369-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-16"><a href="#cb369-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb369-17"><a href="#cb369-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-18"><a href="#cb369-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb369-19"><a href="#cb369-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-20"><a href="#cb369-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb369-21"><a href="#cb369-21" aria-hidden="true" tabindex="-1"></a>results_per_page_fortune_telling <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb369-22"><a href="#cb369-22" aria-hidden="true" tabindex="-1"></a>total_pages_fortune_telling <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_fortune_telling[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_fortune_telling)</span>
<span id="cb369-23"><a href="#cb369-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_fortune_telling and total_pages_fortune_telling</span></span>
<span id="cb369-24"><a href="#cb369-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_fortune_telling)</span>
<span id="cb369-25"><a href="#cb369-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_fortune_telling)</span>
<span id="cb369-26"><a href="#cb369-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-27"><a href="#cb369-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-28"><a href="#cb369-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb369-29"><a href="#cb369-29" aria-hidden="true" tabindex="-1"></a>results_fortune_telling_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb369-30"><a href="#cb369-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-31"><a href="#cb369-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb369-32"><a href="#cb369-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_fortune_telling <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb369-33"><a href="#cb369-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb369-34"><a href="#cb369-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_fortune_telling_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb369-35"><a href="#cb369-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb369-36"><a href="#cb369-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb369-37"><a href="#cb369-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb369-38"><a href="#cb369-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb369-39"><a href="#cb369-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb369-40"><a href="#cb369-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb369-41"><a href="#cb369-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb369-42"><a href="#cb369-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-43"><a href="#cb369-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb369-44"><a href="#cb369-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb369-45"><a href="#cb369-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb369-46"><a href="#cb369-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb369-47"><a href="#cb369-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb369-48"><a href="#cb369-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb369-49"><a href="#cb369-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb369-50"><a href="#cb369-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb369-51"><a href="#cb369-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb369-52"><a href="#cb369-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb369-53"><a href="#cb369-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb369-54"><a href="#cb369-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb369-55"><a href="#cb369-55" aria-hidden="true" tabindex="-1"></a>  current_results_fortune_telling <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb369-56"><a href="#cb369-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb369-57"><a href="#cb369-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb369-58"><a href="#cb369-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb369-59"><a href="#cb369-59" aria-hidden="true" tabindex="-1"></a>  results_fortune_telling_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_fortune_telling_rvest, current_results_fortune_telling)</span>
<span id="cb369-60"><a href="#cb369-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb369-61"><a href="#cb369-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb369-62"><a href="#cb369-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb369-63"><a href="#cb369-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb369-64"><a href="#cb369-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb369-65"><a href="#cb369-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-66"><a href="#cb369-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb369-67"><a href="#cb369-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_fortune_telling_rvest))</span>
<span id="cb369-68"><a href="#cb369-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-69"><a href="#cb369-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb369-70"><a href="#cb369-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb369-71"><a href="#cb369-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_fortune_telling_rvest, <span class="st">"Data extraction/fortune_telling_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-23" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-23">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>results_fortune_telling<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/fortune_telling_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>results_fortune_telling_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/fortune_telling_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb370-8"><a href="#cb370-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb370-9"><a href="#cb370-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb370-10"><a href="#cb370-10" aria-hidden="true" tabindex="-1"></a>results_fortune_telling2 <span class="ot">&lt;-</span> results_fortune_telling <span class="sc">%&gt;%</span></span>
<span id="cb370-11"><a href="#cb370-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb370-12"><a href="#cb370-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb370-13"><a href="#cb370-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_fortune_telling_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb370-14"><a href="#cb370-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb370-15"><a href="#cb370-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb370-16"><a href="#cb370-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 13
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Fixating on… 3.55e7  2022 Aug   10.1… "BACKGR… Das, Abhilasha;… "Department o…
2 An addictio… 3.22e7  2020 Apr-… 10.1… "The pa… Skryabin, Valen… "Moscow Resea…
3 Fortune tel… 2.58e7  2015 Mar   10.1… "BACKGR… Grall-Bronnec, … "Nantes Unive…
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_fortune_telling2)</span></span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We know there's no duplicate so no point even checking.</span></span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb372-7"><a href="#cb372-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_fortune_telling2<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2015    2018    2020    2019    2021    2022 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>fortune_telling_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_fortune_telling2<span class="sc">$</span>Year,</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Fortune Telling Addiction (PubMed)"</span>,</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>results_fortune_telling2 <span class="sc">%&gt;%</span> </span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  Journal_name_short       n
  &lt;chr&gt;                &lt;int&gt;
1 Int J Soc Psychiatry     1
2 J Addict Dis             1
3 J Behav Addict           1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_fortune_telling2) # Visually inspect results</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the fortune_telling search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>Label_fortune_telling <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"fortune_telling"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_fortune_telling2))</span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>results_fortune_telling_final <span class="ot">&lt;-</span> results_fortune_telling2 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_fortune_telling) <span class="sc">%&gt;%</span></span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_fortune_telling_final)</span></span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_fortune_telling_final, <span class="st">"Data extraction/fortune_telling_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="youtube-addiction" class="level2">
<h2 class="anchored" data-anchor-id="youtube-addiction">YouTube addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-24" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-24">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. The simple phrase “YouTube addiction” seems to be used in the only study I can find on this. Including the phrase inside quotation marks only returns one study, and so the link return from this search doesn’t work with the <code>rvest</code> package. As such, I removed the quotation marks and naturally found a couple of other studies that seem relevant.</p>
<p><strong>Actual search used:</strong> YouTube addiction</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=YouTube+addiction&amp;size=200">link</a></p>
<ul>
<li><p><strong>Notes post-search:</strong> I manually inspected all of the results returned on PubMed. Of the approximately 64 results, 3 appeared relevant and will be isolated when refining this dataset:</p></li>
<li><p>YouTube™ as an effective but potentially addictive distraction tool for paediatric phlebotomy</p></li>
<li><p>YouTube™ as an effective but potentially addictive distraction tool for paediatric phlebotomy</p></li>
<li><p>Short Video Addiction on the Interaction of Creative Self-Efficacy and Career Interest to Innovative Design Profession Students</p></li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-21" class="level1">
<h1>Define the search term:</h1>
<p>search_term_YouTube &lt;- ‘YouTube addiction’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-24" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_YouTube &lt;- entrez_search(db=“pubmed”, term=search_term_YouTube, retmax=20000) id_list_YouTube &lt;- search_results_YouTube$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-24" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_YouTube, ceiling(seq_along(id_list_YouTube)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-24" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_YouTube &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_YouTube &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_YouTube &lt;- bind_rows(details_YouTube)

return(details_df_YouTube)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-24" class="level1">
<h1>Check the results:</h1>
<p>article_details_YouTube %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-24" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_YouTube &lt;- article_details_YouTube %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-24" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_YouTube, “Data extraction/YouTube_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb379"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb379-3"><a href="#cb379-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-4"><a href="#cb379-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb379-5"><a href="#cb379-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-6"><a href="#cb379-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb379-7"><a href="#cb379-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb379-8"><a href="#cb379-8" aria-hidden="true" tabindex="-1"></a>url_YouTube_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=YouTube+addiction&amp;size=200"</span> <span class="co"># 64 results returned on 20/08/2023</span></span>
<span id="cb379-9"><a href="#cb379-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-10"><a href="#cb379-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb379-11"><a href="#cb379-11" aria-hidden="true" tabindex="-1"></a>webpage_YouTube_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_YouTube_rvest)</span>
<span id="cb379-12"><a href="#cb379-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-13"><a href="#cb379-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb379-14"><a href="#cb379-14" aria-hidden="true" tabindex="-1"></a>results_count_YouTube <span class="ot">&lt;-</span> webpage_YouTube_rvest <span class="sc">%&gt;%</span></span>
<span id="cb379-15"><a href="#cb379-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-16"><a href="#cb379-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb379-17"><a href="#cb379-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-18"><a href="#cb379-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb379-19"><a href="#cb379-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-20"><a href="#cb379-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb379-21"><a href="#cb379-21" aria-hidden="true" tabindex="-1"></a>results_per_page_YouTube <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb379-22"><a href="#cb379-22" aria-hidden="true" tabindex="-1"></a>total_pages_YouTube <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_YouTube[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_YouTube)</span>
<span id="cb379-23"><a href="#cb379-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_YouTube and total_pages_YouTube</span></span>
<span id="cb379-24"><a href="#cb379-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_YouTube)</span>
<span id="cb379-25"><a href="#cb379-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_YouTube)</span>
<span id="cb379-26"><a href="#cb379-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-27"><a href="#cb379-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-28"><a href="#cb379-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb379-29"><a href="#cb379-29" aria-hidden="true" tabindex="-1"></a>results_YouTube_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb379-30"><a href="#cb379-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-31"><a href="#cb379-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb379-32"><a href="#cb379-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_YouTube <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb379-33"><a href="#cb379-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb379-34"><a href="#cb379-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_YouTube_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb379-35"><a href="#cb379-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb379-36"><a href="#cb379-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb379-37"><a href="#cb379-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb379-38"><a href="#cb379-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb379-39"><a href="#cb379-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb379-40"><a href="#cb379-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb379-41"><a href="#cb379-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb379-42"><a href="#cb379-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-43"><a href="#cb379-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb379-44"><a href="#cb379-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb379-45"><a href="#cb379-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb379-46"><a href="#cb379-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb379-47"><a href="#cb379-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb379-48"><a href="#cb379-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb379-49"><a href="#cb379-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb379-50"><a href="#cb379-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb379-51"><a href="#cb379-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb379-52"><a href="#cb379-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb379-53"><a href="#cb379-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb379-54"><a href="#cb379-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb379-55"><a href="#cb379-55" aria-hidden="true" tabindex="-1"></a>  current_results_YouTube <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb379-56"><a href="#cb379-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb379-57"><a href="#cb379-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb379-58"><a href="#cb379-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb379-59"><a href="#cb379-59" aria-hidden="true" tabindex="-1"></a>  results_YouTube_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_YouTube_rvest, current_results_YouTube)</span>
<span id="cb379-60"><a href="#cb379-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb379-61"><a href="#cb379-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb379-62"><a href="#cb379-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb379-63"><a href="#cb379-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb379-64"><a href="#cb379-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb379-65"><a href="#cb379-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-66"><a href="#cb379-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb379-67"><a href="#cb379-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_YouTube_rvest))</span>
<span id="cb379-68"><a href="#cb379-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-69"><a href="#cb379-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb379-70"><a href="#cb379-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb379-71"><a href="#cb379-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_YouTube_rvest, <span class="st">"Data extraction/YouTube_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-24" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-24">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>results_YouTube<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/YouTube_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>results_YouTube_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/YouTube_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb380-8"><a href="#cb380-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb380-9"><a href="#cb380-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb380-10"><a href="#cb380-10" aria-hidden="true" tabindex="-1"></a>results_YouTube2 <span class="ot">&lt;-</span> results_YouTube <span class="sc">%&gt;%</span></span>
<span id="cb380-11"><a href="#cb380-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb380-12"><a href="#cb380-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb380-13"><a href="#cb380-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_YouTube_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb380-14"><a href="#cb380-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb380-15"><a href="#cb380-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb380-16"><a href="#cb380-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 64 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 An Evaluat… 3.76e7  2022 Oct   10.3… "BACKGR… Unal, Egemen; G… "Department o…
 2 Behind the… 3.71e7  2023 Jun   10.1… "ChatGP… Haman, Michael;… "Department o…
 3 User-gener… 3.69e7  2023 Mar   10.1… "BACKGR… Smith, Marissa … "MRC/CSO Soci…
 4 Alcohol br… 3.69e7  2023 Mar   10.1… "BACKGR… Critchlow, Nath… "Institute fo…
 5 Short Vide… 3.68e7  2023 Feb   10.3… "In rec… Lin, I-Tung; Sh… "College of G…
 6 Opioids in… 3.68e7  2023 Jan   10.1… "Prescr… Ittefaq, Muhamm… "School of Co…
 7 Problemati… 3.66e7  2022 Dec   10.3… "During… Gonzalez-Nuevo,… "Department o…
 8 Palliative… 3.65e7  2023 Apr   10.1… "BACKGR… Buchman, Daniel… "Everyday Eth…
 9 Social med… 3.64e7  2022 &lt;NA&gt;  10.3… "Widesp… Sagrera, Caroli… "Department o…
10 Social Med… 3.64e7  2022 Nov   10.3… "BACKGR… Doan, Linh Phuo… "Faculty of M…
# ℹ 54 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_YouTube2)</span></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb382-6"><a href="#cb382-6" aria-hidden="true" tabindex="-1"></a>results_YouTube2 <span class="sc">%&gt;%</span></span>
<span id="cb382-7"><a href="#cb382-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb382-8"><a href="#cb382-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb382-9"><a href="#cb382-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 (August, 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a>results_YouTube2 <span class="sc">%&gt;%</span></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1    64</code></pre>
</div>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate relevant studies:</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>results_YouTube3 <span class="ot">&lt;-</span>  results_YouTube2 <span class="sc">%&gt;%</span> </span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">%in%</span> <span class="fu">c</span>(</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a><span class="st">"YouTube™ as an effective but potentially addictive distraction tool for paediatric phlebotomy."</span>,</span>
<span id="cb386-5"><a href="#cb386-5" aria-hidden="true" tabindex="-1"></a><span class="st">"Social media addiction: What is the role of content in YouTube?"</span>,</span>
<span id="cb386-6"><a href="#cb386-6" aria-hidden="true" tabindex="-1"></a><span class="st">"Short Video Addiction on the Interaction of Creative Self-Efficacy and Career Interest to Innovative Design Profession Students."</span></span>
<span id="cb386-7"><a href="#cb386-7" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb386-8"><a href="#cb386-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb386-9"><a href="#cb386-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb386-10"><a href="#cb386-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_YouTube3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2017    2019    2021    2020    2022    2023 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a>YouTube_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_YouTube3<span class="sc">$</span>Year,</span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">5</span>,</span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on YouTube Addiction (PubMed)"</span>,</span>
<span id="cb388-6"><a href="#cb388-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a>results_YouTube3 <span class="sc">%&gt;%</span> </span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb389-5"><a href="#cb389-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb389-6"><a href="#cb389-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb389-7"><a href="#cb389-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb389-8"><a href="#cb389-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  Journal_name_short     n
  &lt;chr&gt;              &lt;int&gt;
1 Acta Paediatr          1
2 Healthcare (Basel)     1
3 J Behav Addict         1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_YouTube2) # Visually inspect results</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the YouTube search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb391-4"><a href="#cb391-4" aria-hidden="true" tabindex="-1"></a>Label_YouTube <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"YouTube"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_YouTube3))</span>
<span id="cb391-5"><a href="#cb391-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-6"><a href="#cb391-6" aria-hidden="true" tabindex="-1"></a>results_YouTube_final <span class="ot">&lt;-</span> results_YouTube3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_YouTube) <span class="sc">%&gt;%</span></span>
<span id="cb391-7"><a href="#cb391-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb391-8"><a href="#cb391-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb391-9"><a href="#cb391-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-10"><a href="#cb391-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_YouTube_final)</span></span>
<span id="cb391-11"><a href="#cb391-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb391-12"><a href="#cb391-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_YouTube_final, <span class="st">"Data extraction/YouTube_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="death-addiction" class="level2">
<h2 class="anchored" data-anchor-id="death-addiction">Death addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-25" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-25">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. There is only one study on this that I can find and it’s called “Addiction to death”. I played around with the search string to try and isolate this study, but I can only get it down to a minimum of 134 results using the below search string.</p>
<p><strong>Actual search used:</strong> Addiction to death[Title/Abstract]</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=Addiction+to+death%5BTitle%2FAbstract%5D&amp;size=200">link</a></p>
<ul>
<li><strong>Notes post-search:</strong> As mentioned above, the only relevant study returned here is called: “Addiction to death.”. This will be isolated later when I refine the dataset.</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-22" class="level1">
<h1>Define the search term:</h1>
<p>search_term_death &lt;- ‘Addiction to death[Title/Abstract]’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-25" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_death &lt;- entrez_search(db=“pubmed”, term=search_term_death, retmax=20000) id_list_death &lt;- search_results_death$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-25" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_death, ceiling(seq_along(id_list_death)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-25" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_death &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_death &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_death &lt;- bind_rows(details_death)

return(details_df_death)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-25" class="level1">
<h1>Check the results:</h1>
<p>article_details_death %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-25" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_death &lt;- article_details_death %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-25" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_death, “Data extraction/death_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb393"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true" tabindex="-1"></a>url_death_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=Addiction+to+death%5BTitle%2FAbstract%5D&amp;size=200"</span> <span class="co"># 103 results returned on 20/08/2023</span></span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb393-11"><a href="#cb393-11" aria-hidden="true" tabindex="-1"></a>webpage_death_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_death_rvest)</span>
<span id="cb393-12"><a href="#cb393-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-13"><a href="#cb393-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb393-14"><a href="#cb393-14" aria-hidden="true" tabindex="-1"></a>results_count_death <span class="ot">&lt;-</span> webpage_death_rvest <span class="sc">%&gt;%</span></span>
<span id="cb393-15"><a href="#cb393-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb393-16"><a href="#cb393-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb393-17"><a href="#cb393-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb393-18"><a href="#cb393-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb393-19"><a href="#cb393-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-20"><a href="#cb393-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb393-21"><a href="#cb393-21" aria-hidden="true" tabindex="-1"></a>results_per_page_death <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb393-22"><a href="#cb393-22" aria-hidden="true" tabindex="-1"></a>total_pages_death <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_death[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_death)</span>
<span id="cb393-23"><a href="#cb393-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_death and total_pages_death</span></span>
<span id="cb393-24"><a href="#cb393-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_death)</span>
<span id="cb393-25"><a href="#cb393-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_death)</span>
<span id="cb393-26"><a href="#cb393-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-27"><a href="#cb393-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-28"><a href="#cb393-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb393-29"><a href="#cb393-29" aria-hidden="true" tabindex="-1"></a>results_death_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb393-30"><a href="#cb393-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-31"><a href="#cb393-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb393-32"><a href="#cb393-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_death <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb393-33"><a href="#cb393-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb393-34"><a href="#cb393-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_death_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb393-35"><a href="#cb393-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-36"><a href="#cb393-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb393-37"><a href="#cb393-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb393-38"><a href="#cb393-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-39"><a href="#cb393-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb393-40"><a href="#cb393-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb393-41"><a href="#cb393-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb393-42"><a href="#cb393-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb393-43"><a href="#cb393-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb393-44"><a href="#cb393-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb393-45"><a href="#cb393-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb393-46"><a href="#cb393-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb393-47"><a href="#cb393-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb393-48"><a href="#cb393-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-49"><a href="#cb393-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb393-50"><a href="#cb393-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb393-51"><a href="#cb393-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb393-52"><a href="#cb393-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb393-53"><a href="#cb393-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-54"><a href="#cb393-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb393-55"><a href="#cb393-55" aria-hidden="true" tabindex="-1"></a>  current_results_death <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb393-56"><a href="#cb393-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb393-57"><a href="#cb393-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-58"><a href="#cb393-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb393-59"><a href="#cb393-59" aria-hidden="true" tabindex="-1"></a>  results_death_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_death_rvest, current_results_death)</span>
<span id="cb393-60"><a href="#cb393-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb393-61"><a href="#cb393-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb393-62"><a href="#cb393-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb393-63"><a href="#cb393-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb393-64"><a href="#cb393-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb393-65"><a href="#cb393-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-66"><a href="#cb393-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb393-67"><a href="#cb393-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_death_rvest))</span>
<span id="cb393-68"><a href="#cb393-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-69"><a href="#cb393-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb393-70"><a href="#cb393-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb393-71"><a href="#cb393-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_death_rvest, <span class="st">"Data extraction/death_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-25" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-25">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a>results_death<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/death_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-5"><a href="#cb394-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb394-6"><a href="#cb394-6" aria-hidden="true" tabindex="-1"></a>results_death_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/death_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb394-7"><a href="#cb394-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb394-8"><a href="#cb394-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-9"><a href="#cb394-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb394-10"><a href="#cb394-10" aria-hidden="true" tabindex="-1"></a>results_death2 <span class="ot">&lt;-</span> results_death <span class="sc">%&gt;%</span></span>
<span id="cb394-11"><a href="#cb394-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb394-12"><a href="#cb394-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb394-13"><a href="#cb394-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_death_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb394-14"><a href="#cb394-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb394-15"><a href="#cb394-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb394-16"><a href="#cb394-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 134 × 13
   Title         PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
   &lt;chr&gt;        &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
 1 "Siddha ma… 3.74e7  2022 &lt;NA&gt;  10.6… "Addict… Selvasankari, E… "Department o…
 2 "Longitudi… 3.73e7  2023 Aug   S294… "INTROD… Shover, Chelsea… "Division of …
 3 "Pseudorab… 3.72e7  2023 May   2023… "Infect… Cronin, Shane J…  &lt;NA&gt;         
 4 "Receipt o… 3.72e7  2023 &lt;NA&gt;  10.1… "Backgr… Macmadu, Alexan… "Brown Univer…
 5 "Buprenorp… 3.71e7  2023 Jul   S294… "BACKGR… Victor, Grant; … "School of So…
 6 "Concordan… 3.67e7  2023 Mar   S037… "BACKGR… Howell, Benjami… "SEICHE Cente…
 7 "Developme… 3.66e7  2022 &lt;NA&gt;  10.3… "The de… Prakash, Nilima  "Laboratory o…
 8 "Sudden ga… 3.66e7  2022 Dec   10.1… "BACKGR… Kuperczko, Dian… "Department o…
 9 "Insights … 3.65e7  2023 &lt;NA&gt;  10.3… "The ag… Rajah Kumaran, … "Malaysian In…
10 "Fragmenta… 3.63e7  2023 May   10.1… "INTROD… Wu, Rebecca; Tr… "Division of …
# ℹ 124 more rows
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_death2)</span></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a>results_death2 <span class="sc">%&gt;%</span></span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb396-8"><a href="#cb396-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 (August, 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   134</code></pre>
</div>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a>results_death2 <span class="sc">%&gt;%</span></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1   134</code></pre>
</div>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate relevant study:</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>results_death3 <span class="ot">&lt;-</span>  results_death2 <span class="sc">%&gt;%</span> </span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">==</span> <span class="st">"Addiction to death."</span></span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_death3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   2018    2018    2018    2018    2018    2018 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>death_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_death3<span class="sc">$</span>Year,</span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb402-4"><a href="#cb402-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">100</span>,</span>
<span id="cb402-5"><a href="#cb402-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Death Addiction (PubMed)"</span>,</span>
<span id="cb402-6"><a href="#cb402-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>results_death3 <span class="sc">%&gt;%</span> </span>
<span id="cb403-3"><a href="#cb403-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb403-4"><a href="#cb403-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb403-5"><a href="#cb403-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb403-6"><a href="#cb403-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb403-7"><a href="#cb403-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb403-8"><a href="#cb403-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  Journal_name_short     n
  &lt;chr&gt;              &lt;int&gt;
1 CNS Spectr             1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_death2) # Visually inspect results</span></span>
<span id="cb405-2"><a href="#cb405-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-3"><a href="#cb405-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the death search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb405-4"><a href="#cb405-4" aria-hidden="true" tabindex="-1"></a>Label_death <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"death"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_death3))</span>
<span id="cb405-5"><a href="#cb405-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-6"><a href="#cb405-6" aria-hidden="true" tabindex="-1"></a>results_death_final <span class="ot">&lt;-</span> results_death3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_death) <span class="sc">%&gt;%</span></span>
<span id="cb405-7"><a href="#cb405-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb405-8"><a href="#cb405-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb405-9"><a href="#cb405-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-10"><a href="#cb405-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_death_final)</span></span>
<span id="cb405-11"><a href="#cb405-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb405-12"><a href="#cb405-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_death_final, <span class="st">"Data extraction/death_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="near-death-addiction" class="level2">
<h2 class="anchored" data-anchor-id="near-death-addiction">Near death addiction</h2>
<section id="extract-studies-and-perform-a-basic-clean-of-dataset-26" class="level4">
<h4 class="anchored" data-anchor-id="extract-studies-and-perform-a-basic-clean-of-dataset-26">Extract studies and perform a basic clean of dataset</h4>
<p><strong>Notes pre-search:</strong> No available MeSH terms. There is only one study on this that I can find and it’s called “Addiction to near-death”. I played around with the search string to try and isolate this study, but I can only get it down to a minimum of 7 results using the below search string.</p>
<p><strong>Actual search used:</strong> “Addiction to near-death”</p>
<p><strong>Manual search results:</strong> <a href="https://pubmed.ncbi.nlm.nih.gov/?term=%22Addiction+to+near-death%22&amp;size=200">link</a></p>
<ul>
<li><strong>Notes post-search:</strong> As mentioned above, the only relevant study returned here is called: “Addiction to near-death.”. This will be isolated later when I refine the dataset.</li>
</ul>
<p>```{{r warning=FALSE, message=FALSE}} # Clean environment: rm(list = ls())</p>
</section>
</section>
</section>
<section id="define-the-search-term-23" class="level1">
<h1>Define the search term:</h1>
<p>search_term_near_death &lt;- ‘“Addiction to near-death”’</p>
</section>
<section id="use-entrez_search-to-get-the-ids-of-the-articles-26" class="level1">
<h1>Use entrez_search to get the IDs of the articles:</h1>
<p>search_results_near_death &lt;- entrez_search(db=“pubmed”, term=search_term_near_death, retmax=20000) id_list_near_death &lt;- search_results_near_death$ids</p>
</section>
<section id="split-id-list-into-chunks-of-100-for-chunkbatches-26" class="level1">
<h1>Split id list into chunks of 100 for chunk/batches:</h1>
<p>chunks &lt;- split(id_list_near_death, ceiling(seq_along(id_list_near_death)/100))</p>
</section>
<section id="fetch-details-for-each-chunk-of-articles-26" class="level1">
<h1>Fetch details for each chunk of articles:</h1>
<p>article_details_near_death &lt;- map_dfr(chunks, function(ids) { # Fetch details of the articles: articles &lt;- entrez_fetch(db=“pubmed”, id=ids, rettype=“medline”, retmode=“text”)</p>
<p># Split the articles into individual articles: articles &lt;- strsplit(articles, “”)[[1]]</p>
<p># Process each article: map_dfr(articles, function(article) { # Split the article into lines: lines &lt;- strsplit(article, “”)[[1]]</p>
<pre><code># Get the details we're interested in:
details_near_death &lt;- list(
  PMID = if (any(grepl("^PMID", lines))) lines[grepl("^PMID", lines)] else NA,
  DP = if (any(grepl("^DP", lines))) lines[grepl("^DP", lines)] else NA,
  TI = if (any(grepl("^TI", lines))) lines[grepl("^TI", lines)] else NA,
  LID = if (any(grepl("^LID", lines))) paste(lines[grepl("^LID", lines)], collapse="; ") else NA,
  AB = if (any(grepl("^AB", lines))) paste(lines[grepl("^AB", lines)], collapse=" ") else NA,
  FAU = if (any(grepl("^FAU", lines))) paste(lines[grepl("^FAU", lines)], collapse="; ") else NA,
  AD = if (any(grepl("^AD", lines))) paste(lines[grepl("^AD", lines)], collapse="; ") else NA,
  LA = if (any(grepl("^LA", lines))) paste(lines[grepl("^LA", lines)], collapse="; ") else NA,
  PT = if (any(grepl("^PT", lines))) paste(lines[grepl("^PT", lines)], collapse="; ") else NA,
  TA = if (any(grepl("^TA", lines))) lines[grepl("^TA", lines)] else NA,
  COIS = if (any(grepl("^COIS", lines))) paste(lines[grepl("^COIS", lines)], collapse=" ") else NA,
  JT = if (any(grepl("^JT", lines))) lines[grepl("^JT", lines)] else NA
)

# Convert the list of details into a one-row data frame:
details_df_near_death &lt;- bind_rows(details_near_death)

return(details_df_near_death)</code></pre>
<p>}) })</p>
</section>
<section id="check-the-results-26" class="level1">
<h1>Check the results:</h1>
<p>article_details_near_death %&gt;% as_tibble() %&gt;% print()</p>
</section>
<section id="lets-remove-the-identifiers-at-the-beginning-of-each-data-point-26" class="level1">
<h1>Let’s remove the identifiers at the beginning of each data point:</h1>
<p>rep_str &lt;- c(‘PMID-’ = ’‘, ’DP -’ = ’‘, ’TI -’ = ’‘, ’LID -’ = ’‘, ’AB -’ = ’‘, ’FAU -’ = ’‘, ’AD -’ = ’‘, ’LA -’ = ’‘, ’PT -’ = ’‘, ’TA -’ = ’‘, ’COIS-’ = ’‘, ’JT -’ = ’’)</p>
<p>results_near_death &lt;- article_details_near_death %&gt;% mutate(across(everything(), ~str_replace_all(., rep_str))) %&gt;% # Remove identifiers # Now separate the date year and month/day info: separate(DP, c(“Year”, “Month”), sep = “\”) %&gt;% mutate(Year = as.numeric(Year)) %&gt;% # Convert Year to numeric rename(# Let’s also provide more descriptive names for each of the columns “Title” = “TI”, “DOI” = “LID”, “Abstract” = “AB”, “Full_Author_Name” = “FAU”, “Author_Address” = “AD”, “Language” = “LA”, “Publication_Type” = “PT”, “Journal_name_short” = “TA”, “Conflict_of_Interest_Statement” = “COIS”, “Journal_Title” = “JT”) %&gt;% print()</p>
</section>
<section id="now-save-the-initial-results-before-proceeding-so-we-cant-lose-them-26" class="level1">
<h1>Now save the initial results before proceeding so we can’t lose them!</h1>
<p>write.csv(results_near_death, “Data extraction/near_death_data.csv”, row.names=FALSE)</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Extract full title using rvest</span></span>
<span id="cb407-3"><a href="#cb407-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-4"><a href="#cb407-4" aria-hidden="true" tabindex="-1"></a>Again, we're going to use the <span class="in">`rvest`</span> package to scrape the titles returned from the manual search in PubMed, then join the two datasets using the PMID, retaining the title from this new dataset.</span>
<span id="cb407-5"><a href="#cb407-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-6"><a href="#cb407-6" aria-hidden="true" tabindex="-1"></a><span class="in">```{r warning=FALSE, message=FALSE}</span></span>
<span id="cb407-7"><a href="#cb407-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add search URL:</span></span>
<span id="cb407-8"><a href="#cb407-8" aria-hidden="true" tabindex="-1"></a>url_near_death_rvest <span class="ot">&lt;-</span> <span class="st">"https://pubmed.ncbi.nlm.nih.gov/?term=%22Addiction+to+near-death%22&amp;size=200"</span> <span class="co"># 103 results returned on 20/08/2023</span></span>
<span id="cb407-9"><a href="#cb407-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-10"><a href="#cb407-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Read and parse the webpage</span></span>
<span id="cb407-11"><a href="#cb407-11" aria-hidden="true" tabindex="-1"></a>webpage_near_death_rvest <span class="ot">&lt;-</span> <span class="fu">read_html</span>(url_near_death_rvest)</span>
<span id="cb407-12"><a href="#cb407-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-13"><a href="#cb407-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the total number of search results</span></span>
<span id="cb407-14"><a href="#cb407-14" aria-hidden="true" tabindex="-1"></a>results_count_near_death <span class="ot">&lt;-</span> webpage_near_death_rvest <span class="sc">%&gt;%</span></span>
<span id="cb407-15"><a href="#cb407-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_node</span>(<span class="st">".results-amount .value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb407-16"><a href="#cb407-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_text</span>() <span class="sc">%&gt;%</span></span>
<span id="cb407-17"><a href="#cb407-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">str_replace</span>(<span class="st">","</span>, <span class="st">""</span>) <span class="sc">%&gt;%</span></span>
<span id="cb407-18"><a href="#cb407-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb407-19"><a href="#cb407-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-20"><a href="#cb407-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the number of pages</span></span>
<span id="cb407-21"><a href="#cb407-21" aria-hidden="true" tabindex="-1"></a>results_per_page_near_death <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb407-22"><a href="#cb407-22" aria-hidden="true" tabindex="-1"></a>total_pages_near_death <span class="ot">&lt;-</span> <span class="fu">ceiling</span>(results_count_near_death[<span class="dv">1</span>] <span class="sc">/</span> results_per_page_near_death)</span>
<span id="cb407-23"><a href="#cb407-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results_count_near_death and total_pages_near_death</span></span>
<span id="cb407-24"><a href="#cb407-24" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results_count_near_death)</span>
<span id="cb407-25"><a href="#cb407-25" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(total_pages_near_death)</span>
<span id="cb407-26"><a href="#cb407-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-27"><a href="#cb407-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-28"><a href="#cb407-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Initialize an empty data frame</span></span>
<span id="cb407-29"><a href="#cb407-29" aria-hidden="true" tabindex="-1"></a>results_near_death_rvest <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb407-30"><a href="#cb407-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-31"><a href="#cb407-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop through each page and scrape the data</span></span>
<span id="cb407-32"><a href="#cb407-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (page <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>(total_pages_near_death <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb407-33"><a href="#cb407-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Update the page parameter in the URL for the current page</span></span>
<span id="cb407-34"><a href="#cb407-34" aria-hidden="true" tabindex="-1"></a>  current_url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url_near_death_rvest, <span class="st">"&amp;page="</span>, page <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb407-35"><a href="#cb407-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb407-36"><a href="#cb407-36" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Read and parse the current webpage</span></span>
<span id="cb407-37"><a href="#cb407-37" aria-hidden="true" tabindex="-1"></a>  current_page <span class="ot">&lt;-</span> <span class="fu">read_html</span>(current_url)</span>
<span id="cb407-38"><a href="#cb407-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb407-39"><a href="#cb407-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract title</span></span>
<span id="cb407-40"><a href="#cb407-40" aria-hidden="true" tabindex="-1"></a>  Title <span class="ot">&lt;-</span> <span class="fu">tryCatch</span>({</span>
<span id="cb407-41"><a href="#cb407-41" aria-hidden="true" tabindex="-1"></a>    current_page <span class="sc">%&gt;%</span></span>
<span id="cb407-42"><a href="#cb407-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_nodes</span>(<span class="st">".docsum-title"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb407-43"><a href="#cb407-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb407-44"><a href="#cb407-44" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb407-45"><a href="#cb407-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Error extracting title info on page"</span>, page <span class="sc">+</span> <span class="dv">1</span>))</span>
<span id="cb407-46"><a href="#cb407-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(Title))  <span class="co"># Return a vector of NAs with the same length as Title</span></span>
<span id="cb407-47"><a href="#cb407-47" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb407-48"><a href="#cb407-48" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb407-49"><a href="#cb407-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract the PMID</span></span>
<span id="cb407-50"><a href="#cb407-50" aria-hidden="true" tabindex="-1"></a>  pmid <span class="ot">&lt;-</span> current_page <span class="sc">%&gt;%</span></span>
<span id="cb407-51"><a href="#cb407-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_nodes</span>(<span class="st">".docsum-pmid"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb407-52"><a href="#cb407-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">html_text</span>(<span class="at">trim =</span> <span class="cn">TRUE</span>)</span>
<span id="cb407-53"><a href="#cb407-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb407-54"><a href="#cb407-54" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create a data frame with the extracted data</span></span>
<span id="cb407-55"><a href="#cb407-55" aria-hidden="true" tabindex="-1"></a>  current_results_near_death <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Title =</span> Title,</span>
<span id="cb407-56"><a href="#cb407-56" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">PMID =</span> pmid)</span>
<span id="cb407-57"><a href="#cb407-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb407-58"><a href="#cb407-58" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Combine the current results with the previous results</span></span>
<span id="cb407-59"><a href="#cb407-59" aria-hidden="true" tabindex="-1"></a>  results_near_death_rvest <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results_near_death_rvest, current_results_near_death)</span>
<span id="cb407-60"><a href="#cb407-60" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb407-61"><a href="#cb407-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Introduce a delay to avoid overloading the server</span></span>
<span id="cb407-62"><a href="#cb407-62" aria-hidden="true" tabindex="-1"></a>  sleep_time <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="at">min =</span> <span class="dv">5</span>, <span class="at">max =</span> <span class="dv">15</span>)</span>
<span id="cb407-63"><a href="#cb407-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Sys.sleep</span>(sleep_time)</span>
<span id="cb407-64"><a href="#cb407-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb407-65"><a href="#cb407-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-66"><a href="#cb407-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the extracted data</span></span>
<span id="cb407-67"><a href="#cb407-67" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">as_tibble</span>(results_near_death_rvest))</span>
<span id="cb407-68"><a href="#cb407-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-69"><a href="#cb407-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb407-70"><a href="#cb407-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the titles before proceeding so we can't lose them!</span></span>
<span id="cb407-71"><a href="#cb407-71" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_near_death_rvest, <span class="st">"Data extraction/near_death_titles.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<section id="refine-dataset-26" class="level4">
<h4 class="anchored" data-anchor-id="refine-dataset-26">Refine dataset</h4>
<p>Now we need to identify and remove any duplicates, irrelevant studies, or entries with any other issues (e.g., those that turn out to be books)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in first dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb408-2"><a href="#cb408-2" aria-hidden="true" tabindex="-1"></a>results_near_death<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/near_death_data.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb408-3"><a href="#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb408-4"><a href="#cb408-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-5"><a href="#cb408-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Load in second dataset in case environment clean on knit (above sections not executed for render):</span></span>
<span id="cb408-6"><a href="#cb408-6" aria-hidden="true" tabindex="-1"></a>results_near_death_rvest<span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Data extraction/near_death_titles.csv"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb408-7"><a href="#cb408-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb408-8"><a href="#cb408-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb408-9"><a href="#cb408-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge our two datasets</span></span>
<span id="cb408-10"><a href="#cb408-10" aria-hidden="true" tabindex="-1"></a>results_near_death2 <span class="ot">&lt;-</span> results_near_death <span class="sc">%&gt;%</span></span>
<span id="cb408-11"><a href="#cb408-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span></span>
<span id="cb408-12"><a href="#cb408-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"Title_trunc"</span> <span class="ot">=</span> <span class="st">"Title"</span>) <span class="sc">%&gt;%</span> <span class="co"># Designate the truncated title from our primary dataset so we can remove it once we get the full title</span></span>
<span id="cb408-13"><a href="#cb408-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(results_near_death_rvest, <span class="at">by =</span> <span class="st">"PMID"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb408-14"><a href="#cb408-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Title_trunc) <span class="sc">%&gt;%</span> <span class="co"># Bye truncated title</span></span>
<span id="cb408-15"><a href="#cb408-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(Title) <span class="sc">%&gt;%</span> <span class="co"># Place full title first for ease</span></span>
<span id="cb408-16"><a href="#cb408-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 13
  Title          PMID  Year Month DOI   Abstract Full_Author_Name Author_Address
  &lt;chr&gt;         &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;    &lt;chr&gt;            &lt;chr&gt;         
1 Combined NM… 2.94e7  2018 May/… 10.1… ": Nove… Caloro, Matteo;… "NESMOS Depar…
2 A sub-set o… 2.93e7  2018 Nov   S002… "Effort… Dakwar, E; Nune… "New York Sta…
3 Crystal met… 2.16e7  2010 Jun   &lt;NA&gt;  "Rural … Brown, Ryan A    "School of Ed…
4 The near-de… 1.83e7  2008 Jan-… &lt;NA&gt;  "The ro… Strubelt, Suste… "Austrian Dev…
5 Fatalities … 1.67e7  2006 &lt;NA&gt;  &lt;NA&gt;  "Ibogai… Maas, U; Strube… "Scientific A…
6 A review of… 1.12e7  2000 Oct-… &lt;NA&gt;  "Ketami… Jansen, K L      "K@BTInternet…
7 Addiction t… 7.15e6  1982 &lt;NA&gt;  &lt;NA&gt;  "This p… Joseph, B         &lt;NA&gt;         
# ℹ 5 more variables: Language &lt;chr&gt;, Publication_Type &lt;chr&gt;,
#   Journal_name_short &lt;chr&gt;, Conflict_of_Interest_Statement &lt;chr&gt;,
#   Journal_Title &lt;chr&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check results:</span></span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_near_death2)</span></span>
<span id="cb410-3"><a href="#cb410-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb410-4"><a href="#cb410-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on title:</span></span>
<span id="cb410-5"><a href="#cb410-5" aria-hidden="true" tabindex="-1"></a>results_near_death2 <span class="sc">%&gt;%</span></span>
<span id="cb410-6"><a href="#cb410-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(Title) <span class="sc">%&gt;%</span></span>
<span id="cb410-7"><a href="#cb410-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb410-8"><a href="#cb410-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># n = 0 (August, 2023)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1     7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Total number with basic duplication removal based on PMID:</span></span>
<span id="cb412-2"><a href="#cb412-2" aria-hidden="true" tabindex="-1"></a>results_near_death2 <span class="sc">%&gt;%</span></span>
<span id="cb412-3"><a href="#cb412-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(PMID) <span class="sc">%&gt;%</span></span>
<span id="cb412-4"><a href="#cb412-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb412-5"><a href="#cb412-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>() <span class="co"># None</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1     7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Isolate relevant study:</span></span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>results_near_death3 <span class="ot">&lt;-</span>  results_near_death2 <span class="sc">%&gt;%</span> </span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Title <span class="sc">==</span> <span class="st">"Addiction to near-death."</span></span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb414-5"><a href="#cb414-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb414-6"><a href="#cb414-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary of the year variable:</span></span>
<span id="cb414-7"><a href="#cb414-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(results_near_death3<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1982    1982    1982    1982    1982    1982 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of publications per year:</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>near_death_hist<span class="ot">&lt;-</span> <span class="fu">hist</span>(results_near_death3<span class="sc">$</span>Year,</span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1960</span>,<span class="dv">2023</span>),</span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="dv">1</span>,</span>
<span id="cb416-5"><a href="#cb416-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">main =</span> <span class="st">"Papers published per year on Near Death Addiction (PubMed)"</span>,</span>
<span id="cb416-6"><a href="#cb416-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">xlab =</span> <span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="PubMed-Article-Extraction-Using-rentrez_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Most popular journals:</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a>results_near_death3 <span class="sc">%&gt;%</span> </span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Journal_name_short) <span class="sc">%&gt;%</span> </span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>()</span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n)) <span class="sc">%&gt;%</span></span>
<span id="cb417-8"><a href="#cb417-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="at">n =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  Journal_name_short     n
  &lt;chr&gt;              &lt;int&gt;
1 Int J Psychoanal       1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_near_death2) # Visually inspect results</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Now I need to add a label to all of these studies to signify that they Were returned from the near_death search so that we can distinguish them from other studies when we later joined the datasets together:</span></span>
<span id="cb419-4"><a href="#cb419-4" aria-hidden="true" tabindex="-1"></a>Label_near_death <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"near_death"</span>, <span class="at">times =</span> <span class="fu">count</span>(results_near_death3))</span>
<span id="cb419-5"><a href="#cb419-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-6"><a href="#cb419-6" aria-hidden="true" tabindex="-1"></a>results_near_death_final <span class="ot">&lt;-</span> results_near_death3 <span class="sc">%&gt;%</span> <span class="fu">bind_cols</span>(Label_near_death) <span class="sc">%&gt;%</span></span>
<span id="cb419-7"><a href="#cb419-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Label =</span> <span class="dv">14</span>)</span>
<span id="cb419-8"><a href="#cb419-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb419-9"><a href="#cb419-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-10"><a href="#cb419-10" aria-hidden="true" tabindex="-1"></a><span class="co"># View(results_near_death_final)</span></span>
<span id="cb419-11"><a href="#cb419-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb419-12"><a href="#cb419-12" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(results_near_death_final, <span class="st">"Data extraction/near_death_data_cleaned.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="join-all-final-datasets" class="level2">
<h2 class="anchored" data-anchor-id="join-all-final-datasets">Join all final datasets</h2>
<p>Now I’ll produce one clean dataset that contains all of the refined datasets for each of the behavioural addictions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>combined_results_clean <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(results_behav_addictions_final,</span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>          results_gambling_final,</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>          results_gaming_final,</span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a>          results_work_final,</span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a>          results_study_final,</span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a>          results_exercise_final,</span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>          results_social_media_final,</span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>          results_smart_phone_final,</span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a>          results_cybersex_final,</span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a>          results_sex_final,</span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a>          results_pornography_final,</span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a>          results_tanning_final,</span>
<span id="cb420-13"><a href="#cb420-13" aria-hidden="true" tabindex="-1"></a>          results_hair_pulling_final,</span>
<span id="cb420-14"><a href="#cb420-14" aria-hidden="true" tabindex="-1"></a>          results_love_final,</span>
<span id="cb420-15"><a href="#cb420-15" aria-hidden="true" tabindex="-1"></a>          results_selfie_final,</span>
<span id="cb420-16"><a href="#cb420-16" aria-hidden="true" tabindex="-1"></a>          results_extreme_sport_final,</span>
<span id="cb420-17"><a href="#cb420-17" aria-hidden="true" tabindex="-1"></a>          results_running_final,</span>
<span id="cb420-18"><a href="#cb420-18" aria-hidden="true" tabindex="-1"></a>          results_dance_final,</span>
<span id="cb420-19"><a href="#cb420-19" aria-hidden="true" tabindex="-1"></a>          results_joyriding_final,</span>
<span id="cb420-20"><a href="#cb420-20" aria-hidden="true" tabindex="-1"></a>          results_crime_final,</span>
<span id="cb420-21"><a href="#cb420-21" aria-hidden="true" tabindex="-1"></a>          results_polysurgical_final,</span>
<span id="cb420-22"><a href="#cb420-22" aria-hidden="true" tabindex="-1"></a>          results_fortune_telling_final,</span>
<span id="cb420-23"><a href="#cb420-23" aria-hidden="true" tabindex="-1"></a>          results_YouTube_final,</span>
<span id="cb420-24"><a href="#cb420-24" aria-hidden="true" tabindex="-1"></a>          results_death_final,</span>
<span id="cb420-25"><a href="#cb420-25" aria-hidden="true" tabindex="-1"></a>          results_near_death_final</span>
<span id="cb420-26"><a href="#cb420-26" aria-hidden="true" tabindex="-1"></a>          )</span>
<span id="cb420-27"><a href="#cb420-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-28"><a href="#cb420-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Now save the cleaned results</span></span>
<span id="cb420-29"><a href="#cb420-29" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(combined_results_clean, <span class="st">"Data extraction/combined_results_clean.csv"</span>, <span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="end" class="level3">
<h3 class="anchored" data-anchor-id="end">END</h3>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>